Plutorun started on Mon Jan 27 11:19:12 CET 2020
adjusting ipsec.d to /etc/ipsec.d
Labelled IPsec not enabled; value 32001 ignored.
Starting Pluto (Openswan Version 2.6.52-11-gc33f27642-dirty; Vendor ID OSW^AvVKh{UP) pid:2956
LEAK_DETECTIVE support [disabled]
OCF support for IKE [disabled]
SAref support [disabled]: Protocol not available
SAbind support [disabled]: Protocol not available
NSS support [disabled]
HAVE_STATSD notification support not compiled in
Setting NAT-Traversal port-4500 floating to off
   port floating activation criteria nat_t=0/port_float=1
   NAT-Traversal support  [disabled]
| opening /dev/urandom
using /dev/urandom as source of random entropy
| inserting event EVENT_REINIT_SECRET, timeout in 3600 seconds (head of queue)
| inserting event EVENT_PENDING_DDNS, timeout in 60 seconds (head of queue)
| inserting event EVENT_PENDING_PHASE2, timeout in 120 seconds 
| event added after event EVENT_PENDING_DDNS
ike_alg_register_enc(): Activating OAKLEY_AES_CBC: Ok (ret=0)
ike_alg_register_hash(): Activating OAKLEY_SHA2_512: Ok (ret=0)
ike_alg_register_hash(): Activating OAKLEY_SHA2_256: Ok (ret=0)
starting up 1 cryptographic helpers
started helper pid=2960 (fd:7)
Using Linux XFRM/NETKEY IPsec interface code on 5.3.0-26-generic
| process 2956 listening for PF_KEY_V2 on file descriptor 10
| finish_pfkey_msg: K_SADB_REGISTER message 1 for AH 
|   02 07 00 02  02 00 00 00  01 00 00 00  8c 0b 00 00
| pfkey_get: K_SADB_REGISTER message 1
| AH registered with kernel.
| finish_pfkey_msg: K_SADB_REGISTER message 2 for ESP 
|   02 07 00 03  02 00 00 00  02 00 00 00  8c 0b 00 00
| pfkey_get: K_SADB_REGISTER message 2
| alg_init():memset(0x5650f25fc800, 0, 2048) memset(0x5650f25fd000, 0, 2048) 
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: sadb_msg_len=22 sadb_supported_len=72
| kernel_alg_add():satype=3, exttype=14, alg_id=251
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[0], exttype=14, satype=3, alg_id=251, alg_ivlen=0, alg_minbits=0, alg_maxbits=0, res=0, ret=1
| kernel_alg_add():satype=3, exttype=14, alg_id=2
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[1], exttype=14, satype=3, alg_id=2, alg_ivlen=0, alg_minbits=128, alg_maxbits=128, res=0, ret=1
| kernel_alg_add():satype=3, exttype=14, alg_id=3
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[2], exttype=14, satype=3, alg_id=3, alg_ivlen=0, alg_minbits=160, alg_maxbits=160, res=0, ret=1
| kernel_alg_add():satype=3, exttype=14, alg_id=5
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[3], exttype=14, satype=3, alg_id=5, alg_ivlen=0, alg_minbits=256, alg_maxbits=256, res=0, ret=1
| kernel_alg_add():satype=3, exttype=14, alg_id=6
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[4], exttype=14, satype=3, alg_id=6, alg_ivlen=0, alg_minbits=384, alg_maxbits=384, res=0, ret=1
| kernel_alg_add():satype=3, exttype=14, alg_id=7
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[5], exttype=14, satype=3, alg_id=7, alg_ivlen=0, alg_minbits=512, alg_maxbits=512, res=0, ret=1
| kernel_alg_add():satype=3, exttype=14, alg_id=8
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[6], exttype=14, satype=3, alg_id=8, alg_ivlen=0, alg_minbits=160, alg_maxbits=160, res=0, ret=1
| kernel_alg_add():satype=3, exttype=14, alg_id=9
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[7], exttype=14, satype=3, alg_id=9, alg_ivlen=0, alg_minbits=128, alg_maxbits=128, res=0, ret=1
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: sadb_msg_len=22 sadb_supported_len=88
| kernel_alg_add():satype=3, exttype=15, alg_id=11
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[8], exttype=15, satype=3, alg_id=11, alg_ivlen=0, alg_minbits=0, alg_maxbits=0, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=2
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[9], exttype=15, satype=3, alg_id=2, alg_ivlen=8, alg_minbits=64, alg_maxbits=64, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=3
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[10], exttype=15, satype=3, alg_id=3, alg_ivlen=8, alg_minbits=192, alg_maxbits=192, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=6
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[11], exttype=15, satype=3, alg_id=6, alg_ivlen=8, alg_minbits=40, alg_maxbits=128, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=7
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[12], exttype=15, satype=3, alg_id=7, alg_ivlen=8, alg_minbits=40, alg_maxbits=448, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=12
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[13], exttype=15, satype=3, alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=252
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[14], exttype=15, satype=3, alg_id=252, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=22
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[15], exttype=15, satype=3, alg_id=22, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=253
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[16], exttype=15, satype=3, alg_id=253, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=13
| kernel_alg_register_pfkey(): SADB_SATYPE_ESP: alg[17], exttype=15, satype=3, alg_id=13, alg_ivlen=8, alg_minbits=160, alg_maxbits=288, res=0, ret=1
| kernel_alg_add():satype=3, exttype=15, alg_id=18
| kernel_alg_add():satype=3, exttype=15, alg_id=19
| kernel_alg_add():satype=3, exttype=15, alg_id=20
| kernel_alg_add():satype=3, exttype=15, alg_id=14
| kernel_alg_add():satype=3, exttype=15, alg_id=15
| kernel_alg_add():satype=3, exttype=15, alg_id=16
ike_alg_register_enc(): Activating aes_ccm_8: Ok (ret=0)
ike_alg_add(): ERROR: algo_type '0', algo_id '0', Algorithm type already exists
ike_alg_register_enc(): Activating aes_ccm_12: FAILED (ret=-17)
ike_alg_add(): ERROR: algo_type '0', algo_id '0', Algorithm type already exists
ike_alg_register_enc(): Activating aes_ccm_16: FAILED (ret=-17)
ike_alg_add(): ERROR: algo_type '0', algo_id '0', Algorithm type already exists
ike_alg_register_enc(): Activating aes_gcm_8: FAILED (ret=-17)
ike_alg_add(): ERROR: algo_type '0', algo_id '0', Algorithm type already exists
ike_alg_register_enc(): Activating aes_gcm_12: FAILED (ret=-17)
ike_alg_add(): ERROR: algo_type '0', algo_id '0', Algorithm type already exists
ike_alg_register_enc(): Activating aes_gcm_16: FAILED (ret=-17)
| ESP registered with kernel.
| finish_pfkey_msg: K_SADB_REGISTER message 3 for IPCOMP 
|   02 07 00 09  02 00 00 00  03 00 00 00  8c 0b 00 00
| pfkey_get: K_SADB_REGISTER message 3
| IPCOMP registered with kernel.
| inserting event EVENT_SHUNT_SCAN, timeout in 120 seconds 
| event added after event EVENT_PENDING_DDNS
| Changed path to directory '/etc/ipsec.d/cacerts'
| Changed path to directory '/etc/ipsec.d/aacerts'
| Changed path to directory '/etc/ipsec.d/ocspcerts'
| Found 0 items in directory '/etc/ipsec.d/crls'
| inserting event EVENT_LOG_DAILY, timeout in 45648 seconds 
| event added after event EVENT_REINIT_SECRET
| next event EVENT_PENDING_DDNS in 60 seconds
|  
| *received whack message
| alg_info_parse_str() ealg_buf=aes aalg_buf=sha1 eklen=128  aklen=0
| enum_search_prefix () calling enum_search(0x5650f25d8cc0, "OAKLEY_AES")
| enum_search_ppfixi () calling enum_search(0x5650f25d8cc0, "OAKLEY_AES_CBC")
| parser_alg_info_add() ealg_getbyname("aes")=7
| enum_search_prefix () calling enum_search(0x5650f25d8c20, "OAKLEY_SHA1")
| parser_alg_info_add() aalg_getbyname("sha1")=2
| __alg_info_ike_add() ealg=7 aalg=2 modp_id=5, cnt=1
| __alg_info_ike_add() ealg=7 aalg=2 modp_id=2, cnt=2
| Added new connection mytunnel with policy PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK
| from whack: got --esp=aes128-sha1
| alg_info_parse_str() ealg_buf=aes aalg_buf=sha1 eklen=128  aklen=0
| enum_search_prefix () calling enum_search(0x5650f25d9640, "ESP_AES")
| parser_alg_info_add() ealg_getbyname("aes")=12
| enum_search_prefix () calling enum_search(0x5650f25d9060, "AUTH_ALGORITHM_HMAC_SHA1")
| parser_alg_info_add() aalg_getbyname("sha1")=2
| __alg_info_esp_add() ealg=12 aalg=2 cnt=1
| esp string values: AES(12)_128-SHA1(2)_000; flags=-strict
| ike (phase1) algorihtm values: AES_CBC(7)_128-SHA1(2)_000-MODP1536(5), AES_CBC(7)_128-SHA1(2)_000-MODP1024(2); flags=-strict
| counting wild cards for 10.0.2.14 is 0
| counting wild cards for 10.0.2.15 is 0
| alg_info_addref() alg_info->ref_cnt=1
| alg_info_addref() alg_info->ref_cnt=1
| orient mytunnel matching on public/private keys: this=no[%address] that=no[%address]
|   orient mytunnel finished with: 0 [none]
| find_ID_host_pair: looking for me=10.0.2.14 him=10.0.2.15 (exact) 
|   concluded with <none>
adding connection: "mytunnel"
| 10.0.2.14...10.0.2.15
| ike_life: 3600s; ipsec_life: 28800s; rekey_margin: 540s; rekey_fuzz: 100%; keyingtries: 0; policy: PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 60 seconds
| next event EVENT_PENDING_DDNS in 60 seconds
|  
| *received whack message
listening for IKE messages
| found lo with address 127.0.0.1
| found enp0s3 with address 10.0.2.15
adding interface enp0s3/enp0s3 10.0.2.15:500 (AF_INET)
adding interface lo/lo 127.0.0.1:500 (AF_INET)
| found lo with address 0000:0000:0000:0000:0000:0000:0000:0001
adding interface lo/lo ::1:500 (AF_INET6)
| orient mytunnel checking against if: lo (AF_INET6:::1:500)
| orient mytunnel checking against if: lo (AF_INET:127.0.0.1:500)
| orient mytunnel checking against if: enp0s3 (AF_INET:10.0.2.15:500)
|     orient matched on IP
|   orient mytunnel finished with: 1 [10.0.2.15]
| connection mytunnel is now oriented
| find_host_pair: looking for me=10.0.2.15:500 %address him=10.0.2.14:500 exact-match 
| find_host_pair: concluded with <none>
| connect_to_host_pair: 10.0.2.15:500 %address 10.0.2.14:500 -> hp:none 
| find_ID_host_pair: looking for me=10.0.2.15 him=10.0.2.14 (exact) 
|                   comparing to me=10.0.2.14 him=10.0.2.15 (mytunnel) 
|   concluded with <none>
loading secrets from "/etc/ipsec.secrets"
loaded private key for keyid: PPK_RSA:AQOlChmnw/3FE4 2DB9 84EF AAE6 F360 19A6 304E CF52 0810 9FA2
| id type added to secret(0x5650f337f100) PPK_PSK: 10.0.2.14
| id type added to secret(0x5650f337f100) PPK_PSK: 10.0.2.15
| Processing PSK at line 16: passed
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 60 seconds
| next event EVENT_PENDING_DDNS in 60 seconds
| opening /dev/urandom
using /dev/urandom as source of random entropy
! helper 0 waiting on fd: 8
|  
| next event EVENT_PENDING_DDNS in 0 seconds
| *time to handle event
| at 2020-01-27 11:20:12 handling event EVENT_PENDING_DDNS
| event after this is EVENT_SHUNT_SCAN in 60 seconds
| inserting event EVENT_PENDING_DDNS, timeout in 60 seconds (head of queue)
| next event EVENT_PENDING_DDNS in 60 seconds
|  
| next event EVENT_PENDING_DDNS in 0 seconds
| *time to handle event
| at 2020-01-27 11:21:12 handling event EVENT_PENDING_DDNS
| event after this is EVENT_SHUNT_SCAN in 0 seconds
| inserting event EVENT_PENDING_DDNS, timeout in 60 seconds 
| event added after event EVENT_PENDING_PHASE2
| at 2020-01-27 11:21:12 handling event EVENT_SHUNT_SCAN
| event after this is EVENT_PENDING_PHASE2 in 0 seconds
| inserting event EVENT_SHUNT_SCAN, timeout in 120 seconds 
| event added after event EVENT_PENDING_DDNS
| scanning for expired bare shunts
| at 2020-01-27 11:21:12 handling event EVENT_PENDING_PHASE2
| event after this is EVENT_PENDING_DDNS in 60 seconds
| inserting event EVENT_PENDING_PHASE2, timeout in 120 seconds 
| event added after event EVENT_PENDING_DDNS
| pending review: connection "mytunnel" was not up, skipped
| next event EVENT_PENDING_DDNS in 60 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\234
| *received 156 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:21:40
|   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00
|   01 10 02 00  00 00 00 00  00 00 00 9c  0d 00 00 5c
|   00 00 00 01  00 00 00 01  00 00 00 50  00 01 00 02
|   03 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  00 00 00 24  01 01 00 00  80 0b 00 01
|   80 0c 0e 10  80 01 00 07  80 02 00 02  80 03 00 01
|   80 04 00 02  80 0e 00 80  0d 00 00 10  4f 53 57 7e
|   7c 74 59 69  57 59 73 57  00 00 00 14  af ca d7 13
|   68 a1 f1 c9  6b 86 96 fc  77 57 01 00
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 156
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
packet from 10.0.2.14:500: Initiator Cookie must not be zero in phase 1 message
packet from 10.0.2.14:500: [PIET] I detected a ZERO initiator cookie... (ikev1.c)
packet from 10.0.2.14:500: sending notification INVALID_COOKIE to 10.0.2.14:500
| **emit ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Notification Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 0
|    Notify Message Type: INVALID_COOKIE
| emitting length of ISAKMP Notification Payload: 12
| emitting length of ISAKMP Message: 40
| sending 40 bytes for notification packet through enp0s3:500 to 10.0.2.14:500 (using #0)
|   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00
|   0b 10 05 00  00 00 00 00  00 00 00 28  00 00 00 0c
|   00 00 00 01  01 00 00 04
packet from 10.0.2.14:500: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 32 seconds
| next event EVENT_PENDING_DDNS in 32 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\234
| *received 156 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:08
|   93 b3 b6 40  5b 39 92 24  00 00 00 00  00 00 00 00
|   01 10 02 00  00 00 00 00  00 00 00 9c  0d 00 00 5c
|   00 00 00 01  00 00 00 01  00 00 00 50  00 01 00 02
|   03 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  00 00 00 24  01 01 00 00  80 0b 00 01
|   80 0c 0e 10  80 01 00 07  80 02 00 02  80 03 00 01
|   80 04 00 02  80 0e 00 80  0d 00 00 10  4f 53 57 7e
|   7c 74 59 69  57 59 73 57  00 00 00 14  af ca d7 13
|   68 a1 f1 c9  6b 86 96 fc  77 57 01 00
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   93 b3 b6 40  5b 39 92 24
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 156
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| got payload 0x2(ISAKMP_NEXT_SA) needed: 0x2 opt: 0x2080
| ***parse ISAKMP Security Association Payload:
|    length: 92
|    DOI: ISAKMP_DOI_IPSEC
| got payload 0x2000(ISAKMP_NEXT_VID) needed: 0x0 opt: 0x2080
| ***parse ISAKMP Vendor ID Payload:
|    length: 16
| got payload 0x2000(ISAKMP_NEXT_VID) needed: 0x0 opt: 0x2080
| ***parse ISAKMP Vendor ID Payload:
|    length: 20
packet from 10.0.2.14:500: ignoring unknown Vendor ID payload [4f53577e7c74596957597357]
packet from 10.0.2.14:500: received Vendor ID payload [Dead Peer Detection]
| find_host_connection2 called from main_inI1_outR1, me=10.0.2.15:500 him=10.0.2.14:500 policy=/!IKEv1
| find_host_pair: looking for me=10.0.2.15:500 %address him=10.0.2.14:500 any-match 
| find_host_pair: comparing to me=10.0.2.15:500 %address him=10.0.2.14:500 
| find_host_pair: concluded with mytunnel
| found_host_pair_conn (find_host_connection2): 10.0.2.15:500 %address/10.0.2.14:500 -> hp:mytunnel 
| searching for connection with policy = /!IKEv1
| found policy = PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK (mytunnel)
| find_host_connection2 returns mytunnel (ike=none/none)
| creating state object #1 at 0x5650f3380140
| processing connection mytunnel
| ICOOKIE:  93 b3 b6 40  5b 39 92 24
| RCOOKIE:  23 fb be d9  c1 97 e9 7a
| state hash entry 12
| inserting state object #1 bucket: 12
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #1 (head of queue)
"mytunnel" #1: responding to Main Mode
| **emit ISAKMP Message:
|    initiator cookie:
|   93 b3 b6 40  5b 39 92 24
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Security Association Payload:
|    DOI: ISAKMP_DOI_IPSEC
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 80
|    proposal number: 0
|    protocol ID: PROTO_ISAKMP
|    SPI size: 0
|    number of transforms: 2
| *****parse ISAKMP Transform Payload (ISAKMP):
|    length: 36
|    transform number: 0
|    transform ID: KEY_IKE
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_LIFE_TYPE
|    length/value: 1
|    [1 is OAKLEY_LIFE_SECONDS]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_LIFE_DURATION
|    length/value: 3600
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_ENCRYPTION_ALGORITHM
|    length/value: 7
|    [7 is OAKLEY_AES_CBC]
| ike_alg_enc_ok(ealg=7,key_len=0): blocksize=16, keyminlen=128, keydeflen=128, keymaxlen=256, ret=1
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_HASH_ALGORITHM
|    length/value: 2
|    [2 is OAKLEY_SHA1]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_AUTHENTICATION_METHOD
|    length/value: 1
|    [1 is OAKLEY_PRESHARED_KEY]
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_KEY_LENGTH
|    length/value: 128
| ike_alg_enc_ok(ealg=7,key_len=128): blocksize=16, keyminlen=128, keydeflen=128, keymaxlen=256, ret=1
| Oakley Transform 0 accepted
| ****emit IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****emit ISAKMP Proposal Payload:
|    proposal number: 0
|    protocol ID: PROTO_ISAKMP
|    SPI size: 0
|    number of transforms: 1
| *****emit ISAKMP Transform Payload (ISAKMP):
|    transform number: 0
|    transform ID: KEY_IKE
| emitting 28 raw bytes of attributes into ISAKMP Transform Payload (ISAKMP)
| attributes  80 0b 00 01  80 0c 0e 10  80 01 00 07  80 02 00 02
| attributes  80 03 00 01  80 04 00 05  80 0e 00 80
| emitting length of ISAKMP Transform Payload (ISAKMP): 36
| emitting length of ISAKMP Proposal Payload: 44
| emitting length of ISAKMP Security Association Payload: 56
| ***emit ISAKMP Vendor ID Payload:
| emitting 12 raw bytes of Vendor ID into ISAKMP Vendor ID Payload
| Vendor ID  4f 53 57 5e  41 76 56 4b  68 7b 55 50
| emitting length of ISAKMP Vendor ID Payload: 16
| out_vendorid(): sending [Dead Peer Detection]
| ***emit ISAKMP Vendor ID Payload:
| emitting 16 raw bytes of V_ID into ISAKMP Vendor ID Payload
| V_ID  af ca d7 13  68 a1 f1 c9  6b 86 96 fc  77 57 01 00
| emitting length of ISAKMP Vendor ID Payload: 20
| sender checking NAT-T: 0 and 0
| emitting length of ISAKMP Message: 120
| peer supports dpd
| complete state transition with STF_OK
"mytunnel" #1: transition from state STATE_MAIN_R0 to state STATE_MAIN_R1
| deleting event for #1
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 120 bytes for STATE_MAIN_R0 through enp0s3:500 to 10.0.2.14:500 (using #1)
|   93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
|   01 10 02 00  00 00 00 00  00 00 00 78  0d 00 00 38
|   00 00 00 01  00 00 00 01  00 00 00 2c  00 01 00 01
|   00 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  0d 00 00 10  4f 53 57 5e  41 76 56 4b
|   68 7b 55 50  00 00 00 14  af ca d7 13  68 a1 f1 c9
|   6b 86 96 fc  77 57 01 00
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #1 
| event added after event EVENT_PENDING_DDNS
"mytunnel" #1: STATE_MAIN_R1: sent MR1, expecting MI2
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
"mytunnel" #1: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 4 seconds
| next event EVENT_PENDING_DDNS in 4 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\364
| *received 244 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:09
|   00 00 00 00  00 00 00 00  23 fb be d9  c1 97 e9 7a
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
|   71 c1 ed a2  33 8e 00 cb  5e 45 3f fe  26 58 3b 73
|   dd 34 9f e0  58 c2 aa ab  56 a7 bf b3  50 08 0a d7
|   73 ec 70 17  a4 04 92 4b  fd 29 c8 69  c7 a4 87 9e
|   3a 05 8b 03  47 d3 49 06  b3 ba c0 ee  3b 22 5a 65
|   61 f3 68 08  82 d6 d5 14  2e b0 1a 87  87 71 91 34
|   3f 5d da 2d  b7 9c 19 42  6d 3a db ec  b7 2e d1 94
|   1f 91 a9 4a  f5 d3 a1 8f  3d d9 da a2  97 15 72 79
|   f7 78 f0 5c  e5 92 37 6d  df bd c0 2f  57 95 5d 24
|   e8 23 0c 1f  ad e1 58 ae  f1 7e 4a 50  a2 dd 23 2d
|   17 dd 92 c7  a9 1b 47 55  87 89 16 1f  d8 91 25 6d
|   ff a0 30 62  c9 34 83 62  c4 36 50 09  bb 5e 3c 24
|   18 e9 e1 89  9a 25 bb fb  99 6c 90 47  c5 c8 73 fe
|   00 00 00 14  f1 fd 1f 69  82 cf 2b 84  0a 4d d4 d9
|   bb 9e ba 0b
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 244
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
packet from 10.0.2.14:500: Initiator Cookie must not be zero in phase 1 message
packet from 10.0.2.14:500: [PIET] I detected a ZERO initiator cookie... (ikev1.c)
packet from 10.0.2.14:500: sending notification INVALID_COOKIE to 10.0.2.14:500
| **emit ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Notification Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 0
|    Notify Message Type: INVALID_COOKIE
| emitting length of ISAKMP Notification Payload: 12
| emitting length of ISAKMP Message: 40
| sending 40 bytes for notification packet through enp0s3:500 to 10.0.2.14:500 (using #0)
|   00 00 00 00  00 00 00 00  23 fb be d9  c1 97 e9 7a
|   0b 10 05 00  00 00 00 00  00 00 00 28  00 00 00 0c
|   00 00 00 01  01 00 00 04
packet from 10.0.2.14:500: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 3 seconds
| next event EVENT_PENDING_DDNS in 3 seconds
|  
| next event EVENT_PENDING_DDNS in 0 seconds
| *time to handle event
| at 2020-01-27 11:22:12 handling event EVENT_PENDING_DDNS
| event after this is EVENT_RETRANSMIT in 6 seconds
| inserting event EVENT_PENDING_DDNS, timeout in 60 seconds 
| event added after event EVENT_RETRANSMIT for #1
| next event EVENT_RETRANSMIT in 6 seconds for #1 (2020-01-27 11:22:12)
|  
| next event EVENT_RETRANSMIT in 0 seconds for #1 (2020-01-27 11:22:18)
| *time to handle event
| at 2020-01-27 11:22:18 handling event EVENT_RETRANSMIT
| event after this is EVENT_PENDING_DDNS in 54 seconds
| processing connection mytunnel
| handling event EVENT_RETRANSMIT for 10.0.2.14 "mytunnel" #1
| sending 120 bytes for EVENT_RETRANSMIT through enp0s3:500 to 10.0.2.14:500 (using #1)
|   93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
|   01 10 02 00  00 00 00 00  00 00 00 78  0d 00 00 38
|   00 00 00 01  00 00 00 01  00 00 00 2c  00 01 00 01
|   00 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  0d 00 00 10  4f 53 57 5e  41 76 56 4b
|   68 7b 55 50  00 00 00 14  af ca d7 13  68 a1 f1 c9
|   6b 86 96 fc  77 57 01 00
| inserting event EVENT_RETRANSMIT, timeout in 20 seconds for #1 (head of queue)
| next event EVENT_RETRANSMIT in 20 seconds for #1 (2020-01-27 11:22:18)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\364
| *received 244 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:19
|   93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
|   71 c1 ed a2  33 8e 00 cb  5e 45 3f fe  26 58 3b 73
|   dd 34 9f e0  58 c2 aa ab  56 a7 bf b3  50 08 0a d7
|   73 ec 70 17  a4 04 92 4b  fd 29 c8 69  c7 a4 87 9e
|   3a 05 8b 03  47 d3 49 06  b3 ba c0 ee  3b 22 5a 65
|   61 f3 68 08  82 d6 d5 14  2e b0 1a 87  87 71 91 34
|   3f 5d da 2d  b7 9c 19 42  6d 3a db ec  b7 2e d1 94
|   1f 91 a9 4a  f5 d3 a1 8f  3d d9 da a2  97 15 72 79
|   f7 78 f0 5c  e5 92 37 6d  df bd c0 2f  57 95 5d 24
|   e8 23 0c 1f  ad e1 58 ae  f1 7e 4a 50  a2 dd 23 2d
|   17 dd 92 c7  a9 1b 47 55  87 89 16 1f  d8 91 25 6d
|   ff a0 30 62  c9 34 83 62  c4 36 50 09  bb 5e 3c 24
|   18 e9 e1 89  9a 25 bb fb  99 6c 90 47  c5 c8 73 fe
|   00 00 00 14  f1 fd 1f 69  82 cf 2b 84  0a 4d d4 d9
|   bb 9e ba 0b
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   93 b3 b6 40  5b 39 92 24
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 244
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  93 b3 b6 40  5b 39 92 24
| RCOOKIE:  23 fb be d9  c1 97 e9 7a
| state hash entry 12
| v1 peer and cookies match on #1, provided msgid 00000000 vs 00000000
| v1 state object #1 found, in STATE_MAIN_R1
| processing connection mytunnel
| got payload 0x10(ISAKMP_NEXT_KE) needed: 0x410 opt: 0x102080
| ***parse ISAKMP Key Exchange Payload:
|    length: 196
| got payload 0x400(ISAKMP_NEXT_NONCE) needed: 0x400 opt: 0x102080
| ***parse ISAKMP Nonce Payload:
|    length: 20
| DH public value received:
|   71 c1 ed a2  33 8e 00 cb  5e 45 3f fe  26 58 3b 73
|   dd 34 9f e0  58 c2 aa ab  56 a7 bf b3  50 08 0a d7
|   73 ec 70 17  a4 04 92 4b  fd 29 c8 69  c7 a4 87 9e
|   3a 05 8b 03  47 d3 49 06  b3 ba c0 ee  3b 22 5a 65
|   61 f3 68 08  82 d6 d5 14  2e b0 1a 87  87 71 91 34
|   3f 5d da 2d  b7 9c 19 42  6d 3a db ec  b7 2e d1 94
|   1f 91 a9 4a  f5 d3 a1 8f  3d d9 da a2  97 15 72 79
|   f7 78 f0 5c  e5 92 37 6d  df bd c0 2f  57 95 5d 24
|   e8 23 0c 1f  ad e1 58 ae  f1 7e 4a 50  a2 dd 23 2d
|   17 dd 92 c7  a9 1b 47 55  87 89 16 1f  d8 91 25 6d
|   ff a0 30 62  c9 34 83 62  c4 36 50 09  bb 5e 3c 24
|   18 e9 e1 89  9a 25 bb fb  99 6c 90 47  c5 c8 73 fe
| inI2: checking NAT-T: 0 and 0
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 1 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #1
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing build_kenonce op id: 1
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #1 
| event added after event EVENT_SHUNT_SCAN
| complete state transition with STF_SUSPEND
"mytunnel" #1: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 53 seconds
| next event EVENT_PENDING_DDNS in 53 seconds
! Local DH secret:
!   24 fc cc b2  17 82 f3 56  d0 d9 93 ac  05 f9 40 d0
!   97 9b 9c 9a  3e f8 cc 0e  5a 67 89 8f  cc c2 fc f5
! Public DH value sent:
!   1a 47 28 ee  a4 30 e3 c7  d3 c6 d8 47  3e 59 9f a4
!   9d 41 2f 27  ab 6b 43 48  c4 85 b2 bb  44 82 15 ca
!   f4 17 35 8c  ed 7b 7f b4  60 00 68 1f  47 c3 dc 19
!   02 c6 22 d0  1d dd 23 80  5f 80 2a 73  aa d0 4a e2
!   4d ca 39 2a  2a 9f 01 87  99 8b 19 02  21 34 17 69
!   bb 08 f2 f9  6f 4a a3 35  eb 4e c1 5c  40 29 5e a8
!   2f 15 67 ea  b8 f1 f1 6f  9e be 51 d3  20 f8 8b 9f
!   34 06 d6 fe  c0 97 38 b7  a9 cf 19 48  c6 86 68 7e
!   4c 52 e5 af  21 e0 33 fa  a3 3b 2a 41  89 0f 7a 4d
!   de e6 89 19  a7 d3 64 2e  da d4 b4 73  11 05 27 be
!   52 3d 08 6c  4c e8 a1 c0  2f 35 14 fa  35 b1 36 7c
!   e2 0b 39 a9  99 c3 00 bb  fe a6 99 cf  db a7 a9 94
! Generated nonce:
!   44 e3 c4 64  63 f3 be fb  5d 26 f7 5f  63 22 0e 9a
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#1
| calling callback function 0x5650f2303aa0
| main inI2_outR2: calculated ke+nonce, sending R2
| processing connection mytunnel
| **emit ISAKMP Message:
|    initiator cookie:
|   93 b3 b6 40  5b 39 92 24
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Key Exchange Payload:
| emitting 192 raw bytes of keyex value into ISAKMP Key Exchange Payload
| keyex value  1a 47 28 ee  a4 30 e3 c7  d3 c6 d8 47  3e 59 9f a4
| keyex value  9d 41 2f 27  ab 6b 43 48  c4 85 b2 bb  44 82 15 ca
| keyex value  f4 17 35 8c  ed 7b 7f b4  60 00 68 1f  47 c3 dc 19
| keyex value  02 c6 22 d0  1d dd 23 80  5f 80 2a 73  aa d0 4a e2
| keyex value  4d ca 39 2a  2a 9f 01 87  99 8b 19 02  21 34 17 69
| keyex value  bb 08 f2 f9  6f 4a a3 35  eb 4e c1 5c  40 29 5e a8
| keyex value  2f 15 67 ea  b8 f1 f1 6f  9e be 51 d3  20 f8 8b 9f
| keyex value  34 06 d6 fe  c0 97 38 b7  a9 cf 19 48  c6 86 68 7e
| keyex value  4c 52 e5 af  21 e0 33 fa  a3 3b 2a 41  89 0f 7a 4d
| keyex value  de e6 89 19  a7 d3 64 2e  da d4 b4 73  11 05 27 be
| keyex value  52 3d 08 6c  4c e8 a1 c0  2f 35 14 fa  35 b1 36 7c
| keyex value  e2 0b 39 a9  99 c3 00 bb  fe a6 99 cf  db a7 a9 94
| emitting length of ISAKMP Key Exchange Payload: 196
| ***emit ISAKMP Nonce Payload:
| emitting 16 raw bytes of Nr into ISAKMP Nonce Payload
| Nr  44 e3 c4 64  63 f3 be fb  5d 26 f7 5f  63 22 0e 9a
| emitting length of ISAKMP Nonce Payload: 20
| emitting length of ISAKMP Message: 244
| main inI2_outR2: starting async DH calculation (group=5)
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| parent1 type: 7 group: 5 len: 2760 
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh+iv op on seq: 2 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #1
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #1 
| event added after event EVENT_SHUNT_SCAN
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing compute dh+iv op id: 2
| started dh_secretiv, returned: stf=STF_SUSPEND 
| complete state transition with STF_OK
! peer's g:   71 c1 ed a2  33 8e 00 cb  5e 45 3f fe  26 58 3b 73
"mytunnel" #1: transition from state STATE_MAIN_R1 to state STATE_MAIN_R2
| deleting event for #1
| sending reply packet to 10.0.2.14:500 (from port 500)
! peer's g:   dd 34 9f e0  58 c2 aa ab  56 a7 bf b3  50 08 0a d7
| sending 244 bytes for STATE_MAIN_R1 through enp0s3:500 to 10.0.2.14:500 (using #1)
|   93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
! peer's g:   73 ec 70 17  a4 04 92 4b  fd 29 c8 69  c7 a4 87 9e
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
|   1a 47 28 ee  a4 30 e3 c7  d3 c6 d8 47  3e 59 9f a4
! peer's g:   3a 05 8b 03  47 d3 49 06  b3 ba c0 ee  3b 22 5a 65
|   9d 41 2f 27  ab 6b 43 48  c4 85 b2 bb  44 82 15 ca
|   f4 17 35 8c  ed 7b 7f b4  60 00 68 1f  47 c3 dc 19
! peer's g:   61 f3 68 08  82 d6 d5 14  2e b0 1a 87  87 71 91 34
|   02 c6 22 d0  1d dd 23 80  5f 80 2a 73  aa d0 4a e2
|   4d ca 39 2a  2a 9f 01 87  99 8b 19 02  21 34 17 69
! peer's g:   3f 5d da 2d  b7 9c 19 42  6d 3a db ec  b7 2e d1 94
|   bb 08 f2 f9  6f 4a a3 35  eb 4e c1 5c  40 29 5e a8
|   2f 15 67 ea  b8 f1 f1 6f  9e be 51 d3  20 f8 8b 9f
! peer's g:   1f 91 a9 4a  f5 d3 a1 8f  3d d9 da a2  97 15 72 79
|   34 06 d6 fe  c0 97 38 b7  a9 cf 19 48  c6 86 68 7e
|   4c 52 e5 af  21 e0 33 fa  a3 3b 2a 41  89 0f 7a 4d
! peer's g:   f7 78 f0 5c  e5 92 37 6d  df bd c0 2f  57 95 5d 24
|   de e6 89 19  a7 d3 64 2e  da d4 b4 73  11 05 27 be
|   52 3d 08 6c  4c e8 a1 c0  2f 35 14 fa  35 b1 36 7c
! peer's g:   e8 23 0c 1f  ad e1 58 ae  f1 7e 4a 50  a2 dd 23 2d
|   e2 0b 39 a9  99 c3 00 bb  fe a6 99 cf  db a7 a9 94
|   00 00 00 14  44 e3 c4 64  63 f3 be fb  5d 26 f7 5f
! peer's g:   17 dd 92 c7  a9 1b 47 55  87 89 16 1f  d8 91 25 6d
|   63 22 0e 9a
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #1 (head of queue)
! peer's g:   ff a0 30 62  c9 34 83 62  c4 36 50 09  bb 5e 3c 24
"mytunnel" #1: STATE_MAIN_R2: sent MR2, expecting MI3
| modecfg pull: noquirk policy:push not-client
! peer's g:   18 e9 e1 89  9a 25 bb fb  99 6c 90 47  c5 c8 73 fe
| phase 1 is done, looking for phase 2 to unpend
| * processed 1 messages from cryptographic helpers 
! long term secret:   24 fc cc b2  17 82 f3 56  d0 d9 93 ac  05 f9 40 d0
| next event EVENT_RETRANSMIT in 10 seconds for #1 (2020-01-27 11:22:19)
| next event EVENT_RETRANSMIT in 10 seconds for #1 (2020-01-27 11:22:19)
! long term secret:   97 9b 9c 9a  3e f8 cc 0e  5a 67 89 8f  cc c2 fc f5
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP1536): 977 usec
! DH shared-secret:
!   a1 27 86 25  c2 c6 4f e9  b8 b9 dd c2  67 0c 76 62
!   90 b8 73 58  dc ed d8 36  8e ee 9a 09  16 60 12 2f
!   e3 66 be 64  c0 79 18 be  4a b6 16 41  b2 33 db 94
!   f9 28 6f 0a  df ad 7a a7  67 09 2a 3d  c8 b4 21 3c
!   4c ec 91 f5  43 69 93 41  ee ef d4 74  0e d4 1f 29
!   9a 2f ad ac  70 e2 e7 41  15 ae 7f 56  c8 96 d9 3e
!   e2 dc d4 0e  7f d3 28 0a  a7 26 58 67  c5 40 c6 bc
!   83 1c c6 de  91 0b 4f 4d  cc a7 b8 25  96 e9 18 e0
!   37 89 70 15  fa d6 9e b4  99 3a f9 bb  67 97 51 ea
!   bc 92 4d 07  01 69 1c f0  90 98 24 0a  9a bf 52 a0
!   9e 4d 2f 49  ff 84 e8 c4  8e fd e6 79  b4 5f 8a 89
!   37 33 b6 43  14 02 b7 66  53 f5 30 79  49 f8 d2 5b
! Skey inputs (PSK+NI+NR)
! ni:   f1 fd 1f 69  82 cf 2b 84  0a 4d d4 d9  bb 9e ba 0b
! nr:   44 e3 c4 64  63 f3 be fb  5d 26 f7 5f  63 22 0e 9a
! keyid:   53 04 44 e7  7c 19 be 5e  36 67 dc b7  7b 50 32 8b
! keyid:   b0 43 b9 b5
! NSS: end of key computation 
! DH_i:  71 c1 ed a2  33 8e 00 cb  5e 45 3f fe  26 58 3b 73
! DH_i:  dd 34 9f e0  58 c2 aa ab  56 a7 bf b3  50 08 0a d7
! DH_i:  73 ec 70 17  a4 04 92 4b  fd 29 c8 69  c7 a4 87 9e
! DH_i:  3a 05 8b 03  47 d3 49 06  b3 ba c0 ee  3b 22 5a 65
! DH_i:  61 f3 68 08  82 d6 d5 14  2e b0 1a 87  87 71 91 34
! DH_i:  3f 5d da 2d  b7 9c 19 42  6d 3a db ec  b7 2e d1 94
! DH_i:  1f 91 a9 4a  f5 d3 a1 8f  3d d9 da a2  97 15 72 79
! DH_i:  f7 78 f0 5c  e5 92 37 6d  df bd c0 2f  57 95 5d 24
! DH_i:  e8 23 0c 1f  ad e1 58 ae  f1 7e 4a 50  a2 dd 23 2d
! DH_i:  17 dd 92 c7  a9 1b 47 55  87 89 16 1f  d8 91 25 6d
! DH_i:  ff a0 30 62  c9 34 83 62  c4 36 50 09  bb 5e 3c 24
! DH_i:  18 e9 e1 89  9a 25 bb fb  99 6c 90 47  c5 c8 73 fe
! DH_r:  1a 47 28 ee  a4 30 e3 c7  d3 c6 d8 47  3e 59 9f a4
! DH_r:  9d 41 2f 27  ab 6b 43 48  c4 85 b2 bb  44 82 15 ca
! DH_r:  f4 17 35 8c  ed 7b 7f b4  60 00 68 1f  47 c3 dc 19
! DH_r:  02 c6 22 d0  1d dd 23 80  5f 80 2a 73  aa d0 4a e2
! DH_r:  4d ca 39 2a  2a 9f 01 87  99 8b 19 02  21 34 17 69
! DH_r:  bb 08 f2 f9  6f 4a a3 35  eb 4e c1 5c  40 29 5e a8
! DH_r:  2f 15 67 ea  b8 f1 f1 6f  9e be 51 d3  20 f8 8b 9f
! DH_r:  34 06 d6 fe  c0 97 38 b7  a9 cf 19 48  c6 86 68 7e
! DH_r:  4c 52 e5 af  21 e0 33 fa  a3 3b 2a 41  89 0f 7a 4d
! DH_r:  de e6 89 19  a7 d3 64 2e  da d4 b4 73  11 05 27 be
! DH_r:  52 3d 08 6c  4c e8 a1 c0  2f 35 14 fa  35 b1 36 7c
! DH_r:  e2 0b 39 a9  99 c3 00 bb  fe a6 99 cf  db a7 a9 94
! end of IV generation 
! Skeyid:    53 04 44 e7  7c 19 be 5e  36 67 dc b7  7b 50 32 8b
! Skeyid:    b0 43 b9 b5
! Skeyid_d:  67 eb e9 a6  58 8e da 6f  d5 75 8f 5a  32 5b e7 20
! Skeyid_d:  f7 45 de c6
! Skeyid_a:  ec 47 4c 30  ff b7 b4 63  71 99 ab 51  5d 75 f7 2d
! Skeyid_a:  44 71 f9 de
! Skeyid_e:  69 d6 e3 f6  c6 d8 89 ac  b8 e8 75 dc  fd b3 75 9c
! Skeyid_e:  aa 2d 8f a8
! enc key:  69 d6 e3 f6  c6 d8 89 ac  b8 e8 75 dc  fd b3 75 9c
! IV:  f0 33 2c b2  25 04 05 cc  81 2c 68 b8  ee 7a ec 22
! IV:  c9 3f 2c 6c
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#2
| calling callback function 0x5650f2303250
| main inI2_outR2: calculated DH finished
| processing connection mytunnel
| WARNING: finish_dh_secretiv:160: encryptor 'aes' expects keylen 16/128, SA #1 INITIATOR keylen is 20
| WARNING: finish_dh_secretiv:160: encryptor 'aes' expects keylen 16/128, SA #1 RESPONDER keylen is 0
| WARNING: main_inI2_outR2_calcdone:1230: encryptor 'aes' expects keylen 16/128, SA #1 INITIATOR keylen is 20
| WARNING: main_inI2_outR2_calcdone:1230: encryptor 'aes' expects keylen 16/128, SA #1 RESPONDER keylen is 0
| * processed 1 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #1 (2020-01-27 11:22:19)
| next event EVENT_RETRANSMIT in 10 seconds for #1 (2020-01-27 11:22:19)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L
| *received 76 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:20
|   93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
|   05 10 02 01  00 00 00 00  00 00 00 4c  a6 6f db 5a
|   a1 76 08 2c  63 c9 83 90  f1 11 1b a5  87 3c 19 e8
|   65 08 24 3f  f4 15 29 51  e9 91 03 76  f3 71 97 88
|   aa 89 8e 25  b8 7a 12 54  d3 b9 40 8f
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   93 b3 b6 40  5b 39 92 24
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  00 00 00 00
|    length: 76
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  93 b3 b6 40  5b 39 92 24
| RCOOKIE:  23 fb be d9  c1 97 e9 7a
| state hash entry 12
| v1 peer and cookies match on #1, provided msgid 00000000 vs 00000000
| v1 state object #1 found, in STATE_MAIN_R2
| processing connection mytunnel
| received encrypted packet from 10.0.2.14:500
| decrypting 48 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   08 00 00 0c  01 00 00 00  0a 00 02 0e  00 00 00 18
|   02 0e 88 d6  67 fe 72 08  39 c2 cc 79  68 de 01 9b
|   f6 cf 86 b7  00 00 00 00  00 00 00 00  00 00 00 00
| next IV:  f3 71 97 88  aa 89 8e 25  b8 7a 12 54  d3 b9 40 8f
| got payload 0x20(ISAKMP_NEXT_ID) needed: 0x120 opt: 0x2080
| ***parse ISAKMP Identification Payload:
|    length: 12
|    ID type: ID_IPV4_ADDR
|    DOI specific A: 0
|    DOI specific B: 0
|      obj:   0a 00 02 0e
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x2080
| ***parse ISAKMP Hash Payload:
|    length: 24
| removing 12 bytes of padding
"mytunnel" #1: Main mode peer ID is ID_IPV4_ADDR: '10.0.2.14'
| refine_connection: starting with mytunnel
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
|    match_id a=10.0.2.14
|             b=10.0.2.14
|    results  matched
|   trusted_ca_by_name called with a=(empty) b=(empty)
| refine_connection: checking mytunnel against mytunnel, best=(none) with match=1(id=1/ca=1/reqca=1)
| refine_connection: checked mytunnel against mytunnel, now for see if best
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| offered CA: '%none'
| hashing 88 bytes of SA
| authentication succeeded
| thinking about whether to send my certificate:
|   I have RSA key: OAKLEY_PRESHARED_KEY cert.type: CERT_NONE 
|   sendcert: CERT_SENDIFASKED and I did not get a certificate request 
|   so do not send cert.
| I did not send a certificate because digital signatures are not being used. (PSK)
| **emit ISAKMP Message:
|    initiator cookie:
|   93 b3 b6 40  5b 39 92 24
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  00 00 00 00
| ***emit ISAKMP Identification Payload (IPsec DOI):
|    ID type: ID_IPV4_ADDR
|    Protocol ID: 0
|    port: 0
| emitting 4 raw bytes of my identity into ISAKMP Identification Payload (IPsec DOI)
| my identity  0a 00 02 0f
| emitting length of ISAKMP Identification Payload (IPsec DOI): 12
| hashing 88 bytes of SA
| ***emit ISAKMP Hash Payload:
| emitting 20 raw bytes of HASH_R into ISAKMP Hash Payload
| HASH_R  76 88 f2 7a  d0 a9 27 9d  07 fc 7c 89  92 47 eb 53
| HASH_R  59 8d 8b c5
| emitting length of ISAKMP Hash Payload: 24
| out_vendorid(): sending [CAN-IKEv2]
| ***emit ISAKMP Vendor ID Payload:
| emitting 5 raw bytes of V_ID into ISAKMP Vendor ID Payload
| V_ID  49 4b 45 76  32
| emitting length of ISAKMP Vendor ID Payload: 9
| encrypting:
|   08 00 00 0c  01 00 00 00  0a 00 02 0f  0d 00 00 18
|   76 88 f2 7a  d0 a9 27 9d  07 fc 7c 89  92 47 eb 53
|   59 8d 8b c5  00 00 00 09  49 4b 45 76  32
| IV:
|   f3 71 97 88  aa 89 8e 25  b8 7a 12 54  d3 b9 40 8f
| unpadded size is: 45
| emitting 3 zero bytes of encryption padding into ISAKMP Message
| encrypting 48 using OAKLEY_AES_CBC
| next IV:  74 ed 59 36  9e 1b 56 af  bc ed 89 66  2a ab cc 77
| emitting length of ISAKMP Message: 76
| last encrypted block of Phase 1:
|   74 ed 59 36  9e 1b 56 af  bc ed 89 66  2a ab cc 77
| complete state transition with STF_OK
"mytunnel" #1: transition from state STATE_MAIN_R2 to state STATE_MAIN_R3
| deleting event for #1
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 76 bytes for STATE_MAIN_R2 through enp0s3:500 to 10.0.2.14:500 (using #1)
|   93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
|   05 10 02 01  00 00 00 00  00 00 00 4c  7c 72 d4 6f
|   63 d6 44 42  d7 eb 8f c5  a6 01 21 14  be 58 3d 4a
|   d2 d4 96 48  b5 c2 12 a1  70 c3 c2 d6  74 ed 59 36
|   9e 1b 56 af  bc ed 89 66  2a ab cc 77
| inserting event EVENT_SA_REPLACE, timeout in 3330 seconds for #1 
| event added after event EVENT_SHUNT_SCAN
"mytunnel" #1: STATE_MAIN_R3: sent MR3, ISAKMP SA established {auth=OAKLEY_PRESHARED_KEY oursig= theirsig= cipher=aes_128 prf=oakley_sha group=modp1536}
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| unpending state #1
"mytunnel" #1: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 52 seconds
| next event EVENT_PENDING_DDNS in 52 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L\001
| *received 332 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:21
|   93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
|   08 10 20 01  0e 52 7f 1a  00 00 01 4c  25 0e 57 3f
|   b2 fc 69 0a  d4 6f f5 38  9f a3 0d 3c  a4 29 b0 bb
|   60 ee aa 9a  61 a8 51 19  1f ba dd 9b  24 72 c7 a0
|   eb 0a 01 74  9a ad d5 a6  9a 3e 27 28  93 67 a6 fb
|   74 43 72 85  39 97 2f c6  ce 9c 62 96  f2 47 34 0b
|   ce 8d 9b 3d  82 37 0d a1  35 e7 4e 4d  4f 9b 8d 84
|   a4 9c 71 c3  6d 40 cb cc  4c 1a 90 67  4b 49 44 8b
|   87 22 ac 10  96 26 17 1a  49 82 6d ca  cd be 18 67
|   c3 3a 91 4e  25 f9 59 1c  79 4f 30 de  7b dc 96 d7
|   89 3e 85 28  16 a4 a2 b4  de a4 ee a8  9b 35 31 67
|   27 31 a8 b6  29 06 22 7a  eb b9 af ca  c4 4d 43 8e
|   5b 08 49 3f  16 4a fb 69  c0 5c cc 70  47 a8 44 c9
|   58 14 98 e4  8d 7a 20 e1  0c b0 ea b1  10 9b 53 28
|   76 a2 a5 bf  a9 28 34 9c  ff 12 28 1d  ec e4 c8 ee
|   a4 38 79 0b  84 e6 aa 04  ac e2 38 80  97 e0 bf bc
|   0f 99 b4 ed  e9 59 75 c1  79 a6 79 c1  fc 12 86 53
|   42 88 87 3f  28 c3 f7 00  8f b1 65 d6  9c 9a 62 c6
|   cf 47 a7 4e  a0 f1 f0 c6  de 13 86 4f  7f 75 8f bd
|   90 9a 5e 54  5d e0 5a 72  b9 99 ce 24  48 5c 76 ac
|   cf 5f 68 ab  a7 2a ff 97  70 8c 5d 90
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   93 b3 b6 40  5b 39 92 24
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  0e 52 7f 1a
|    length: 332
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_QUICK (32), msgid: 240287514
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  93 b3 b6 40  5b 39 92 24
| RCOOKIE:  23 fb be d9  c1 97 e9 7a
| state hash entry 12
| v1 peer and cookies match on #1, provided msgid 0e527f1a vs 00000000
| v1 state object not found
| ICOOKIE:  93 b3 b6 40  5b 39 92 24
| RCOOKIE:  23 fb be d9  c1 97 e9 7a
| state hash entry 12
| v1 peer and cookies match on #1, provided msgid 00000000 vs 00000000
| v1 state object #1 found, in STATE_MAIN_R3
| processing connection mytunnel
| last Phase 1 IV:  74 ed 59 36  9e 1b 56 af  bc ed 89 66  2a ab cc 77
| current Phase 1 IV:  74 ed 59 36  9e 1b 56 af  bc ed 89 66  2a ab cc 77
| computed Phase 2 IV:
|   00 95 38 b2  c0 ee 51 a2  71 59 86 71  8d 43 14 1b
|   1d 21 b1 d5
| received encrypted packet from 10.0.2.14:500
| decrypting 304 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   01 00 00 18  35 5d 7b 0e  f9 49 8c 9a  b2 8f c7 ec
|   12 06 93 8b  f5 a2 ec 3e  0a 00 00 38  00 00 00 01
|   00 00 00 01  00 00 00 2c  00 03 04 01  95 46 83 c5
|   00 00 00 20  00 0c 00 00  80 03 00 05  80 04 00 01
|   80 01 00 01  80 02 70 80  80 05 00 02  80 06 00 80
|   04 00 00 14  fb 75 5e 22  b3 96 c7 49  c3 8f 60 2e
|   f7 3d d8 fb  00 00 00 c4  46 5c 84 b4  54 9f 1c f1
|   1f db b9 99  5c ab e7 3c  c4 8a c4 0c  ae 01 97 40
|   67 db 64 e0  e0 20 63 6f  92 78 7e e1  bb 4c 7d bb
|   60 87 39 87  59 de 44 b9  c9 8e ca e9  6e b2 b9 03
|   2d d2 1b 5c  57 e7 95 5e  65 22 57 4b  18 e9 30 14
|   01 b3 03 26  fa 85 fd f8  f1 3b 98 65  dc 7e ca 7b
|   9f 11 33 4c  ef ee 2d 42  44 3a ed ee  23 2b 0a 01
|   fe 53 17 1a  92 6c ff af  d0 64 06 75  ca 6e 9d f2
|   de 73 54 93  ee 01 aa e2  ce 0b 56 cf  0e ee 50 66
|   01 7a 74 20  fa 2c af 22  82 39 3e 16  84 fb 4d 61
|   13 05 0c ea  91 4d a4 3b  f8 45 0c af  d9 7b df 59
|   91 f3 a7 e9  90 9a 61 dc  17 2c f1 b6  50 e7 e3 bf
|   72 d8 d0 20  12 eb 26 9d  00 00 00 00  00 00 00 00
| next IV:  48 5c 76 ac  cf 5f 68 ab  a7 2a ff 97  70 8c 5d 90
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x502 opt: 0x200030
| ***parse ISAKMP Hash Payload:
|    length: 24
| got payload 0x2(ISAKMP_NEXT_SA) needed: 0x402 opt: 0x200030
| ***parse ISAKMP Security Association Payload:
|    length: 56
|    DOI: ISAKMP_DOI_IPSEC
| got payload 0x400(ISAKMP_NEXT_NONCE) needed: 0x400 opt: 0x200030
| ***parse ISAKMP Nonce Payload:
|    length: 20
| got payload 0x10(ISAKMP_NEXT_KE) needed: 0x0 opt: 0x200030
| ***parse ISAKMP Key Exchange Payload:
|    length: 196
| removing 8 bytes of padding
| HASH(1) computed:
|   35 5d 7b 0e  f9 49 8c 9a  b2 8f c7 ec  12 06 93 8b
|   f5 a2 ec 3e
"mytunnel" #1: the peer proposed: 10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0
| find_client_connection starting with mytunnel
|   looking for 10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0
|   concrete checking against sr#0 10.0.2.15/32 -> 10.0.2.14/32
|    match_id a=10.0.2.14
|             b=10.0.2.14
|    results  matched
|   trusted_ca_by_name called with a=(empty) b=(empty)
|   fc_try trying mytunnel:10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0 vs mytunnel:<type:%address:0/0 -> <type:%address:0/0
|   fc_try concluding with mytunnel [128]
|   fc_try mytunnel gives mytunnel
|   concluding with d = mytunnel
| client wildcard: no  port wildcard: no  virtual: no
| duplicating state object #1
| creating state object #2 at 0x5650f3381a40
| processing connection mytunnel
| ICOOKIE:  93 b3 b6 40  5b 39 92 24
| RCOOKIE:  23 fb be d9  c1 97 e9 7a
| state hash entry 12
| inserting state object #2 bucket: 12
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #2 (head of queue)
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 44
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| parsing 4 raw bytes of ISAKMP Proposal Payload into SPI
| SPI  95 46 83 c5
| *****parse ISAKMP Transform Payload (ESP):
|    length: 32
|    transform number: 0
|    transform ID: ESP_AES
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: ENCAPSULATION_MODE
|    length/value: 1
|    [1 is ENCAPSULATION_MODE_TUNNEL]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_TYPE
|    length/value: 1
|    [1 is SA_LIFE_TYPE_SECONDS]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_DURATION
|    length/value: 28800
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: AUTH_ALGORITHM
|    length/value: 2
|    [2 is AUTH_ALGORITHM_HMAC_SHA1]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: KEY_LENGTH
|    length/value: 128
| kernel_alg_esp_enc_ok(12,128): alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| DH public value received:
|   46 5c 84 b4  54 9f 1c f1  1f db b9 99  5c ab e7 3c
|   c4 8a c4 0c  ae 01 97 40  67 db 64 e0  e0 20 63 6f
|   92 78 7e e1  bb 4c 7d bb  60 87 39 87  59 de 44 b9
|   c9 8e ca e9  6e b2 b9 03  2d d2 1b 5c  57 e7 95 5e
|   65 22 57 4b  18 e9 30 14  01 b3 03 26  fa 85 fd f8
|   f1 3b 98 65  dc 7e ca 7b  9f 11 33 4c  ef ee 2d 42
|   44 3a ed ee  23 2b 0a 01  fe 53 17 1a  92 6c ff af
|   d0 64 06 75  ca 6e 9d f2  de 73 54 93  ee 01 aa e2
|   ce 0b 56 cf  0e ee 50 66  01 7a 74 20  fa 2c af 22
|   82 39 3e 16  84 fb 4d 61  13 05 0c ea  91 4d a4 3b
|   f8 45 0c af  d9 7b df 59  91 f3 a7 e9  90 9a 61 dc
|   17 2c f1 b6  50 e7 e3 bf  72 d8 d0 20  12 eb 26 9d
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 3 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #2
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing build_kenonce op id: 3
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #2 
| event added after event EVENT_SHUNT_SCAN
! Local DH secret:
| complete state transition with STF_SUSPEND
"mytunnel" #2: [PIET]   read_packet returned false...(demux.c)
!   36 db d1 53  ef 1a e3 fe  35 c7 2d a8  34 c1 08 b4
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
!   0b b8 b1 5d  4a 12 70 e9  e3 d9 c4 88  2f 52 e6 92
| next event EVENT_PENDING_DDNS in 51 seconds
| next event EVENT_PENDING_DDNS in 51 seconds
! Public DH value sent:
!   9e b0 d9 8e  26 e5 74 75  41 c8 8d cd  90 cf f9 b6
!   fe 04 5c 6b  39 e2 43 9b  0c 2f b5 dd  eb a0 81 9f
!   c4 64 a4 56  76 cd a4 58  69 22 74 85  10 29 f0 20
!   82 a4 53 5e  89 5a cb e6  20 e8 42 37  5d 86 f7 f7
!   b6 02 97 59  3d 20 53 f4  00 b5 fd b0  d9 6d e1 f5
!   d5 e1 96 b4  fa 8f 9d 32  8d 6f 2a 30  7e d4 5f c5
!   be 4d b2 f0  91 13 0a dd  99 14 43 a7  97 1a 5d c3
!   ee c7 4c 0f  ed a8 d5 91  2d 69 64 35  d5 8e 86 b7
!   a8 43 96 7d  65 ca 9b e4  f0 c1 e3 e5  44 25 91 26
!   17 34 9f fd  c1 49 06 52  28 5f b2 a2  6c 69 01 e3
!   21 cb fb a9  bb 72 a1 55  31 97 ad 85  a8 3a c6 d2
!   58 ad 6b bf  79 e3 d7 47  f5 8c 8e 51  ad 45 1d 0a
! Generated nonce:
!   fc cb 14 46  46 65 06 10  79 71 95 1c  2f 93 0b d1
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#3
| calling callback function 0x5650f230ae60
| quick inI1_outR1: calculated ke+nonce, calculating DH
| processing connection mytunnel
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh(p2) op on seq: 4 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #2
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #2 
! helper 0 read 2752+4/2760 bytesfd: 8
| event added after event EVENT_SHUNT_SCAN
| * processed 1 messages from cryptographic helpers 
! helper 0 doing compute dh(p2) op id: 4
| next event EVENT_PENDING_DDNS in 51 seconds
| next event EVENT_PENDING_DDNS in 51 seconds
! peer's g:   46 5c 84 b4  54 9f 1c f1  1f db b9 99  5c ab e7 3c
! peer's g:   c4 8a c4 0c  ae 01 97 40  67 db 64 e0  e0 20 63 6f
! peer's g:   92 78 7e e1  bb 4c 7d bb  60 87 39 87  59 de 44 b9
! peer's g:   c9 8e ca e9  6e b2 b9 03  2d d2 1b 5c  57 e7 95 5e
! peer's g:   65 22 57 4b  18 e9 30 14  01 b3 03 26  fa 85 fd f8
! peer's g:   f1 3b 98 65  dc 7e ca 7b  9f 11 33 4c  ef ee 2d 42
! peer's g:   44 3a ed ee  23 2b 0a 01  fe 53 17 1a  92 6c ff af
! peer's g:   d0 64 06 75  ca 6e 9d f2  de 73 54 93  ee 01 aa e2
! peer's g:   ce 0b 56 cf  0e ee 50 66  01 7a 74 20  fa 2c af 22
! peer's g:   82 39 3e 16  84 fb 4d 61  13 05 0c ea  91 4d a4 3b
! peer's g:   f8 45 0c af  d9 7b df 59  91 f3 a7 e9  90 9a 61 dc
! peer's g:   17 2c f1 b6  50 e7 e3 bf  72 d8 d0 20  12 eb 26 9d
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP1536): 759 usec
! DH shared-secret:
!   93 f6 15 69  d0 ea ed cf  f0 fa 51 c1  6b 83 3a 9f
!   7c d3 2b bf  8a b8 79 39  7e c5 e2 0e  0f 93 8d 6c
!   01 94 01 60  65 f3 31 96  e8 ed 53 29  d1 ad 8e 21
!   93 0b 03 e5  13 e7 59 1e  1b dd f1 b9  4b f2 75 ca
!   d3 e8 b9 6a  32 74 74 c5  6c 44 d0 76  54 55 33 2a
!   db 02 2f 42  3a 03 a9 06  0e 09 09 c0  55 a1 37 11
!   43 f4 8c 30  50 8f ab 4c  4a 40 67 75  8e 7a 53 9c
!   0b 5d bc f0  5f 9c 86 45  df 81 ae 52  0c 40 09 fb
!   77 de a7 ad  d0 ac 99 2e  8b e2 62 48  d4 53 9b a8
!   61 cf 83 23  47 51 7a cc  1d 1f f0 82  e1 33 05 f6
!   be 9d a0 5e  d7 c4 a2 09  2e fb ad f7  98 a2 fd 15
!   6e 6f aa 5b  b2 b3 22 82  df 63 21 5c  90 36 34 6a
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#4
| calling callback function 0x5650f230b210
| quick inI1_outR1: calculated DH, sending R1
| processing connection mytunnel
| **emit ISAKMP Message:
|    initiator cookie:
|   93 b3 b6 40  5b 39 92 24
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  0e 52 7f 1a
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Security Association Payload:
|    DOI: ISAKMP_DOI_IPSEC
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 44
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| parsing 4 raw bytes of ISAKMP Proposal Payload into SPI
| SPI  95 46 83 c5
| *****parse ISAKMP Transform Payload (ESP):
|    length: 32
|    transform number: 0
|    transform ID: ESP_AES
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: ENCAPSULATION_MODE
|    length/value: 1
|    [1 is ENCAPSULATION_MODE_TUNNEL]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_TYPE
|    length/value: 1
|    [1 is SA_LIFE_TYPE_SECONDS]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_DURATION
|    length/value: 28800
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: AUTH_ALGORITHM
|    length/value: 2
|    [2 is AUTH_ALGORITHM_HMAC_SHA1]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: KEY_LENGTH
|    length/value: 128
| kernel_alg_esp_enc_ok(12,128): alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| ****emit IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****emit ISAKMP Proposal Payload:
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| netlink_get_spi: allocated 0xfb729cc for esp.0@10.0.2.15
| emitting 4 raw bytes of SPI into ISAKMP Proposal Payload
| SPI  0f b7 29 cc
| *****emit ISAKMP Transform Payload (ESP):
|    transform number: 0
|    transform ID: ESP_AES
| emitting 24 raw bytes of attributes into ISAKMP Transform Payload (ESP)
| attributes  80 03 00 05  80 04 00 01  80 01 00 01  80 02 70 80
| attributes  80 05 00 02  80 06 00 80
| emitting length of ISAKMP Transform Payload (ESP): 32
| emitting length of ISAKMP Proposal Payload: 44
| emitting length of ISAKMP Security Association Payload: 56
"mytunnel" #2: responding to Quick Mode proposal {msgid:1a7f520e}
"mytunnel" #2:     us: 10.0.2.15
"mytunnel" #2:   them: 10.0.2.14
| ***emit ISAKMP Nonce Payload:
| emitting 16 raw bytes of Nr into ISAKMP Nonce Payload
| Nr  fc cb 14 46  46 65 06 10  79 71 95 1c  2f 93 0b d1
| emitting length of ISAKMP Nonce Payload: 20
| ***emit ISAKMP Key Exchange Payload:
| emitting 192 raw bytes of keyex value into ISAKMP Key Exchange Payload
| keyex value  9e b0 d9 8e  26 e5 74 75  41 c8 8d cd  90 cf f9 b6
| keyex value  fe 04 5c 6b  39 e2 43 9b  0c 2f b5 dd  eb a0 81 9f
| keyex value  c4 64 a4 56  76 cd a4 58  69 22 74 85  10 29 f0 20
| keyex value  82 a4 53 5e  89 5a cb e6  20 e8 42 37  5d 86 f7 f7
| keyex value  b6 02 97 59  3d 20 53 f4  00 b5 fd b0  d9 6d e1 f5
| keyex value  d5 e1 96 b4  fa 8f 9d 32  8d 6f 2a 30  7e d4 5f c5
| keyex value  be 4d b2 f0  91 13 0a dd  99 14 43 a7  97 1a 5d c3
| keyex value  ee c7 4c 0f  ed a8 d5 91  2d 69 64 35  d5 8e 86 b7
| keyex value  a8 43 96 7d  65 ca 9b e4  f0 c1 e3 e5  44 25 91 26
| keyex value  17 34 9f fd  c1 49 06 52  28 5f b2 a2  6c 69 01 e3
| keyex value  21 cb fb a9  bb 72 a1 55  31 97 ad 85  a8 3a c6 d2
| keyex value  58 ad 6b bf  79 e3 d7 47  f5 8c 8e 51  ad 45 1d 0a
| emitting length of ISAKMP Key Exchange Payload: 196
| HASH(2) computed:
|   ef 97 8f 99  04 f2 ac 99  84 09 a6 2d  e6 92 81 51
|   5f 49 cb 87
| compute_proto_keymat:needed_len (after ESP enc)=16
| compute_proto_keymat:needed_len (after ESP auth)=36
| ESP KEYMAT 
|   KEYMAT computed:
|   b8 bf 26 99  cf 38 5a 17  98 05 7f 02  e3 1b bf e7
|   38 e8 67 4b  ac d9 4a 66  bf 7a 73 b0  8d 74 84 20
|   f2 75 60 de
|   Peer KEYMAT computed:
|   89 c7 e1 10  54 00 15 42  88 25 76 45  87 c3 33 6d
|   8c 88 ed d8  cf cb 46 23  5d 9b cc 75  06 a8 b3 fc
|   a1 21 ec 05
| install_inbound_ipsec_sa() checking if we can route
| route owner of "mytunnel" unrouted: NULL; eroute owner: NULL
| could_route called for mytunnel (kind=CK_PERMANENT)
|    routing is easy, or has resolvable near-conflict
| checking if this is a replacement state
|   st=0x5650f3381a40 ost=(nil) st->serialno=#2 ost->serialno=#0 
| installing outgoing SA now as refhim=0
| state #2(mytunnel): setup outbound esp-ipsec between 10.0.2.15<->10.0.2.14 for 10.0.2.15/32...10.0.2.14/32
| ipcomp maybe
| esp outbound maybe
| looking for outbound alg with transid: 12 keylen: 128 auth: 2 for spi=c5834695 [10.0.2.15->10.0.2.14] 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| ESP enckey:  89 c7 e1 10  54 00 15 42  88 25 76 45  87 c3 33 6d
| ESP authkey:  8c 88 ed d8  cf cb 46 23  5d 9b cc 75  06 a8 b3 fc
| ESP authkey:  a1 21 ec 05
| creating SA spi=954683c5@0a00020e proto=50 family=2
| outgoing SA has refhim=4294901761
| state #2(mytunnel): setup inbound esp-ipsec between 10.0.2.14<->10.0.2.15 for 10.0.2.14/32...10.0.2.15/32
| ipcomp maybe
| esp inbound maybe
| looking for inbound alg with transid: 12 keylen: 128 auth: 2 for spi=cc29b70f [10.0.2.14->10.0.2.15] 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| ESP enckey:  b8 bf 26 99  cf 38 5a 17  98 05 7f 02  e3 1b bf e7
| ESP authkey:  38 e8 67 4b  ac d9 4a 66  bf 7a 73 b0  8d 74 84 20
| ESP authkey:  f2 75 60 de
| updating SA spi=0fb729cc@0a00020f proto=50 family=2
| creating SPD to 10.0.2.14->spi=00010000@10.0.2.15 proto=4
"mytunnel" #2: add inbound eroute 10.0.2.14/32:0 --0-> 10.0.2.15/32:0 => tun.10000@10.0.2.15 succeeded
| encrypting:
|   01 00 00 18  ef 97 8f 99  04 f2 ac 99  84 09 a6 2d
|   e6 92 81 51  5f 49 cb 87  0a 00 00 38  00 00 00 01
|   00 00 00 01  00 00 00 2c  00 03 04 01  0f b7 29 cc
|   00 00 00 20  00 0c 00 00  80 03 00 05  80 04 00 01
|   80 01 00 01  80 02 70 80  80 05 00 02  80 06 00 80
|   04 00 00 14  fc cb 14 46  46 65 06 10  79 71 95 1c
|   2f 93 0b d1  00 00 00 c4  9e b0 d9 8e  26 e5 74 75
|   41 c8 8d cd  90 cf f9 b6  fe 04 5c 6b  39 e2 43 9b
|   0c 2f b5 dd  eb a0 81 9f  c4 64 a4 56  76 cd a4 58
|   69 22 74 85  10 29 f0 20  82 a4 53 5e  89 5a cb e6
|   20 e8 42 37  5d 86 f7 f7  b6 02 97 59  3d 20 53 f4
|   00 b5 fd b0  d9 6d e1 f5  d5 e1 96 b4  fa 8f 9d 32
|   8d 6f 2a 30  7e d4 5f c5  be 4d b2 f0  91 13 0a dd
|   99 14 43 a7  97 1a 5d c3  ee c7 4c 0f  ed a8 d5 91
|   2d 69 64 35  d5 8e 86 b7  a8 43 96 7d  65 ca 9b e4
|   f0 c1 e3 e5  44 25 91 26  17 34 9f fd  c1 49 06 52
|   28 5f b2 a2  6c 69 01 e3  21 cb fb a9  bb 72 a1 55
|   31 97 ad 85  a8 3a c6 d2  58 ad 6b bf  79 e3 d7 47
|   f5 8c 8e 51  ad 45 1d 0a
| IV:
|   48 5c 76 ac  cf 5f 68 ab  a7 2a ff 97  70 8c 5d 90
| unpadded size is: 296
| emitting 8 zero bytes of encryption padding into ISAKMP Message
| encrypting 304 using OAKLEY_AES_CBC
| next IV:  24 07 bb d4  11 72 eb b5  b0 30 87 c3  fb a1 96 59
| emitting length of ISAKMP Message: 332
| finished processing quick inI1
| complete state transition with STF_OK
"mytunnel" #2: transition from state STATE_QUICK_R0 to state STATE_QUICK_R1
| deleting event for #2
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 332 bytes for STATE_QUICK_R0 through enp0s3:500 to 10.0.2.14:500 (using #2)
|   93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
|   08 10 20 01  0e 52 7f 1a  00 00 01 4c  bb 2a bf f1
|   0e a0 c5 37  77 6a e7 13  e3 34 52 6c  4e 58 34 7a
|   56 93 e1 5d  90 4d 92 93  af 63 25 54  13 83 ac 1b
|   fa 0c 84 32  30 fe 04 16  17 d3 71 6c  13 05 fb 36
|   6b 4d d4 c8  ac 91 02 b6  92 70 8e b2  6f 47 cb 2f
|   d3 fa 9a 93  ed c5 92 60  ae c8 44 14  6f 5a fa a8
|   65 8b ef 81  df c7 5f 39  d1 d9 b7 75  5e 4e 2e 25
|   bb db 73 26  3d 1e 6e f8  a3 7d 97 35  73 af 95 c8
|   83 95 bd 8c  1a 24 bf f6  1d 77 52 d7  a5 41 0a e8
|   d4 f5 be 69  8f b0 69 dc  78 c1 32 23  f7 d9 a1 9c
|   7b 0c 3c 88  b1 5e d7 75  34 03 ce c7  c8 1f 4c 5e
|   86 c2 2d a7  eb 78 0e 1f  47 2e 2e 0d  67 e4 11 5a
|   df a2 3b be  80 7f 22 cf  dc 21 aa f2  9d b6 4a 77
|   3b 95 30 66  3c 0f ce bd  91 c4 af aa  9d f2 eb 1a
|   a9 22 78 66  17 81 7e b8  88 1d 51 5c  fd cd 78 1a
|   85 57 64 8e  7d 55 1c 3b  bc de f7 50  f2 38 5a 4c
|   2b 9b a8 bd  a0 04 3d 80  cc 1c f0 d3  18 6c 88 dd
|   49 71 4c 88  c8 93 33 89  aa 20 f7 98  a7 69 58 1a
|   47 c9 6e ae  4a ca 55 78  61 31 5b 4d  24 07 bb d4
|   11 72 eb b5  b0 30 87 c3  fb a1 96 59
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #2 (head of queue)
"mytunnel" #2: STATE_QUICK_R1: sent QR1, inbound IPsec SA installed, expecting QI2
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| * processed 1 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #2 (2020-01-27 11:22:21)
| next event EVENT_RETRANSMIT in 10 seconds for #2 (2020-01-27 11:22:21)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
<
| *received 60 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:22
|   93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
|   08 10 20 01  0e 52 7f 1a  00 00 00 3c  cd 88 8e 1c
|   15 6f e0 d9  0a c0 29 c5  76 7a 05 f1  9b 0b 88 9a
|   a6 16 95 db  30 3b a4 9b  4a e8 5f d9
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   93 b3 b6 40  5b 39 92 24
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  0e 52 7f 1a
|    length: 60
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_QUICK (32), msgid: 240287514
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  93 b3 b6 40  5b 39 92 24
| RCOOKIE:  23 fb be d9  c1 97 e9 7a
| state hash entry 12
| v1 peer and cookies match on #2, provided msgid 0e527f1a vs 0e527f1a
| v1 state object #2 found, in STATE_QUICK_R1
| processing connection mytunnel
| received encrypted packet from 10.0.2.14:500
| decrypting 32 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   00 00 00 18  9c bb 38 6e  fe bc 05 d3  b3 98 18 92
|   2f 92 3e 63  3f f2 b1 53  00 00 00 00  00 00 00 00
| next IV:  9b 0b 88 9a  a6 16 95 db  30 3b a4 9b  4a e8 5f d9
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x0
| ***parse ISAKMP Hash Payload:
|    length: 24
| removing 8 bytes of padding
| HASH(3) computed:  9c bb 38 6e  fe bc 05 d3  b3 98 18 92  2f 92 3e 63
| HASH(3) computed:  3f f2 b1 53
| state #2: install_ipsec_sa() for outbound only
| route owner of "mytunnel" unrouted: NULL; eroute owner: NULL
| could_route called for mytunnel (kind=CK_PERMANENT)
| state #2: now setting up incoming SA
| sr for #2: unrouted (eroute_owner: #0)
| route owner of "mytunnel" unrouted: NULL; eroute owner: NULL
| route_and_eroute with c: mytunnel (next: none) ero:null esr:{(nil)} ro:null rosr:{(nil)} and state: 2
| eroute_connection: between 10.0.2.15<->10.0.2.14
| creating SPD to 10.0.2.15->spi=00000000@10.0.2.14 proto=4
"mytunnel" #2: eroute_connection add eroute 10.0.2.15/32:0 --0-> 10.0.2.14/32:0 => tun.0@10.0.2.14 succeeded
| command executing up-host
| executing up-host: 2>&1 PLUTO_VERB='up-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| route_and_eroute: firewall_notified: true
| command executing prepare-host
| executing prepare-host: 2>&1 PLUTO_VERB='prepare-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| command executing route-host
| executing route-host: 2>&1 PLUTO_VERB='route-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| route_and_eroute: instance "mytunnel", setting eroute_owner to #2 (was #0) (newest_ipsec_sa=#0)
| inI2: instance mytunnel[0], setting newest_ipsec_sa to #2 (was #0) (spd.eroute=#2)
| complete state transition with STF_OK
"mytunnel" #2: transition from state STATE_QUICK_R1 to state STATE_QUICK_R2
| deleting event for #2
| inserting event EVENT_SA_REPLACE, timeout in 28530 seconds for #2 
| event added after event EVENT_REINIT_SECRET
"mytunnel" #2: STATE_QUICK_R2: IPsec SA established tunnel mode {ESP=>0x954683c5 <0x0fb729cc xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
"mytunnel" #2: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 50 seconds
| next event EVENT_PENDING_DDNS in 50 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L
| *received 76 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:28
|   93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
|   08 10 05 01  4c 08 4a 7b  00 00 00 4c  0c 45 e9 94
|   f1 bf df ec  27 34 dd 54  81 a2 48 74  24 2a be d4
|   7f 0a 2a 03  65 e6 88 25  9b b0 29 e7  62 e3 20 94
|   13 27 d3 03  42 0f af be  bc 36 0b 0a
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   93 b3 b6 40  5b 39 92 24
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  4c 08 4a 7b
|    length: 76
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_INFO (5), msgid: 1275611771
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  93 b3 b6 40  5b 39 92 24
| RCOOKIE:  23 fb be d9  c1 97 e9 7a
| state hash entry 12
| peer and cookies match on #2, provided msgid 00000000 vs 0e527f1a/00000000
| peer and cookies match on #1, provided msgid 00000000 vs 00000000/00000000
| p15 state object #1 found, in STATE_MAIN_R3
| processing connection mytunnel
| last Phase 1 IV:  74 ed 59 36  9e 1b 56 af  bc ed 89 66  2a ab cc 77
| current Phase 1 IV:  74 ed 59 36  9e 1b 56 af  bc ed 89 66  2a ab cc 77
| computed Phase 2 IV:
|   81 ff eb e7  8a 76 84 a9  af 86 76 1b  68 d8 b7 82
|   a3 d5 55 d2
| received encrypted packet from 10.0.2.14:500
| decrypting 48 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   0c 00 00 18  fc ea 56 25  c5 bc 6b f2  6d 7b 72 fa
|   5d 39 a3 65  21 d3 86 8c  00 00 00 10  00 00 00 01
|   03 04 00 01  95 46 83 c5  00 00 00 00  00 00 00 00
| next IV:  62 e3 20 94  13 27 d3 03  42 0f af be  bc 36 0b 0a
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x0
| ***parse ISAKMP Hash Payload:
|    length: 24
| got payload 0x1000(ISAKMP_NEXT_D) needed: 0x0 opt: 0x0
| ***parse ISAKMP Delete Payload:
|    length: 16
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 3
|    SPI size: 4
|    number of SPIs: 1
| removing 8 bytes of padding
| HASH(1) computed:
|   fc ea 56 25  c5 bc 6b f2  6d 7b 72 fa  5d 39 a3 65
|   21 d3 86 8c
| received 'informational' message HASH(1) data ok
| processing connection mytunnel
"mytunnel" #1: received Delete SA(0x954683c5) payload: deleting IPSEC State #2
"mytunnel" #1: deleting state #2 (STATE_QUICK_R2)
| find_phase1_state: found SA #1 for conn 'mytunnel' in state STATE_MAIN_R3
| **emit ISAKMP Message:
|    initiator cookie:
|   93 b3 b6 40  5b 39 92 24
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  47 8a d5 32
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH(1) into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Delete Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 3
|    SPI size: 4
|    number of SPIs: 1
| emitting 4 raw bytes of delete payload into ISAKMP Delete Payload
| delete payload  0f b7 29 cc
| emitting length of ISAKMP Delete Payload: 16
| HASH(1) computed:
|   01 61 e5 aa  f2 12 36 4e  6c 60 94 e7  ac 7b 16 08
|   b8 01 f8 ec
| last Phase 1 IV:  74 ed 59 36  9e 1b 56 af  bc ed 89 66  2a ab cc 77
| current Phase 1 IV:  74 ed 59 36  9e 1b 56 af  bc ed 89 66  2a ab cc 77
| computed Phase 2 IV:
|   55 bb 7e 3d  de 2f cf 57  23 ac ad ec  41 cc 84 b3
|   a9 3b 94 9b
| encrypting:
|   0c 00 00 18  01 61 e5 aa  f2 12 36 4e  6c 60 94 e7
|   ac 7b 16 08  b8 01 f8 ec  00 00 00 10  00 00 00 01
|   03 04 00 01  0f b7 29 cc
| IV:
|   55 bb 7e 3d  de 2f cf 57  23 ac ad ec  41 cc 84 b3
|   a9 3b 94 9b
| unpadded size is: 40
| emitting 8 zero bytes of encryption padding into ISAKMP Message
| encrypting 48 using OAKLEY_AES_CBC
| next IV:  e7 9f 91 55  50 26 00 1d  6e 72 98 5a  d7 e1 ff 6b
| emitting length of ISAKMP Message: 76
| sending 76 bytes for delete notify through enp0s3:500 to 10.0.2.14:500 (using #1)
|   93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
|   08 10 05 01  47 8a d5 32  00 00 00 4c  8a fc 42 b6
|   de ee d6 0d  75 13 2b c1  fd 8d 09 05  40 aa 6b 90
|   fc 08 85 93  c8 1a 76 ff  c6 c1 18 95  e7 9f 91 55
|   50 26 00 1d  6e 72 98 5a  d7 e1 ff 6b
| deleting event for #2
| no suspended cryptographic state for 2 
| removing state object #2
| ICOOKIE:  93 b3 b6 40  5b 39 92 24
| RCOOKIE:  23 fb be d9  c1 97 e9 7a
| state hash entry 12
| command executing down-host
| executing down-host: 2>&1 PLUTO_VERB='down-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| request to replace with shunt a prospective erouted policy with netkey kernel --- experimental
| creating SPD to 10.0.2.15->spi=00000104@0.0.0.0 proto=61
| delete esp.954683c5@10.0.2.14
| creating SPD to 10.0.2.14->spi=00010000@10.0.2.15 proto=255
"mytunnel" #1: delete (half) inbound eroute 10.0.2.14/32:0 --0-> 10.0.2.15/32:0 => unk255.10000@10.0.2.15 succeeded
| delete esp.fb729cc@10.0.2.15
| del:  95 46 83 c5
"mytunnel" #1: received and ignored informational message
| complete state transition with STF_IGNORE
"mytunnel" #1: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 44 seconds
| next event EVENT_PENDING_DDNS in 44 seconds
| deleting event for #2
| freeing state object #2
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\234
| *received 156 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:31
|   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00
|   01 10 02 00  00 00 00 00  00 00 00 9c  0d 00 00 5c
|   00 00 00 01  00 00 00 01  00 00 00 50  00 01 00 02
|   03 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  00 00 00 24  01 01 00 00  80 0b 00 01
|   80 0c 0e 10  80 01 00 07  80 02 00 02  80 03 00 01
|   80 04 00 02  80 0e 00 80  0d 00 00 10  4f 53 57 7e
|   7c 74 59 69  57 59 73 57  00 00 00 14  af ca d7 13
|   68 a1 f1 c9  6b 86 96 fc  77 57 01 00
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 156
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
packet from 10.0.2.14:500: Initiator Cookie must not be zero in phase 1 message
packet from 10.0.2.14:500: [PIET] I detected a ZERO initiator cookie... (ikev1.c)
packet from 10.0.2.14:500: sending notification INVALID_COOKIE to 10.0.2.14:500
| **emit ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Notification Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 0
|    Notify Message Type: INVALID_COOKIE
| emitting length of ISAKMP Notification Payload: 12
| emitting length of ISAKMP Message: 40
| sending 40 bytes for notification packet through enp0s3:500 to 10.0.2.14:500 (using #0)
|   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00
|   0b 10 05 00  00 00 00 00  00 00 00 28  00 00 00 0c
|   00 00 00 01  01 00 00 04
packet from 10.0.2.14:500: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 41 seconds
| next event EVENT_PENDING_DDNS in 41 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\234
| *received 156 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:41
|   ce 12 dc 5e  6a b3 d6 fe  00 00 00 00  00 00 00 00
|   01 10 02 00  00 00 00 00  00 00 00 9c  0d 00 00 5c
|   00 00 00 01  00 00 00 01  00 00 00 50  00 01 00 02
|   03 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  00 00 00 24  01 01 00 00  80 0b 00 01
|   80 0c 0e 10  80 01 00 07  80 02 00 02  80 03 00 01
|   80 04 00 02  80 0e 00 80  0d 00 00 10  4f 53 57 7e
|   7c 74 59 69  57 59 73 57  00 00 00 14  af ca d7 13
|   68 a1 f1 c9  6b 86 96 fc  77 57 01 00
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   ce 12 dc 5e  6a b3 d6 fe
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 156
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| got payload 0x2(ISAKMP_NEXT_SA) needed: 0x2 opt: 0x2080
| ***parse ISAKMP Security Association Payload:
|    length: 92
|    DOI: ISAKMP_DOI_IPSEC
| got payload 0x2000(ISAKMP_NEXT_VID) needed: 0x0 opt: 0x2080
| ***parse ISAKMP Vendor ID Payload:
|    length: 16
| got payload 0x2000(ISAKMP_NEXT_VID) needed: 0x0 opt: 0x2080
| ***parse ISAKMP Vendor ID Payload:
|    length: 20
packet from 10.0.2.14:500: ignoring unknown Vendor ID payload [4f53577e7c74596957597357]
packet from 10.0.2.14:500: received Vendor ID payload [Dead Peer Detection]
| find_host_connection2 called from main_inI1_outR1, me=10.0.2.15:500 him=10.0.2.14:500 policy=/!IKEv1
| find_host_pair: looking for me=10.0.2.15:500 %address him=10.0.2.14:500 any-match 
| find_host_pair: comparing to me=10.0.2.15:500 %address him=10.0.2.14:500 
| find_host_pair: concluded with mytunnel
| found_host_pair_conn (find_host_connection2): 10.0.2.15:500 %address/10.0.2.14:500 -> hp:mytunnel 
| searching for connection with policy = /!IKEv1
| found policy = PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK (mytunnel)
| find_host_connection2 returns mytunnel (ike=none/none)
| creating state object #3 at 0x5650f3381a40
| processing connection mytunnel
| ICOOKIE:  ce 12 dc 5e  6a b3 d6 fe
| RCOOKIE:  bf 82 a3 57  1a d9 08 b8
| state hash entry 29
| inserting state object #3 bucket: 29
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #3 (head of queue)
"mytunnel" #3: responding to Main Mode
| **emit ISAKMP Message:
|    initiator cookie:
|   ce 12 dc 5e  6a b3 d6 fe
|    responder cookie:
|   bf 82 a3 57  1a d9 08 b8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Security Association Payload:
|    DOI: ISAKMP_DOI_IPSEC
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 80
|    proposal number: 0
|    protocol ID: PROTO_ISAKMP
|    SPI size: 0
|    number of transforms: 2
| *****parse ISAKMP Transform Payload (ISAKMP):
|    length: 36
|    transform number: 0
|    transform ID: KEY_IKE
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_LIFE_TYPE
|    length/value: 1
|    [1 is OAKLEY_LIFE_SECONDS]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_LIFE_DURATION
|    length/value: 3600
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_ENCRYPTION_ALGORITHM
|    length/value: 7
|    [7 is OAKLEY_AES_CBC]
| ike_alg_enc_ok(ealg=7,key_len=0): blocksize=16, keyminlen=128, keydeflen=128, keymaxlen=256, ret=1
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_HASH_ALGORITHM
|    length/value: 2
|    [2 is OAKLEY_SHA1]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_AUTHENTICATION_METHOD
|    length/value: 1
|    [1 is OAKLEY_PRESHARED_KEY]
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_KEY_LENGTH
|    length/value: 128
| ike_alg_enc_ok(ealg=7,key_len=128): blocksize=16, keyminlen=128, keydeflen=128, keymaxlen=256, ret=1
| Oakley Transform 0 accepted
| ****emit IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****emit ISAKMP Proposal Payload:
|    proposal number: 0
|    protocol ID: PROTO_ISAKMP
|    SPI size: 0
|    number of transforms: 1
| *****emit ISAKMP Transform Payload (ISAKMP):
|    transform number: 0
|    transform ID: KEY_IKE
| emitting 28 raw bytes of attributes into ISAKMP Transform Payload (ISAKMP)
| attributes  80 0b 00 01  80 0c 0e 10  80 01 00 07  80 02 00 02
| attributes  80 03 00 01  80 04 00 05  80 0e 00 80
| emitting length of ISAKMP Transform Payload (ISAKMP): 36
| emitting length of ISAKMP Proposal Payload: 44
| emitting length of ISAKMP Security Association Payload: 56
| ***emit ISAKMP Vendor ID Payload:
| emitting 12 raw bytes of Vendor ID into ISAKMP Vendor ID Payload
| Vendor ID  4f 53 57 5e  41 76 56 4b  68 7b 55 50
| emitting length of ISAKMP Vendor ID Payload: 16
| out_vendorid(): sending [Dead Peer Detection]
| ***emit ISAKMP Vendor ID Payload:
| emitting 16 raw bytes of V_ID into ISAKMP Vendor ID Payload
| V_ID  af ca d7 13  68 a1 f1 c9  6b 86 96 fc  77 57 01 00
| emitting length of ISAKMP Vendor ID Payload: 20
| sender checking NAT-T: 0 and 0
| emitting length of ISAKMP Message: 120
| peer supports dpd
| complete state transition with STF_OK
"mytunnel" #3: transition from state STATE_MAIN_R0 to state STATE_MAIN_R1
| deleting event for #3
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 120 bytes for STATE_MAIN_R0 through enp0s3:500 to 10.0.2.14:500 (using #3)
|   ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57  1a d9 08 b8
|   01 10 02 00  00 00 00 00  00 00 00 78  0d 00 00 38
|   00 00 00 01  00 00 00 01  00 00 00 2c  00 01 00 01
|   00 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  0d 00 00 10  4f 53 57 5e  41 76 56 4b
|   68 7b 55 50  00 00 00 14  af ca d7 13  68 a1 f1 c9
|   6b 86 96 fc  77 57 01 00
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #3 (head of queue)
"mytunnel" #3: STATE_MAIN_R1: sent MR1, expecting MI2
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
"mytunnel" #3: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #3 (2020-01-27 11:22:41)
| next event EVENT_RETRANSMIT in 10 seconds for #3 (2020-01-27 11:22:41)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\364
| *received 244 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:42
|   ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57  1a d9 08 b8
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
|   1f 16 2c 64  44 2d f8 5f  8c cd b1 ff  93 64 cc bf
|   46 2f d4 92  d5 bd 60 39  80 7f 74 46  00 75 f7 2d
|   78 32 b5 30  4e 05 83 3c  d2 0c 8d f5  63 25 47 8e
|   f6 e9 06 2b  db d6 ec 9b  1d 25 5e d2  ef ff 5b 72
|   a1 d0 90 e7  9c ae 61 9f  7e cf a7 c8  f5 af e5 42
|   2e 64 30 89  73 f4 43 ea  ca 1a 8f 9e  2d f5 fb a3
|   d8 37 81 5e  7c a2 f8 68  81 62 e5 0d  93 e7 f6 46
|   bc 1d 28 a4  7c 91 01 6a  a3 7a ed f8  0f 4b 9d ec
|   45 b2 6b c7  cb 1a 6e 0f  bd e5 65 6d  d8 b3 55 cd
|   ef 24 7f cb  99 1a d3 3f  3f 8b 71 2c  52 91 48 b4
|   89 fe b1 11  7f df 1c b0  9b 7b 58 05  7b 28 76 c0
|   d8 e0 97 8d  49 c9 a6 45  b8 03 42 b7  dd 51 37 85
|   00 00 00 14  bc 39 a4 60  d0 90 1b d1  19 7c 59 7c
|   8e cb 18 ac
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   ce 12 dc 5e  6a b3 d6 fe
|    responder cookie:
|   bf 82 a3 57  1a d9 08 b8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 244
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  ce 12 dc 5e  6a b3 d6 fe
| RCOOKIE:  bf 82 a3 57  1a d9 08 b8
| state hash entry 29
| v1 peer and cookies match on #3, provided msgid 00000000 vs 00000000
| v1 state object #3 found, in STATE_MAIN_R1
| processing connection mytunnel
| got payload 0x10(ISAKMP_NEXT_KE) needed: 0x410 opt: 0x102080
| ***parse ISAKMP Key Exchange Payload:
|    length: 196
| got payload 0x400(ISAKMP_NEXT_NONCE) needed: 0x400 opt: 0x102080
| ***parse ISAKMP Nonce Payload:
|    length: 20
| DH public value received:
|   1f 16 2c 64  44 2d f8 5f  8c cd b1 ff  93 64 cc bf
|   46 2f d4 92  d5 bd 60 39  80 7f 74 46  00 75 f7 2d
|   78 32 b5 30  4e 05 83 3c  d2 0c 8d f5  63 25 47 8e
|   f6 e9 06 2b  db d6 ec 9b  1d 25 5e d2  ef ff 5b 72
|   a1 d0 90 e7  9c ae 61 9f  7e cf a7 c8  f5 af e5 42
|   2e 64 30 89  73 f4 43 ea  ca 1a 8f 9e  2d f5 fb a3
|   d8 37 81 5e  7c a2 f8 68  81 62 e5 0d  93 e7 f6 46
|   bc 1d 28 a4  7c 91 01 6a  a3 7a ed f8  0f 4b 9d ec
|   45 b2 6b c7  cb 1a 6e 0f  bd e5 65 6d  d8 b3 55 cd
|   ef 24 7f cb  99 1a d3 3f  3f 8b 71 2c  52 91 48 b4
|   89 fe b1 11  7f df 1c b0  9b 7b 58 05  7b 28 76 c0
|   d8 e0 97 8d  49 c9 a6 45  b8 03 42 b7  dd 51 37 85
| inI2: checking NAT-T: 0 and 0
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 5 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #3
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing build_kenonce op id: 5
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #3 
| event added after event EVENT_SHUNT_SCAN
! Local DH secret:
| complete state transition with STF_SUSPEND
"mytunnel" #3: [PIET]   read_packet returned false...(demux.c)
!   5c aa 34 0b  4d 8e 3a 01  cc aa 00 10  82 76 8e 35
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
!   5a a4 be 22  56 19 a3 c1  a0 c5 8d f6  40 1e 7b 25
| next event EVENT_PENDING_DDNS in 30 seconds
| next event EVENT_PENDING_DDNS in 30 seconds
! Public DH value sent:
!   2c fa 03 d4  8c 08 b3 5d  6a bf 0d 5a  c5 35 5f d8
!   2b 45 a6 4b  df 01 b5 8a  74 80 11 b3  0e 8c f5 68
!   72 e4 b1 82  fe df 76 ca  22 d0 ac 71  5c 70 36 58
!   18 5f 29 d4  ac 8e f5 cd  a9 72 8d be  d4 49 24 29
!   6d 05 a2 88  1b 60 ca 6a  16 74 01 78  b0 d0 9a 25
!   b8 70 d9 a6  86 9e 01 8f  ab 12 38 5a  8b ac 8a ad
!   48 1c aa a3  7f 21 5d 4f  79 1e 07 79  f1 b0 ad 15
!   c7 02 c3 b3  aa 54 5c 0b  9a c9 71 70  c6 94 3b 83
!   28 a0 27 d4  3b 95 f3 e3  7a e8 b1 ba  ef 40 e5 10
!   b1 ab 1f 85  31 5b f7 b2  6f 04 9b db  0c 0b d1 63
!   97 f5 f2 82  3c 42 4a af  74 75 4b aa  da 09 d7 ef
!   50 3f d4 d3  d1 91 64 2c  55 12 15 88  60 3f 00 7b
! Generated nonce:
!   34 e7 c7 d9  cb c0 4e 63  18 67 46 2e  96 d0 3a b7
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#5
| calling callback function 0x5650f2303aa0
| main inI2_outR2: calculated ke+nonce, sending R2
| processing connection mytunnel
| **emit ISAKMP Message:
|    initiator cookie:
|   ce 12 dc 5e  6a b3 d6 fe
|    responder cookie:
|   bf 82 a3 57  1a d9 08 b8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Key Exchange Payload:
| emitting 192 raw bytes of keyex value into ISAKMP Key Exchange Payload
| keyex value  2c fa 03 d4  8c 08 b3 5d  6a bf 0d 5a  c5 35 5f d8
| keyex value  2b 45 a6 4b  df 01 b5 8a  74 80 11 b3  0e 8c f5 68
| keyex value  72 e4 b1 82  fe df 76 ca  22 d0 ac 71  5c 70 36 58
| keyex value  18 5f 29 d4  ac 8e f5 cd  a9 72 8d be  d4 49 24 29
| keyex value  6d 05 a2 88  1b 60 ca 6a  16 74 01 78  b0 d0 9a 25
| keyex value  b8 70 d9 a6  86 9e 01 8f  ab 12 38 5a  8b ac 8a ad
| keyex value  48 1c aa a3  7f 21 5d 4f  79 1e 07 79  f1 b0 ad 15
| keyex value  c7 02 c3 b3  aa 54 5c 0b  9a c9 71 70  c6 94 3b 83
| keyex value  28 a0 27 d4  3b 95 f3 e3  7a e8 b1 ba  ef 40 e5 10
| keyex value  b1 ab 1f 85  31 5b f7 b2  6f 04 9b db  0c 0b d1 63
| keyex value  97 f5 f2 82  3c 42 4a af  74 75 4b aa  da 09 d7 ef
| keyex value  50 3f d4 d3  d1 91 64 2c  55 12 15 88  60 3f 00 7b
| emitting length of ISAKMP Key Exchange Payload: 196
| ***emit ISAKMP Nonce Payload:
| emitting 16 raw bytes of Nr into ISAKMP Nonce Payload
| Nr  34 e7 c7 d9  cb c0 4e 63  18 67 46 2e  96 d0 3a b7
| emitting length of ISAKMP Nonce Payload: 20
| emitting length of ISAKMP Message: 244
| main inI2_outR2: starting async DH calculation (group=5)
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| parent1 type: 7 group: 5 len: 2760 
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh+iv op on seq: 6 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #3
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing compute dh+iv op id: 6
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #3 
| event added after event EVENT_SHUNT_SCAN
! peer's g:   1f 16 2c 64  44 2d f8 5f  8c cd b1 ff  93 64 cc bf
! peer's g:   46 2f d4 92  d5 bd 60 39  80 7f 74 46  00 75 f7 2d
| started dh_secretiv, returned: stf=STF_SUSPEND 
| complete state transition with STF_OK
! peer's g:   78 32 b5 30  4e 05 83 3c  d2 0c 8d f5  63 25 47 8e
"mytunnel" #3: transition from state STATE_MAIN_R1 to state STATE_MAIN_R2
| deleting event for #3
! peer's g:   f6 e9 06 2b  db d6 ec 9b  1d 25 5e d2  ef ff 5b 72
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 244 bytes for STATE_MAIN_R1 through enp0s3:500 to 10.0.2.14:500 (using #3)
! peer's g:   a1 d0 90 e7  9c ae 61 9f  7e cf a7 c8  f5 af e5 42
|   ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57  1a d9 08 b8
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
! peer's g:   2e 64 30 89  73 f4 43 ea  ca 1a 8f 9e  2d f5 fb a3
|   2c fa 03 d4  8c 08 b3 5d  6a bf 0d 5a  c5 35 5f d8
|   2b 45 a6 4b  df 01 b5 8a  74 80 11 b3  0e 8c f5 68
|   72 e4 b1 82  fe df 76 ca  22 d0 ac 71  5c 70 36 58
|   18 5f 29 d4  ac 8e f5 cd  a9 72 8d be  d4 49 24 29
|   6d 05 a2 88  1b 60 ca 6a  16 74 01 78  b0 d0 9a 25
|   b8 70 d9 a6  86 9e 01 8f  ab 12 38 5a  8b ac 8a ad
|   48 1c aa a3  7f 21 5d 4f  79 1e 07 79  f1 b0 ad 15
|   c7 02 c3 b3  aa 54 5c 0b  9a c9 71 70  c6 94 3b 83
|   28 a0 27 d4  3b 95 f3 e3  7a e8 b1 ba  ef 40 e5 10
|   b1 ab 1f 85  31 5b f7 b2  6f 04 9b db  0c 0b d1 63
|   97 f5 f2 82  3c 42 4a af  74 75 4b aa  da 09 d7 ef
|   50 3f d4 d3  d1 91 64 2c  55 12 15 88  60 3f 00 7b
|   00 00 00 14  34 e7 c7 d9  cb c0 4e 63  18 67 46 2e
|   96 d0 3a b7
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #3 (head of queue)
"mytunnel" #3: STATE_MAIN_R2: sent MR2, expecting MI3
! peer's g:   d8 37 81 5e  7c a2 f8 68  81 62 e5 0d  93 e7 f6 46
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
! peer's g:   bc 1d 28 a4  7c 91 01 6a  a3 7a ed f8  0f 4b 9d ec
| * processed 1 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #3 (2020-01-27 11:22:42)
! peer's g:   45 b2 6b c7  cb 1a 6e 0f  bd e5 65 6d  d8 b3 55 cd
| next event EVENT_RETRANSMIT in 10 seconds for #3 (2020-01-27 11:22:42)
! peer's g:   ef 24 7f cb  99 1a d3 3f  3f 8b 71 2c  52 91 48 b4
! peer's g:   89 fe b1 11  7f df 1c b0  9b 7b 58 05  7b 28 76 c0
! peer's g:   d8 e0 97 8d  49 c9 a6 45  b8 03 42 b7  dd 51 37 85
! long term secret:   5c aa 34 0b  4d 8e 3a 01  cc aa 00 10  82 76 8e 35
! long term secret:   5a a4 be 22  56 19 a3 c1  a0 c5 8d f6  40 1e 7b 25
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP1536): 541 usec
! DH shared-secret:
!   0e 74 fc 4c  cd fb 25 37  51 25 83 cf  a9 f2 20 0d
!   e2 35 74 11  41 06 b6 81  7d 05 d7 54  87 8f de d9
!   3b 10 60 23  67 54 f9 ee  96 4a 26 83  a9 8a e9 ec
!   b9 be a7 3f  2f de c7 25  e9 30 bf c2  2e 70 13 d4
!   65 4f 0d a4  9f 8f d0 e8  e7 cc f9 68  0e 58 ed 6f
!   61 20 3e 17  42 33 11 88  17 15 31 9d  cd 0c f8 94
!   a2 0e 0c 73  8a 62 7f 56  c2 cc fa a2  e3 c6 12 09
!   da e5 f5 99  03 e0 f4 d4  a3 60 0e 48  ce 18 ab 62
!   7e 82 bd e1  3d 8a 2c 8d  d1 1a 9e d0  10 76 e9 5e
!   69 0f a7 77  21 4f c5 63  d4 86 fd 98  f5 a0 b2 34
!   ee e1 63 71  8c d7 0e 3e  b1 3b 2d d0  c6 af ca e4
!   3b fb 24 99  a7 53 13 a2  56 e5 9b 61  59 41 90 c9
! Skey inputs (PSK+NI+NR)
! ni:   bc 39 a4 60  d0 90 1b d1  19 7c 59 7c  8e cb 18 ac
! nr:   34 e7 c7 d9  cb c0 4e 63  18 67 46 2e  96 d0 3a b7
! keyid:   06 00 d2 f7  90 7c da 2a  48 50 73 6b  bd 55 db f5
! keyid:   1f 94 0f 52
! NSS: end of key computation 
! DH_i:  1f 16 2c 64  44 2d f8 5f  8c cd b1 ff  93 64 cc bf
! DH_i:  46 2f d4 92  d5 bd 60 39  80 7f 74 46  00 75 f7 2d
! DH_i:  78 32 b5 30  4e 05 83 3c  d2 0c 8d f5  63 25 47 8e
! DH_i:  f6 e9 06 2b  db d6 ec 9b  1d 25 5e d2  ef ff 5b 72
! DH_i:  a1 d0 90 e7  9c ae 61 9f  7e cf a7 c8  f5 af e5 42
! DH_i:  2e 64 30 89  73 f4 43 ea  ca 1a 8f 9e  2d f5 fb a3
! DH_i:  d8 37 81 5e  7c a2 f8 68  81 62 e5 0d  93 e7 f6 46
! DH_i:  bc 1d 28 a4  7c 91 01 6a  a3 7a ed f8  0f 4b 9d ec
! DH_i:  45 b2 6b c7  cb 1a 6e 0f  bd e5 65 6d  d8 b3 55 cd
! DH_i:  ef 24 7f cb  99 1a d3 3f  3f 8b 71 2c  52 91 48 b4
! DH_i:  89 fe b1 11  7f df 1c b0  9b 7b 58 05  7b 28 76 c0
! DH_i:  d8 e0 97 8d  49 c9 a6 45  b8 03 42 b7  dd 51 37 85
! DH_r:  2c fa 03 d4  8c 08 b3 5d  6a bf 0d 5a  c5 35 5f d8
! DH_r:  2b 45 a6 4b  df 01 b5 8a  74 80 11 b3  0e 8c f5 68
! DH_r:  72 e4 b1 82  fe df 76 ca  22 d0 ac 71  5c 70 36 58
! DH_r:  18 5f 29 d4  ac 8e f5 cd  a9 72 8d be  d4 49 24 29
! DH_r:  6d 05 a2 88  1b 60 ca 6a  16 74 01 78  b0 d0 9a 25
! DH_r:  b8 70 d9 a6  86 9e 01 8f  ab 12 38 5a  8b ac 8a ad
! DH_r:  48 1c aa a3  7f 21 5d 4f  79 1e 07 79  f1 b0 ad 15
! DH_r:  c7 02 c3 b3  aa 54 5c 0b  9a c9 71 70  c6 94 3b 83
! DH_r:  28 a0 27 d4  3b 95 f3 e3  7a e8 b1 ba  ef 40 e5 10
! DH_r:  b1 ab 1f 85  31 5b f7 b2  6f 04 9b db  0c 0b d1 63
! DH_r:  97 f5 f2 82  3c 42 4a af  74 75 4b aa  da 09 d7 ef
! DH_r:  50 3f d4 d3  d1 91 64 2c  55 12 15 88  60 3f 00 7b
! end of IV generation 
! Skeyid:    06 00 d2 f7  90 7c da 2a  48 50 73 6b  bd 55 db f5
! Skeyid:    1f 94 0f 52
! Skeyid_d:  87 61 f6 c9  d4 ef a9 9f  da 90 b2 a5  5f f9 4e 80
! Skeyid_d:  b9 47 1a ff
! Skeyid_a:  c9 f5 75 19  61 62 c2 31  f9 0d ef a2  80 ac ad 3d
! Skeyid_a:  a5 0a 08 10
! Skeyid_e:  c8 a9 0b 40  b0 5d fe 28  ab ee 8c fe  1c c3 c6 6f
! Skeyid_e:  14 15 21 7f
! enc key:  c8 a9 0b 40  b0 5d fe 28  ab ee 8c fe  1c c3 c6 6f
! IV:  12 25 04 9a  ad 85 6f 53  ea e9 d9 7f  5e 61 8c 2e
! IV:  8b ec 5d 81
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#6
| calling callback function 0x5650f2303250
| main inI2_outR2: calculated DH finished
| processing connection mytunnel
| WARNING: finish_dh_secretiv:160: encryptor 'aes' expects keylen 16/128, SA #3 INITIATOR keylen is 20
| WARNING: finish_dh_secretiv:160: encryptor 'aes' expects keylen 16/128, SA #3 RESPONDER keylen is 0
| WARNING: main_inI2_outR2_calcdone:1230: encryptor 'aes' expects keylen 16/128, SA #3 INITIATOR keylen is 20
| WARNING: main_inI2_outR2_calcdone:1230: encryptor 'aes' expects keylen 16/128, SA #3 RESPONDER keylen is 0
| * processed 1 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #3 (2020-01-27 11:22:42)
| next event EVENT_RETRANSMIT in 10 seconds for #3 (2020-01-27 11:22:42)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L
| *received 76 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:43
|   ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57  1a d9 08 b8
|   05 10 02 01  00 00 00 00  00 00 00 4c  6a 31 93 99
|   8e 58 ae 71  30 f4 45 a7  20 93 43 1f  26 ee 70 11
|   75 4c 94 d0  7a a5 30 de  c1 f2 4e e1  a9 3f ae 18
|   48 7b 22 b2  b0 e2 72 6c  22 f6 2b e4
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   ce 12 dc 5e  6a b3 d6 fe
|    responder cookie:
|   bf 82 a3 57  1a d9 08 b8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  00 00 00 00
|    length: 76
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  ce 12 dc 5e  6a b3 d6 fe
| RCOOKIE:  bf 82 a3 57  1a d9 08 b8
| state hash entry 29
| v1 peer and cookies match on #3, provided msgid 00000000 vs 00000000
| v1 state object #3 found, in STATE_MAIN_R2
| processing connection mytunnel
| received encrypted packet from 10.0.2.14:500
| decrypting 48 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   08 00 00 0c  01 00 00 00  0a 00 02 0e  00 00 00 18
|   47 ec 0a d2  9f f2 c3 95  58 a3 5f ff  82 9e 56 a1
|   4b ad 23 b6  00 00 00 00  00 00 00 00  00 00 00 00
| next IV:  a9 3f ae 18  48 7b 22 b2  b0 e2 72 6c  22 f6 2b e4
| got payload 0x20(ISAKMP_NEXT_ID) needed: 0x120 opt: 0x2080
| ***parse ISAKMP Identification Payload:
|    length: 12
|    ID type: ID_IPV4_ADDR
|    DOI specific A: 0
|    DOI specific B: 0
|      obj:   0a 00 02 0e
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x2080
| ***parse ISAKMP Hash Payload:
|    length: 24
| removing 12 bytes of padding
"mytunnel" #3: Main mode peer ID is ID_IPV4_ADDR: '10.0.2.14'
| refine_connection: starting with mytunnel
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
|    match_id a=10.0.2.14
|             b=10.0.2.14
|    results  matched
|   trusted_ca_by_name called with a=(empty) b=(empty)
| refine_connection: checking mytunnel against mytunnel, best=(none) with match=1(id=1/ca=1/reqca=1)
| refine_connection: checked mytunnel against mytunnel, now for see if best
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| offered CA: '%none'
| hashing 88 bytes of SA
| authentication succeeded
| thinking about whether to send my certificate:
|   I have RSA key: OAKLEY_PRESHARED_KEY cert.type: CERT_NONE 
|   sendcert: CERT_SENDIFASKED and I did not get a certificate request 
|   so do not send cert.
| I did not send a certificate because digital signatures are not being used. (PSK)
| **emit ISAKMP Message:
|    initiator cookie:
|   ce 12 dc 5e  6a b3 d6 fe
|    responder cookie:
|   bf 82 a3 57  1a d9 08 b8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  00 00 00 00
| ***emit ISAKMP Identification Payload (IPsec DOI):
|    ID type: ID_IPV4_ADDR
|    Protocol ID: 0
|    port: 0
| emitting 4 raw bytes of my identity into ISAKMP Identification Payload (IPsec DOI)
| my identity  0a 00 02 0f
| emitting length of ISAKMP Identification Payload (IPsec DOI): 12
| hashing 88 bytes of SA
| ***emit ISAKMP Hash Payload:
| emitting 20 raw bytes of HASH_R into ISAKMP Hash Payload
| HASH_R  ed 64 10 a4  7f 46 cc 53  3d 2d b9 a5  b1 48 85 0f
| HASH_R  37 9d e5 36
| emitting length of ISAKMP Hash Payload: 24
| out_vendorid(): sending [CAN-IKEv2]
| ***emit ISAKMP Vendor ID Payload:
| emitting 5 raw bytes of V_ID into ISAKMP Vendor ID Payload
| V_ID  49 4b 45 76  32
| emitting length of ISAKMP Vendor ID Payload: 9
| encrypting:
|   08 00 00 0c  01 00 00 00  0a 00 02 0f  0d 00 00 18
|   ed 64 10 a4  7f 46 cc 53  3d 2d b9 a5  b1 48 85 0f
|   37 9d e5 36  00 00 00 09  49 4b 45 76  32
| IV:
|   a9 3f ae 18  48 7b 22 b2  b0 e2 72 6c  22 f6 2b e4
| unpadded size is: 45
| emitting 3 zero bytes of encryption padding into ISAKMP Message
| encrypting 48 using OAKLEY_AES_CBC
| next IV:  1b a8 c5 6c  a1 5b 13 e3  14 b4 bb 71  18 32 62 3f
| emitting length of ISAKMP Message: 76
| last encrypted block of Phase 1:
|   1b a8 c5 6c  a1 5b 13 e3  14 b4 bb 71  18 32 62 3f
| complete state transition with STF_OK
"mytunnel" #3: transition from state STATE_MAIN_R2 to state STATE_MAIN_R3
| deleting event for #3
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 76 bytes for STATE_MAIN_R2 through enp0s3:500 to 10.0.2.14:500 (using #3)
|   ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57  1a d9 08 b8
|   05 10 02 01  00 00 00 00  00 00 00 4c  a1 68 4c 09
|   1e 5a 25 00  71 c7 60 99  a2 77 6b 5c  9f 21 dd d1
|   5f 2c 27 9a  c0 0c 7c 4b  db b6 3d b3  1b a8 c5 6c
|   a1 5b 13 e3  14 b4 bb 71  18 32 62 3f
| inserting event EVENT_SA_REPLACE, timeout in 3330 seconds for #3 
| event added after event EVENT_SA_REPLACE for #1
"mytunnel" #3: STATE_MAIN_R3: sent MR3, ISAKMP SA established {auth=OAKLEY_PRESHARED_KEY oursig= theirsig= cipher=aes_128 prf=oakley_sha group=modp1536}
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| unpending state #3
"mytunnel" #3: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 29 seconds
| next event EVENT_PENDING_DDNS in 29 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L\001
| *received 332 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:44
|   ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57  1a d9 08 b8
|   08 10 20 01  e0 b8 86 27  00 00 01 4c  e2 3a d9 0c
|   ac ce e3 86  b6 61 cd 2e  88 5d 61 1f  65 5d ba 3b
|   15 43 39 3c  28 5f e0 4d  9f ba 66 e7  07 25 96 12
|   82 6d 55 71  75 ae 83 e2  ec 4b f8 b4  66 6c 38 c8
|   5d 28 d4 56  51 56 ee 68  b1 22 1e 8f  6b 71 50 26
|   f2 d1 ba fe  ae df f6 4c  24 39 08 6e  71 0b 23 a7
|   dc 2d 2e b5  05 dc 87 7b  fc ad 27 d3  fc 75 a2 55
|   d8 ac 93 8e  ff c6 d5 f3  cf d5 6a df  d6 8a 76 1b
|   38 cd 4a 7b  a1 40 c6 7a  77 d5 e9 f8  72 b4 3b 01
|   1e 72 db e2  be 02 3a 6b  ac 5e 82 ec  67 49 b2 ca
|   8a 61 b1 4c  1c 07 53 7b  df 95 58 1e  74 fb 92 32
|   29 29 4c 42  db 66 df 9d  17 f2 42 7b  6e da 0d ac
|   4f 2b aa 2f  3c 84 85 47  45 e7 53 7e  4c 1c db 33
|   f6 73 ae 97  1d 05 d7 3b  c4 77 09 b8  50 91 1f 78
|   63 3c f4 eb  db 70 f5 bd  6a fa c4 2f  31 ab 46 88
|   c8 a7 0d 99  bf 53 e2 d9  7e a3 c5 9c  61 b8 97 ad
|   94 2f 03 0a  13 6f 37 56  29 a5 23 82  8d f5 07 06
|   e2 fc 36 c3  78 d1 2d 3b  99 aa 10 95  aa 1b 5d 9d
|   51 8f 7c 9c  d6 97 e6 e7  b2 80 d9 67  11 76 48 4a
|   d0 9b 9f bc  70 0e b9 e6  b8 2e f5 4a
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   ce 12 dc 5e  6a b3 d6 fe
|    responder cookie:
|   bf 82 a3 57  1a d9 08 b8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  e0 b8 86 27
|    length: 332
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_QUICK (32), msgid: 3770189351
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  ce 12 dc 5e  6a b3 d6 fe
| RCOOKIE:  bf 82 a3 57  1a d9 08 b8
| state hash entry 29
| v1 peer and cookies match on #3, provided msgid e0b88627 vs 00000000
| v1 state object not found
| ICOOKIE:  ce 12 dc 5e  6a b3 d6 fe
| RCOOKIE:  bf 82 a3 57  1a d9 08 b8
| state hash entry 29
| v1 peer and cookies match on #3, provided msgid 00000000 vs 00000000
| v1 state object #3 found, in STATE_MAIN_R3
| processing connection mytunnel
| last Phase 1 IV:  1b a8 c5 6c  a1 5b 13 e3  14 b4 bb 71  18 32 62 3f
| current Phase 1 IV:  1b a8 c5 6c  a1 5b 13 e3  14 b4 bb 71  18 32 62 3f
| computed Phase 2 IV:
|   89 f9 1e c1  17 93 f8 86  ae a4 4a 9f  e8 c7 51 b1
|   c1 bf a0 dd
| received encrypted packet from 10.0.2.14:500
| decrypting 304 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   01 00 00 18  f4 90 52 b5  4b 50 c8 5c  8b 5a d7 ba
|   24 16 e7 40  39 38 da cc  0a 00 00 38  00 00 00 01
|   00 00 00 01  00 00 00 2c  00 03 04 01  a1 1f 7b 16
|   00 00 00 20  00 0c 00 00  80 03 00 05  80 04 00 01
|   80 01 00 01  80 02 70 80  80 05 00 02  80 06 00 80
|   04 00 00 14  58 0f c6 c3  d5 05 93 1c  2f 82 23 72
|   04 1b 7b 10  00 00 00 c4  cd fd 7a e6  66 e0 9a 81
|   76 43 71 09  e4 e8 1d 61  61 1b 29 c8  66 d4 6f c7
|   fd aa 8b bb  ba e3 57 86  fd 5e b4 3f  73 6d 94 2d
|   2f fb 57 97  44 8b 97 ec  5a 00 a4 7d  14 5d e6 df
|   1c b2 bd b9  d7 94 69 fc  ff 5f 35 45  2a 46 57 62
|   13 23 d1 43  61 fb 10 dd  e7 74 e8 dc  2e af de a3
|   5e 1c b7 91  db 3b 1a 9e  46 0f e3 4b  1f a7 30 d6
|   f0 60 2f 29  d1 dc 51 50  f0 13 10 c6  15 21 28 74
|   2a 5b 12 c4  c3 2a ae cb  52 75 1a 5d  79 86 21 dc
|   4e b3 1f 96  b3 19 ce fd  c7 a6 ac f7  8d 7d ff 4f
|   89 df 95 4b  47 62 d0 33  8b 98 57 a1  98 55 82 0c
|   f1 d3 d3 24  6a 55 b7 6d  5c 83 da 1c  5e 18 eb 05
|   7d 56 95 c7  a9 f5 1e a3  00 00 00 00  00 00 00 00
| next IV:  11 76 48 4a  d0 9b 9f bc  70 0e b9 e6  b8 2e f5 4a
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x502 opt: 0x200030
| ***parse ISAKMP Hash Payload:
|    length: 24
| got payload 0x2(ISAKMP_NEXT_SA) needed: 0x402 opt: 0x200030
| ***parse ISAKMP Security Association Payload:
|    length: 56
|    DOI: ISAKMP_DOI_IPSEC
| got payload 0x400(ISAKMP_NEXT_NONCE) needed: 0x400 opt: 0x200030
| ***parse ISAKMP Nonce Payload:
|    length: 20
| got payload 0x10(ISAKMP_NEXT_KE) needed: 0x0 opt: 0x200030
| ***parse ISAKMP Key Exchange Payload:
|    length: 196
| removing 8 bytes of padding
| HASH(1) computed:
|   f4 90 52 b5  4b 50 c8 5c  8b 5a d7 ba  24 16 e7 40
|   39 38 da cc
"mytunnel" #3: the peer proposed: 10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0
| find_client_connection starting with mytunnel
|   looking for 10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0
|   concrete checking against sr#0 10.0.2.15/32 -> 10.0.2.14/32
| client wildcard: no  port wildcard: no  virtual: no
| duplicating state object #3
| creating state object #4 at 0x5650f3382e30
| processing connection mytunnel
| ICOOKIE:  ce 12 dc 5e  6a b3 d6 fe
| RCOOKIE:  bf 82 a3 57  1a d9 08 b8
| state hash entry 29
| inserting state object #4 bucket: 29
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #4 (head of queue)
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 44
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| parsing 4 raw bytes of ISAKMP Proposal Payload into SPI
| SPI  a1 1f 7b 16
| *****parse ISAKMP Transform Payload (ESP):
|    length: 32
|    transform number: 0
|    transform ID: ESP_AES
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: ENCAPSULATION_MODE
|    length/value: 1
|    [1 is ENCAPSULATION_MODE_TUNNEL]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_TYPE
|    length/value: 1
|    [1 is SA_LIFE_TYPE_SECONDS]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_DURATION
|    length/value: 28800
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: AUTH_ALGORITHM
|    length/value: 2
|    [2 is AUTH_ALGORITHM_HMAC_SHA1]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: KEY_LENGTH
|    length/value: 128
| kernel_alg_esp_enc_ok(12,128): alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| DH public value received:
|   cd fd 7a e6  66 e0 9a 81  76 43 71 09  e4 e8 1d 61
|   61 1b 29 c8  66 d4 6f c7  fd aa 8b bb  ba e3 57 86
|   fd 5e b4 3f  73 6d 94 2d  2f fb 57 97  44 8b 97 ec
|   5a 00 a4 7d  14 5d e6 df  1c b2 bd b9  d7 94 69 fc
|   ff 5f 35 45  2a 46 57 62  13 23 d1 43  61 fb 10 dd
|   e7 74 e8 dc  2e af de a3  5e 1c b7 91  db 3b 1a 9e
|   46 0f e3 4b  1f a7 30 d6  f0 60 2f 29  d1 dc 51 50
|   f0 13 10 c6  15 21 28 74  2a 5b 12 c4  c3 2a ae cb
|   52 75 1a 5d  79 86 21 dc  4e b3 1f 96  b3 19 ce fd
|   c7 a6 ac f7  8d 7d ff 4f  89 df 95 4b  47 62 d0 33
|   8b 98 57 a1  98 55 82 0c  f1 d3 d3 24  6a 55 b7 6d
|   5c 83 da 1c  5e 18 eb 05  7d 56 95 c7  a9 f5 1e a3
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 7 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #4
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #4 
| event added after event EVENT_SHUNT_SCAN
| complete state transition with STF_SUSPEND
"mytunnel" #4: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing build_kenonce op id: 7
| next event EVENT_PENDING_DDNS in 28 seconds
| next event EVENT_PENDING_DDNS in 28 seconds
! Local DH secret:
!   e4 00 5d 30  36 7b 61 fc  53 9e 3a 5f  ac f9 92 f4
!   49 5e 02 44  5c 52 dc e5  9e 86 78 65  15 98 e8 0c
! Public DH value sent:
!   17 96 08 8e  e0 c5 25 65  2a 80 c1 16  29 eb 1f d8
!   96 b6 f3 39  99 d4 45 a8  db 3f 62 75  77 6c 1b 10
!   fc a5 54 6d  c3 3a 97 c2  55 eb 4f a0  d3 49 41 71
!   71 11 59 e2  03 36 92 e6  3c 56 9a c8  e1 ea de c1
!   5b e5 ac 20  0d 86 2f ed  5c ee ef 71  a3 73 c9 d1
!   d6 ab 8a 7a  5b 28 dd 22  6d 9b 88 f1  88 66 71 10
!   af 75 37 47  37 84 3f 3d  ee bf 0d 5e  a2 b2 b9 d1
!   5a 97 7e 59  42 ce d1 9a  d1 7d ed 75  92 b7 61 ad
!   6e b4 73 85  e0 be fd 21  51 80 0c d7  b2 e5 e3 45
!   cd 5a 4c 86  1f 2a 0d df  77 18 6f ff  68 61 81 e5
!   e2 ef 8d c8  bb 52 26 6e  87 a9 e7 b3  2c 8f e4 87
!   1d f8 e1 14  44 90 9d 41  c2 a3 5d ab  78 6d d2 f0
! Generated nonce:
!   e5 03 1d d6  67 82 a6 a6  16 ab 5b f5  ae 7c cf 2f
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#7
| calling callback function 0x5650f230ae60
| quick inI1_outR1: calculated ke+nonce, calculating DH
| processing connection mytunnel
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh(p2) op on seq: 8 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #4
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #4 
! helper 0 read 2752+4/2760 bytesfd: 8
| event added after event EVENT_SHUNT_SCAN
| * processed 1 messages from cryptographic helpers 
! helper 0 doing compute dh(p2) op id: 8
| next event EVENT_PENDING_DDNS in 28 seconds
| next event EVENT_PENDING_DDNS in 28 seconds
! peer's g:   cd fd 7a e6  66 e0 9a 81  76 43 71 09  e4 e8 1d 61
! peer's g:   61 1b 29 c8  66 d4 6f c7  fd aa 8b bb  ba e3 57 86
! peer's g:   fd 5e b4 3f  73 6d 94 2d  2f fb 57 97  44 8b 97 ec
! peer's g:   5a 00 a4 7d  14 5d e6 df  1c b2 bd b9  d7 94 69 fc
! peer's g:   ff 5f 35 45  2a 46 57 62  13 23 d1 43  61 fb 10 dd
! peer's g:   e7 74 e8 dc  2e af de a3  5e 1c b7 91  db 3b 1a 9e
! peer's g:   46 0f e3 4b  1f a7 30 d6  f0 60 2f 29  d1 dc 51 50
! peer's g:   f0 13 10 c6  15 21 28 74  2a 5b 12 c4  c3 2a ae cb
! peer's g:   52 75 1a 5d  79 86 21 dc  4e b3 1f 96  b3 19 ce fd
! peer's g:   c7 a6 ac f7  8d 7d ff 4f  89 df 95 4b  47 62 d0 33
! peer's g:   8b 98 57 a1  98 55 82 0c  f1 d3 d3 24  6a 55 b7 6d
! peer's g:   5c 83 da 1c  5e 18 eb 05  7d 56 95 c7  a9 f5 1e a3
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP1536): 506 usec
! DH shared-secret:
!   db 8d 2f f2  3e b3 16 75  56 9a 7b 88  33 8b d2 98
!   63 f3 9b 3d  bb c4 b9 e6  0d a4 a2 b2  8a 0c 6d 11
!   27 3d df f6  a2 da 2f fb  65 5e 89 bf  13 69 c1 af
!   4c e6 a0 8d  21 9e 2b ef  31 fe 52 0e  e4 16 7a 85
!   de 9b 7d 32  ea f2 56 c2  b2 dc 74 3f  3c 88 4e 8a
!   82 a1 4f 42  3f b7 26 a9  77 41 15 ed  55 04 e3 d3
!   1d c8 31 ef  14 16 c2 9a  a0 1d d5 8a  b0 6c 9b 50
!   8e 56 77 74  33 51 b6 64  90 13 ba 8a  de 0d 98 e0
!   a0 4f f1 96  9d 1e bd b5  cd 81 61 cf  5d 62 d1 7a
!   2c 72 e4 ee  9b f3 e6 bc  9e cc 98 67  43 34 1c f0
!   6b a5 77 0f  1d b8 e2 f9  f2 dd ab 18  d2 bc e7 ba
!   0b 39 f6 08  ae 8f 42 c8  8e e1 f6 9c  41 1e 7a 62
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#8
| calling callback function 0x5650f230b210
| quick inI1_outR1: calculated DH, sending R1
| processing connection mytunnel
| **emit ISAKMP Message:
|    initiator cookie:
|   ce 12 dc 5e  6a b3 d6 fe
|    responder cookie:
|   bf 82 a3 57  1a d9 08 b8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  e0 b8 86 27
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Security Association Payload:
|    DOI: ISAKMP_DOI_IPSEC
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 44
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| parsing 4 raw bytes of ISAKMP Proposal Payload into SPI
| SPI  a1 1f 7b 16
| *****parse ISAKMP Transform Payload (ESP):
|    length: 32
|    transform number: 0
|    transform ID: ESP_AES
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: ENCAPSULATION_MODE
|    length/value: 1
|    [1 is ENCAPSULATION_MODE_TUNNEL]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_TYPE
|    length/value: 1
|    [1 is SA_LIFE_TYPE_SECONDS]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_DURATION
|    length/value: 28800
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: AUTH_ALGORITHM
|    length/value: 2
|    [2 is AUTH_ALGORITHM_HMAC_SHA1]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: KEY_LENGTH
|    length/value: 128
| kernel_alg_esp_enc_ok(12,128): alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| ****emit IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****emit ISAKMP Proposal Payload:
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| netlink_get_spi: allocated 0x84f0c9b2 for esp.0@10.0.2.15
| emitting 4 raw bytes of SPI into ISAKMP Proposal Payload
| SPI  84 f0 c9 b2
| *****emit ISAKMP Transform Payload (ESP):
|    transform number: 0
|    transform ID: ESP_AES
| emitting 24 raw bytes of attributes into ISAKMP Transform Payload (ESP)
| attributes  80 03 00 05  80 04 00 01  80 01 00 01  80 02 70 80
| attributes  80 05 00 02  80 06 00 80
| emitting length of ISAKMP Transform Payload (ESP): 32
| emitting length of ISAKMP Proposal Payload: 44
| emitting length of ISAKMP Security Association Payload: 56
"mytunnel" #4: responding to Quick Mode proposal {msgid:2786b8e0}
"mytunnel" #4:     us: 10.0.2.15
"mytunnel" #4:   them: 10.0.2.14
| ***emit ISAKMP Nonce Payload:
| emitting 16 raw bytes of Nr into ISAKMP Nonce Payload
| Nr  e5 03 1d d6  67 82 a6 a6  16 ab 5b f5  ae 7c cf 2f
| emitting length of ISAKMP Nonce Payload: 20
| ***emit ISAKMP Key Exchange Payload:
| emitting 192 raw bytes of keyex value into ISAKMP Key Exchange Payload
| keyex value  17 96 08 8e  e0 c5 25 65  2a 80 c1 16  29 eb 1f d8
| keyex value  96 b6 f3 39  99 d4 45 a8  db 3f 62 75  77 6c 1b 10
| keyex value  fc a5 54 6d  c3 3a 97 c2  55 eb 4f a0  d3 49 41 71
| keyex value  71 11 59 e2  03 36 92 e6  3c 56 9a c8  e1 ea de c1
| keyex value  5b e5 ac 20  0d 86 2f ed  5c ee ef 71  a3 73 c9 d1
| keyex value  d6 ab 8a 7a  5b 28 dd 22  6d 9b 88 f1  88 66 71 10
| keyex value  af 75 37 47  37 84 3f 3d  ee bf 0d 5e  a2 b2 b9 d1
| keyex value  5a 97 7e 59  42 ce d1 9a  d1 7d ed 75  92 b7 61 ad
| keyex value  6e b4 73 85  e0 be fd 21  51 80 0c d7  b2 e5 e3 45
| keyex value  cd 5a 4c 86  1f 2a 0d df  77 18 6f ff  68 61 81 e5
| keyex value  e2 ef 8d c8  bb 52 26 6e  87 a9 e7 b3  2c 8f e4 87
| keyex value  1d f8 e1 14  44 90 9d 41  c2 a3 5d ab  78 6d d2 f0
| emitting length of ISAKMP Key Exchange Payload: 196
| HASH(2) computed:
|   d8 ca 6f 28  c5 e3 c2 99  82 27 9b eb  bc e7 af 88
|   c1 a1 e3 12
| compute_proto_keymat:needed_len (after ESP enc)=16
| compute_proto_keymat:needed_len (after ESP auth)=36
| ESP KEYMAT 
|   KEYMAT computed:
|   7f 19 66 9d  3e ef ce 9a  6d 71 70 2d  a4 38 fc 63
|   67 8d d3 96  dc 57 66 ff  0d 02 ab 6c  6d 6a 29 98
|   34 df 39 56
|   Peer KEYMAT computed:
|   ca f4 3a 43  22 c0 bf 0d  e5 b1 c2 fd  e2 db ec 2c
|   53 49 92 4b  88 b8 70 e2  80 b2 52 a2  aa 0a a0 3e
|   03 b2 e4 a7
| install_inbound_ipsec_sa() checking if we can route
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| could_route called for mytunnel (kind=CK_PERMANENT)
|    routing is easy, or has resolvable near-conflict
| checking if this is a replacement state
|   st=0x5650f3382e30 ost=(nil) st->serialno=#4 ost->serialno=#0 
| installing outgoing SA now as refhim=0
| state #4(mytunnel): setup outbound esp-ipsec between 10.0.2.15<->10.0.2.14 for 10.0.2.15/32...10.0.2.14/32
| ipcomp maybe
| esp outbound maybe
| looking for outbound alg with transid: 12 keylen: 128 auth: 2 for spi=167b1fa1 [10.0.2.15->10.0.2.14] 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| ESP enckey:  ca f4 3a 43  22 c0 bf 0d  e5 b1 c2 fd  e2 db ec 2c
| ESP authkey:  53 49 92 4b  88 b8 70 e2  80 b2 52 a2  aa 0a a0 3e
| ESP authkey:  03 b2 e4 a7
| creating SA spi=a11f7b16@0a00020e proto=50 family=2
| outgoing SA has refhim=4294901761
| state #4(mytunnel): setup inbound esp-ipsec between 10.0.2.14<->10.0.2.15 for 10.0.2.14/32...10.0.2.15/32
| ipcomp maybe
| esp inbound maybe
| looking for inbound alg with transid: 12 keylen: 128 auth: 2 for spi=b2c9f084 [10.0.2.14->10.0.2.15] 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| ESP enckey:  7f 19 66 9d  3e ef ce 9a  6d 71 70 2d  a4 38 fc 63
| ESP authkey:  67 8d d3 96  dc 57 66 ff  0d 02 ab 6c  6d 6a 29 98
| ESP authkey:  34 df 39 56
| updating SA spi=84f0c9b2@0a00020f proto=50 family=2
| creating SPD to 10.0.2.14->spi=00010000@10.0.2.15 proto=4
"mytunnel" #4: add inbound eroute 10.0.2.14/32:0 --0-> 10.0.2.15/32:0 => tun.10000@10.0.2.15 succeeded
| encrypting:
|   01 00 00 18  d8 ca 6f 28  c5 e3 c2 99  82 27 9b eb
|   bc e7 af 88  c1 a1 e3 12  0a 00 00 38  00 00 00 01
|   00 00 00 01  00 00 00 2c  00 03 04 01  84 f0 c9 b2
|   00 00 00 20  00 0c 00 00  80 03 00 05  80 04 00 01
|   80 01 00 01  80 02 70 80  80 05 00 02  80 06 00 80
|   04 00 00 14  e5 03 1d d6  67 82 a6 a6  16 ab 5b f5
|   ae 7c cf 2f  00 00 00 c4  17 96 08 8e  e0 c5 25 65
|   2a 80 c1 16  29 eb 1f d8  96 b6 f3 39  99 d4 45 a8
|   db 3f 62 75  77 6c 1b 10  fc a5 54 6d  c3 3a 97 c2
|   55 eb 4f a0  d3 49 41 71  71 11 59 e2  03 36 92 e6
|   3c 56 9a c8  e1 ea de c1  5b e5 ac 20  0d 86 2f ed
|   5c ee ef 71  a3 73 c9 d1  d6 ab 8a 7a  5b 28 dd 22
|   6d 9b 88 f1  88 66 71 10  af 75 37 47  37 84 3f 3d
|   ee bf 0d 5e  a2 b2 b9 d1  5a 97 7e 59  42 ce d1 9a
|   d1 7d ed 75  92 b7 61 ad  6e b4 73 85  e0 be fd 21
|   51 80 0c d7  b2 e5 e3 45  cd 5a 4c 86  1f 2a 0d df
|   77 18 6f ff  68 61 81 e5  e2 ef 8d c8  bb 52 26 6e
|   87 a9 e7 b3  2c 8f e4 87  1d f8 e1 14  44 90 9d 41
|   c2 a3 5d ab  78 6d d2 f0
| IV:
|   11 76 48 4a  d0 9b 9f bc  70 0e b9 e6  b8 2e f5 4a
| unpadded size is: 296
| emitting 8 zero bytes of encryption padding into ISAKMP Message
| encrypting 304 using OAKLEY_AES_CBC
| next IV:  35 6b fb 0a  39 55 82 e4  9b 4b e6 5b  16 f6 35 a2
| emitting length of ISAKMP Message: 332
| finished processing quick inI1
| complete state transition with STF_OK
"mytunnel" #4: transition from state STATE_QUICK_R0 to state STATE_QUICK_R1
| deleting event for #4
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 332 bytes for STATE_QUICK_R0 through enp0s3:500 to 10.0.2.14:500 (using #4)
|   ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57  1a d9 08 b8
|   08 10 20 01  e0 b8 86 27  00 00 01 4c  24 42 a0 0e
|   50 73 fb 09  9b 6a c9 b0  1a 1b 2c cc  85 9c 37 40
|   f6 51 e9 8e  e2 b5 33 1b  27 10 13 07  a4 01 9b 6f
|   1d dc 9f 58  c9 0a 06 05  50 08 13 fa  bb 4f 38 17
|   f6 1a 9c 5b  61 c9 f0 08  93 d7 76 97  91 9a 94 90
|   45 7c 4d f3  7b e0 05 8a  2d 4c 90 66  cc 12 0e ee
|   cf 25 73 26  f3 a8 05 4b  3a 70 16 58  b2 0b 1b bf
|   79 d8 a5 74  40 13 7e 87  5a 29 f6 a3  70 cc f0 f5
|   d9 1f 0d 67  d7 96 80 e5  02 7e 4b 0c  a3 61 73 84
|   9a 03 c0 9c  1c 52 1a d5  a1 3c 0a d4  4c 82 c9 86
|   8f 9f 60 bc  2b 40 40 78  04 8a 5a 03  a8 d9 c0 7a
|   00 2c 8b b3  40 80 2b 3f  a0 79 73 bc  b6 57 14 4e
|   d3 54 50 e1  39 f2 91 1f  87 e1 f3 90  25 76 28 48
|   00 de ec 4f  d6 ad a4 d2  e5 ca 64 68  1a 8e 98 7c
|   44 36 14 f7  e4 39 db a0  aa 9a 82 79  75 5e 15 38
|   5f d5 bc 35  2d 35 21 68  b6 42 46 82  e9 17 0f 0b
|   28 0f c1 d8  82 d0 2e f5  eb 79 0f 51  42 2a 6c 85
|   7e 2b 80 21  41 a6 16 cf  f9 2f 35 fa  f9 bb 68 e0
|   a1 15 c4 b9  19 db 7c 69  0e 04 b0 a8  35 6b fb 0a
|   39 55 82 e4  9b 4b e6 5b  16 f6 35 a2
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #4 (head of queue)
"mytunnel" #4: STATE_QUICK_R1: sent QR1, inbound IPsec SA installed, expecting QI2
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| * processed 1 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #4 (2020-01-27 11:22:44)
| next event EVENT_RETRANSMIT in 10 seconds for #4 (2020-01-27 11:22:44)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
<
| *received 60 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:45
|   ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57  1a d9 08 b8
|   08 10 20 01  e0 b8 86 27  00 00 00 3c  52 d8 a3 9c
|   76 4f 3f 69  bc b0 48 73  1c 44 a9 a7  fe aa b2 12
|   b7 51 90 5a  c4 c5 f0 60  41 03 e8 63
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   ce 12 dc 5e  6a b3 d6 fe
|    responder cookie:
|   bf 82 a3 57  1a d9 08 b8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  e0 b8 86 27
|    length: 60
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_QUICK (32), msgid: 3770189351
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  ce 12 dc 5e  6a b3 d6 fe
| RCOOKIE:  bf 82 a3 57  1a d9 08 b8
| state hash entry 29
| v1 peer and cookies match on #4, provided msgid e0b88627 vs e0b88627
| v1 state object #4 found, in STATE_QUICK_R1
| processing connection mytunnel
| received encrypted packet from 10.0.2.14:500
| decrypting 32 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   00 00 00 18  1f 78 af 36  b7 75 2d 5f  4b c6 03 18
|   11 68 7b fa  0b f5 74 16  00 00 00 00  00 00 00 00
| next IV:  fe aa b2 12  b7 51 90 5a  c4 c5 f0 60  41 03 e8 63
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x0
| ***parse ISAKMP Hash Payload:
|    length: 24
| removing 8 bytes of padding
| HASH(3) computed:  1f 78 af 36  b7 75 2d 5f  4b c6 03 18  11 68 7b fa
| HASH(3) computed:  0b f5 74 16
| state #4: install_ipsec_sa() for outbound only
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| could_route called for mytunnel (kind=CK_PERMANENT)
| state #4: now setting up incoming SA
| sr for #4: prospective erouted (eroute_owner: #0)
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| route_and_eroute with c: mytunnel (next: none) ero:mytunnel esr:{(nil)} ro:mytunnel rosr:{(nil)} and state: 4
| eroute_connection: between 10.0.2.15<->10.0.2.14
| creating SPD to 10.0.2.15->spi=00000000@10.0.2.14 proto=4
"mytunnel" #4: eroute_connection replace eroute 10.0.2.15/32:0 --0-> 10.0.2.14/32:0 => tun.0@10.0.2.14 succeeded
| command executing up-host
| executing up-host: 2>&1 PLUTO_VERB='up-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| route_and_eroute: firewall_notified: true
| route_and_eroute: instance "mytunnel", setting eroute_owner to #4 (was #0) (newest_ipsec_sa=#0)
| inI2: instance mytunnel[0], setting newest_ipsec_sa to #4 (was #0) (spd.eroute=#4)
| complete state transition with STF_OK
"mytunnel" #4: transition from state STATE_QUICK_R1 to state STATE_QUICK_R2
| deleting event for #4
| inserting event EVENT_SA_REPLACE, timeout in 28530 seconds for #4 
| event added after event EVENT_REINIT_SECRET
"mytunnel" #4: STATE_QUICK_R2: IPsec SA established tunnel mode {ESP=>0xa11f7b16 <0x84f0c9b2 xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
"mytunnel" #4: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 27 seconds
| next event EVENT_PENDING_DDNS in 27 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L
| *received 76 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:50
|   ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57  1a d9 08 b8
|   08 10 05 01  59 37 ce 5e  00 00 00 4c  ae 9f 34 12
|   7e 41 2d c7  df 52 81 66  65 47 27 f9  67 73 7a 9c
|   7b 3d 4a d2  16 76 0a 17  03 2b 0c 65  7f d7 bf e4
|   8d d6 e4 7e  43 8b d4 5b  74 88 9d fe
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   ce 12 dc 5e  6a b3 d6 fe
|    responder cookie:
|   bf 82 a3 57  1a d9 08 b8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  59 37 ce 5e
|    length: 76
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_INFO (5), msgid: 1496829534
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  ce 12 dc 5e  6a b3 d6 fe
| RCOOKIE:  bf 82 a3 57  1a d9 08 b8
| state hash entry 29
| peer and cookies match on #4, provided msgid 00000000 vs e0b88627/00000000
| peer and cookies match on #3, provided msgid 00000000 vs 00000000/00000000
| p15 state object #3 found, in STATE_MAIN_R3
| processing connection mytunnel
| last Phase 1 IV:  1b a8 c5 6c  a1 5b 13 e3  14 b4 bb 71  18 32 62 3f
| current Phase 1 IV:  1b a8 c5 6c  a1 5b 13 e3  14 b4 bb 71  18 32 62 3f
| computed Phase 2 IV:
|   f3 2c ea 01  81 09 3f 43  c4 28 6f 79  b3 a2 f3 13
|   36 be 4d 34
| received encrypted packet from 10.0.2.14:500
| decrypting 48 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   0c 00 00 18  3a 7e 26 f2  c7 28 b2 51  53 45 5d 4f
|   ef 12 09 3e  b9 cb ac 29  00 00 00 10  00 00 00 01
|   03 04 00 01  a1 1f 7b 16  00 00 00 00  00 00 00 00
| next IV:  7f d7 bf e4  8d d6 e4 7e  43 8b d4 5b  74 88 9d fe
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x0
| ***parse ISAKMP Hash Payload:
|    length: 24
| got payload 0x1000(ISAKMP_NEXT_D) needed: 0x0 opt: 0x0
| ***parse ISAKMP Delete Payload:
|    length: 16
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 3
|    SPI size: 4
|    number of SPIs: 1
| removing 8 bytes of padding
| HASH(1) computed:
|   3a 7e 26 f2  c7 28 b2 51  53 45 5d 4f  ef 12 09 3e
|   b9 cb ac 29
| received 'informational' message HASH(1) data ok
| processing connection mytunnel
"mytunnel" #3: received Delete SA(0xa11f7b16) payload: deleting IPSEC State #4
"mytunnel" #3: deleting state #4 (STATE_QUICK_R2)
| find_phase1_state: found SA #3 for conn 'mytunnel' in state STATE_MAIN_R3
| **emit ISAKMP Message:
|    initiator cookie:
|   ce 12 dc 5e  6a b3 d6 fe
|    responder cookie:
|   bf 82 a3 57  1a d9 08 b8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  ae 23 34 a5
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH(1) into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Delete Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 3
|    SPI size: 4
|    number of SPIs: 1
| emitting 4 raw bytes of delete payload into ISAKMP Delete Payload
| delete payload  84 f0 c9 b2
| emitting length of ISAKMP Delete Payload: 16
| HASH(1) computed:
|   60 6c 37 79  89 41 f2 dd  e6 7e 3e 3b  c8 9b 23 8c
|   e8 ed a2 f1
| last Phase 1 IV:  1b a8 c5 6c  a1 5b 13 e3  14 b4 bb 71  18 32 62 3f
| current Phase 1 IV:  1b a8 c5 6c  a1 5b 13 e3  14 b4 bb 71  18 32 62 3f
| computed Phase 2 IV:
|   e3 c2 8d 2f  2f 3b 4d 65  4a e9 b4 1e  58 7a 7c 9f
|   96 b4 de 93
| encrypting:
|   0c 00 00 18  60 6c 37 79  89 41 f2 dd  e6 7e 3e 3b
|   c8 9b 23 8c  e8 ed a2 f1  00 00 00 10  00 00 00 01
|   03 04 00 01  84 f0 c9 b2
| IV:
|   e3 c2 8d 2f  2f 3b 4d 65  4a e9 b4 1e  58 7a 7c 9f
|   96 b4 de 93
| unpadded size is: 40
| emitting 8 zero bytes of encryption padding into ISAKMP Message
| encrypting 48 using OAKLEY_AES_CBC
| next IV:  82 25 c7 5b  8d 05 85 ff  41 0d bd 2f  ea 2f b6 e6
| emitting length of ISAKMP Message: 76
| sending 76 bytes for delete notify through enp0s3:500 to 10.0.2.14:500 (using #3)
|   ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57  1a d9 08 b8
|   08 10 05 01  ae 23 34 a5  00 00 00 4c  d5 1a c7 32
|   a3 2f bf 64  98 e0 c5 51  d1 36 fd b8  88 34 b9 11
|   42 59 17 9c  6c 28 61 02  61 4c d7 f9  82 25 c7 5b
|   8d 05 85 ff  41 0d bd 2f  ea 2f b6 e6
| deleting event for #4
| no suspended cryptographic state for 4 
| removing state object #4
| ICOOKIE:  ce 12 dc 5e  6a b3 d6 fe
| RCOOKIE:  bf 82 a3 57  1a d9 08 b8
| state hash entry 29
| command executing down-host
| executing down-host: 2>&1 PLUTO_VERB='down-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| request to replace with shunt a prospective erouted policy with netkey kernel --- experimental
| creating SPD to 10.0.2.15->spi=00000104@0.0.0.0 proto=61
| delete esp.a11f7b16@10.0.2.14
| creating SPD to 10.0.2.14->spi=00010000@10.0.2.15 proto=255
"mytunnel" #3: delete (half) inbound eroute 10.0.2.14/32:0 --0-> 10.0.2.15/32:0 => unk255.10000@10.0.2.15 succeeded
| delete esp.84f0c9b2@10.0.2.15
| del:  a1 1f 7b 16
"mytunnel" #3: received and ignored informational message
| complete state transition with STF_IGNORE
"mytunnel" #3: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 22 seconds
| next event EVENT_PENDING_DDNS in 22 seconds
| deleting event for #4
| freeing state object #4
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\234
| *received 156 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:53
|   54 c7 88 f2  d1 90 5f 9e  00 00 00 00  00 00 00 00
|   01 10 02 00  00 00 00 00  00 00 00 9c  0d 00 00 5c
|   00 00 00 01  00 00 00 01  00 00 00 50  00 01 00 02
|   03 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  00 00 00 24  01 01 00 00  80 0b 00 01
|   80 0c 0e 10  80 01 00 07  80 02 00 02  80 03 00 01
|   80 04 00 02  80 0e 00 80  0d 00 00 10  4f 53 57 7e
|   7c 74 59 69  57 59 73 57  00 00 00 14  af ca d7 13
|   68 a1 f1 c9  6b 86 96 fc  77 57 01 00
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   54 c7 88 f2  d1 90 5f 9e
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 156
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| got payload 0x2(ISAKMP_NEXT_SA) needed: 0x2 opt: 0x2080
| ***parse ISAKMP Security Association Payload:
|    length: 92
|    DOI: ISAKMP_DOI_IPSEC
| got payload 0x2000(ISAKMP_NEXT_VID) needed: 0x0 opt: 0x2080
| ***parse ISAKMP Vendor ID Payload:
|    length: 16
| got payload 0x2000(ISAKMP_NEXT_VID) needed: 0x0 opt: 0x2080
| ***parse ISAKMP Vendor ID Payload:
|    length: 20
packet from 10.0.2.14:500: ignoring unknown Vendor ID payload [4f53577e7c74596957597357]
packet from 10.0.2.14:500: received Vendor ID payload [Dead Peer Detection]
| find_host_connection2 called from main_inI1_outR1, me=10.0.2.15:500 him=10.0.2.14:500 policy=/!IKEv1
| find_host_pair: looking for me=10.0.2.15:500 %address him=10.0.2.14:500 any-match 
| find_host_pair: comparing to me=10.0.2.15:500 %address him=10.0.2.14:500 
| find_host_pair: concluded with mytunnel
| found_host_pair_conn (find_host_connection2): 10.0.2.15:500 %address/10.0.2.14:500 -> hp:mytunnel 
| searching for connection with policy = /!IKEv1
| found policy = PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK (mytunnel)
| find_host_connection2 returns mytunnel (ike=none/none)
| creating state object #5 at 0x5650f3382e30
| processing connection mytunnel
| ICOOKIE:  54 c7 88 f2  d1 90 5f 9e
| RCOOKIE:  ec 02 3f 64  da 0e e2 f8
| state hash entry 8
| inserting state object #5 bucket: 8
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #5 (head of queue)
"mytunnel" #5: responding to Main Mode
| **emit ISAKMP Message:
|    initiator cookie:
|   54 c7 88 f2  d1 90 5f 9e
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Security Association Payload:
|    DOI: ISAKMP_DOI_IPSEC
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 80
|    proposal number: 0
|    protocol ID: PROTO_ISAKMP
|    SPI size: 0
|    number of transforms: 2
| *****parse ISAKMP Transform Payload (ISAKMP):
|    length: 36
|    transform number: 0
|    transform ID: KEY_IKE
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_LIFE_TYPE
|    length/value: 1
|    [1 is OAKLEY_LIFE_SECONDS]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_LIFE_DURATION
|    length/value: 3600
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_ENCRYPTION_ALGORITHM
|    length/value: 7
|    [7 is OAKLEY_AES_CBC]
| ike_alg_enc_ok(ealg=7,key_len=0): blocksize=16, keyminlen=128, keydeflen=128, keymaxlen=256, ret=1
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_HASH_ALGORITHM
|    length/value: 2
|    [2 is OAKLEY_SHA1]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_AUTHENTICATION_METHOD
|    length/value: 1
|    [1 is OAKLEY_PRESHARED_KEY]
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_KEY_LENGTH
|    length/value: 128
| ike_alg_enc_ok(ealg=7,key_len=128): blocksize=16, keyminlen=128, keydeflen=128, keymaxlen=256, ret=1
| Oakley Transform 0 accepted
| ****emit IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****emit ISAKMP Proposal Payload:
|    proposal number: 0
|    protocol ID: PROTO_ISAKMP
|    SPI size: 0
|    number of transforms: 1
| *****emit ISAKMP Transform Payload (ISAKMP):
|    transform number: 0
|    transform ID: KEY_IKE
| emitting 28 raw bytes of attributes into ISAKMP Transform Payload (ISAKMP)
| attributes  80 0b 00 01  80 0c 0e 10  80 01 00 07  80 02 00 02
| attributes  80 03 00 01  80 04 00 05  80 0e 00 80
| emitting length of ISAKMP Transform Payload (ISAKMP): 36
| emitting length of ISAKMP Proposal Payload: 44
| emitting length of ISAKMP Security Association Payload: 56
| ***emit ISAKMP Vendor ID Payload:
| emitting 12 raw bytes of Vendor ID into ISAKMP Vendor ID Payload
| Vendor ID  4f 53 57 5e  41 76 56 4b  68 7b 55 50
| emitting length of ISAKMP Vendor ID Payload: 16
| out_vendorid(): sending [Dead Peer Detection]
| ***emit ISAKMP Vendor ID Payload:
| emitting 16 raw bytes of V_ID into ISAKMP Vendor ID Payload
| V_ID  af ca d7 13  68 a1 f1 c9  6b 86 96 fc  77 57 01 00
| emitting length of ISAKMP Vendor ID Payload: 20
| sender checking NAT-T: 0 and 0
| emitting length of ISAKMP Message: 120
| peer supports dpd
| complete state transition with STF_OK
"mytunnel" #5: transition from state STATE_MAIN_R0 to state STATE_MAIN_R1
| deleting event for #5
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 120 bytes for STATE_MAIN_R0 through enp0s3:500 to 10.0.2.14:500 (using #5)
|   54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
|   01 10 02 00  00 00 00 00  00 00 00 78  0d 00 00 38
|   00 00 00 01  00 00 00 01  00 00 00 2c  00 01 00 01
|   00 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  0d 00 00 10  4f 53 57 5e  41 76 56 4b
|   68 7b 55 50  00 00 00 14  af ca d7 13  68 a1 f1 c9
|   6b 86 96 fc  77 57 01 00
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #5 (head of queue)
"mytunnel" #5: STATE_MAIN_R1: sent MR1, expecting MI2
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
"mytunnel" #5: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #5 (2020-01-27 11:22:53)
| next event EVENT_RETRANSMIT in 10 seconds for #5 (2020-01-27 11:22:53)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\364
| *received 244 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:22:55
|   00 00 00 00  00 00 00 00  ec 02 3f 64  da 0e e2 f8
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
|   cf 87 41 47  b2 97 2e c8  47 3e 53 37  60 2b 6e 55
|   1a 76 3c 60  04 f9 95 4d  cd 7a ff 25  3e 38 58 65
|   8d 65 40 91  16 d1 ef a9  3a 7a 80 77  9c cc 01 b0
|   9b 2e 72 a6  c7 09 f8 30  2d 6e 33 fa  85 06 fa 51
|   5f d2 da 55  63 3a c1 ad  ce 4b af a4  1c f2 19 5d
|   2f bd c2 47  04 f9 e2 8f  ec ca 74 5e  f0 a2 d0 84
|   8e 70 85 7a  67 77 2a 8c  9f 3a 9d e5  4e f7 29 8b
|   62 6c f7 0a  04 19 7e 7e  b9 c4 89 39  13 28 4b 1f
|   9a 96 fc 85  d6 c2 72 05  4a 4a ee 7a  03 ff d7 91
|   69 b9 b6 41  ad f2 9a 2c  97 ec d6 ec  70 ce ab 71
|   21 0e e7 fc  53 ab db ea  a8 da fa 99  79 80 4c 3c
|   ac b2 01 3c  c7 cc 40 fb  dd 0d d1 73  03 16 d1 76
|   00 00 00 14  9a 22 e5 c3  c9 60 76 29  00 9f cd e9
|   3c f4 9b 92
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 244
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
packet from 10.0.2.14:500: Initiator Cookie must not be zero in phase 1 message
packet from 10.0.2.14:500: [PIET] I detected a ZERO initiator cookie... (ikev1.c)
packet from 10.0.2.14:500: sending notification INVALID_COOKIE to 10.0.2.14:500
| **emit ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Notification Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 0
|    Notify Message Type: INVALID_COOKIE
| emitting length of ISAKMP Notification Payload: 12
| emitting length of ISAKMP Message: 40
| sending 40 bytes for notification packet through enp0s3:500 to 10.0.2.14:500 (using #0)
|   00 00 00 00  00 00 00 00  ec 02 3f 64  da 0e e2 f8
|   0b 10 05 00  00 00 00 00  00 00 00 28  00 00 00 0c
|   00 00 00 01  01 00 00 04
packet from 10.0.2.14:500: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 8 seconds for #5 (2020-01-27 11:22:55)
| next event EVENT_RETRANSMIT in 8 seconds for #5 (2020-01-27 11:22:55)
|  
| next event EVENT_RETRANSMIT in 0 seconds for #5 (2020-01-27 11:23:03)
| *time to handle event
| at 2020-01-27 11:23:03 handling event EVENT_RETRANSMIT
| event after this is EVENT_PENDING_DDNS in 9 seconds
| processing connection mytunnel
| handling event EVENT_RETRANSMIT for 10.0.2.14 "mytunnel" #5
| sending 120 bytes for EVENT_RETRANSMIT through enp0s3:500 to 10.0.2.14:500 (using #5)
|   54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
|   01 10 02 00  00 00 00 00  00 00 00 78  0d 00 00 38
|   00 00 00 01  00 00 00 01  00 00 00 2c  00 01 00 01
|   00 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  0d 00 00 10  4f 53 57 5e  41 76 56 4b
|   68 7b 55 50  00 00 00 14  af ca d7 13  68 a1 f1 c9
|   6b 86 96 fc  77 57 01 00
| inserting event EVENT_RETRANSMIT, timeout in 20 seconds for #5 
| event added after event EVENT_SHUNT_SCAN
| next event EVENT_PENDING_DDNS in 9 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\364
| *received 244 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:04
|   54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
|   cf 87 41 47  b2 97 2e c8  47 3e 53 37  60 2b 6e 55
|   1a 76 3c 60  04 f9 95 4d  cd 7a ff 25  3e 38 58 65
|   8d 65 40 91  16 d1 ef a9  3a 7a 80 77  9c cc 01 b0
|   9b 2e 72 a6  c7 09 f8 30  2d 6e 33 fa  85 06 fa 51
|   5f d2 da 55  63 3a c1 ad  ce 4b af a4  1c f2 19 5d
|   2f bd c2 47  04 f9 e2 8f  ec ca 74 5e  f0 a2 d0 84
|   8e 70 85 7a  67 77 2a 8c  9f 3a 9d e5  4e f7 29 8b
|   62 6c f7 0a  04 19 7e 7e  b9 c4 89 39  13 28 4b 1f
|   9a 96 fc 85  d6 c2 72 05  4a 4a ee 7a  03 ff d7 91
|   69 b9 b6 41  ad f2 9a 2c  97 ec d6 ec  70 ce ab 71
|   21 0e e7 fc  53 ab db ea  a8 da fa 99  79 80 4c 3c
|   ac b2 01 3c  c7 cc 40 fb  dd 0d d1 73  03 16 d1 76
|   00 00 00 14  9a 22 e5 c3  c9 60 76 29  00 9f cd e9
|   3c f4 9b 92
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   54 c7 88 f2  d1 90 5f 9e
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 244
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  54 c7 88 f2  d1 90 5f 9e
| RCOOKIE:  ec 02 3f 64  da 0e e2 f8
| state hash entry 8
| v1 peer and cookies match on #5, provided msgid 00000000 vs 00000000
| v1 state object #5 found, in STATE_MAIN_R1
| processing connection mytunnel
| got payload 0x10(ISAKMP_NEXT_KE) needed: 0x410 opt: 0x102080
| ***parse ISAKMP Key Exchange Payload:
|    length: 196
| got payload 0x400(ISAKMP_NEXT_NONCE) needed: 0x400 opt: 0x102080
| ***parse ISAKMP Nonce Payload:
|    length: 20
| DH public value received:
|   cf 87 41 47  b2 97 2e c8  47 3e 53 37  60 2b 6e 55
|   1a 76 3c 60  04 f9 95 4d  cd 7a ff 25  3e 38 58 65
|   8d 65 40 91  16 d1 ef a9  3a 7a 80 77  9c cc 01 b0
|   9b 2e 72 a6  c7 09 f8 30  2d 6e 33 fa  85 06 fa 51
|   5f d2 da 55  63 3a c1 ad  ce 4b af a4  1c f2 19 5d
|   2f bd c2 47  04 f9 e2 8f  ec ca 74 5e  f0 a2 d0 84
|   8e 70 85 7a  67 77 2a 8c  9f 3a 9d e5  4e f7 29 8b
|   62 6c f7 0a  04 19 7e 7e  b9 c4 89 39  13 28 4b 1f
|   9a 96 fc 85  d6 c2 72 05  4a 4a ee 7a  03 ff d7 91
|   69 b9 b6 41  ad f2 9a 2c  97 ec d6 ec  70 ce ab 71
|   21 0e e7 fc  53 ab db ea  a8 da fa 99  79 80 4c 3c
|   ac b2 01 3c  c7 cc 40 fb  dd 0d d1 73  03 16 d1 76
| inI2: checking NAT-T: 0 and 0
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 9 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #5
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing build_kenonce op id: 9
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #5 
| event added after event EVENT_SHUNT_SCAN
! Local DH secret:
| complete state transition with STF_SUSPEND
"mytunnel" #5: [PIET]   read_packet returned false...(demux.c)
!   bb 8d dc fc  e2 31 17 fb  db 22 75 11  cc 7b 2f 69
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
!   d3 83 0a 56  df 08 01 61  9c 87 84 0b  04 59 a1 45
| next event EVENT_PENDING_DDNS in 8 seconds
| next event EVENT_PENDING_DDNS in 8 seconds
! Public DH value sent:
!   67 56 98 0f  30 38 f8 c5  b2 63 cc 99  61 94 3e 89
!   43 e5 98 76  fe 5e 30 a4  14 ec 46 10  70 08 ec 40
!   3c c3 96 70  e8 76 8b 40  74 eb 67 f5  3e dd ab 5c
!   de fe 5b b3  4a e7 04 73  47 19 f8 f5  f6 d5 f1 f4
!   48 1a 1d ea  48 f6 d4 d5  85 8c 14 c5  74 b3 52 9b
!   79 c3 43 40  ed 83 69 36  42 86 df 13  33 3b 5e d1
!   04 f1 48 a5  58 1c 22 1a  6e 24 2d 73  98 c1 7c 4e
!   f1 22 6e 93  e4 4e 4b d4  d0 37 b9 7b  4b 69 78 48
!   07 38 eb aa  74 97 eb 2c  48 78 15 d1  45 5b 0d 9c
!   ec 08 e8 86  11 d4 f9 b3  2f 71 4e 01  57 9c 46 03
!   ed 72 62 1e  61 e0 f4 eb  2c 57 c1 ab  0f 5e 8d 48
!   28 6c 8d ab  ed e0 68 76  9e 37 40 1a  e4 35 90 dc
! Generated nonce:
!   3f 4b ee 7b  f1 80 77 e6  06 6e c9 f7  97 c5 ac c7
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#9
| calling callback function 0x5650f2303aa0
| main inI2_outR2: calculated ke+nonce, sending R2
| processing connection mytunnel
| **emit ISAKMP Message:
|    initiator cookie:
|   54 c7 88 f2  d1 90 5f 9e
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Key Exchange Payload:
| emitting 192 raw bytes of keyex value into ISAKMP Key Exchange Payload
| keyex value  67 56 98 0f  30 38 f8 c5  b2 63 cc 99  61 94 3e 89
| keyex value  43 e5 98 76  fe 5e 30 a4  14 ec 46 10  70 08 ec 40
| keyex value  3c c3 96 70  e8 76 8b 40  74 eb 67 f5  3e dd ab 5c
| keyex value  de fe 5b b3  4a e7 04 73  47 19 f8 f5  f6 d5 f1 f4
| keyex value  48 1a 1d ea  48 f6 d4 d5  85 8c 14 c5  74 b3 52 9b
| keyex value  79 c3 43 40  ed 83 69 36  42 86 df 13  33 3b 5e d1
| keyex value  04 f1 48 a5  58 1c 22 1a  6e 24 2d 73  98 c1 7c 4e
| keyex value  f1 22 6e 93  e4 4e 4b d4  d0 37 b9 7b  4b 69 78 48
| keyex value  07 38 eb aa  74 97 eb 2c  48 78 15 d1  45 5b 0d 9c
| keyex value  ec 08 e8 86  11 d4 f9 b3  2f 71 4e 01  57 9c 46 03
| keyex value  ed 72 62 1e  61 e0 f4 eb  2c 57 c1 ab  0f 5e 8d 48
| keyex value  28 6c 8d ab  ed e0 68 76  9e 37 40 1a  e4 35 90 dc
| emitting length of ISAKMP Key Exchange Payload: 196
| ***emit ISAKMP Nonce Payload:
| emitting 16 raw bytes of Nr into ISAKMP Nonce Payload
| Nr  3f 4b ee 7b  f1 80 77 e6  06 6e c9 f7  97 c5 ac c7
| emitting length of ISAKMP Nonce Payload: 20
| emitting length of ISAKMP Message: 244
| main inI2_outR2: starting async DH calculation (group=5)
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| parent1 type: 7 group: 5 len: 2760 
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh+iv op on seq: 10 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #5
! helper 0 read 2752+4/2760 bytesfd: 8
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #5 
| event added after event EVENT_SHUNT_SCAN
! helper 0 doing compute dh+iv op id: 10
| started dh_secretiv, returned: stf=STF_SUSPEND 
| complete state transition with STF_OK
! peer's g:   cf 87 41 47  b2 97 2e c8  47 3e 53 37  60 2b 6e 55
"mytunnel" #5: transition from state STATE_MAIN_R1 to state STATE_MAIN_R2
| deleting event for #5
! peer's g:   1a 76 3c 60  04 f9 95 4d  cd 7a ff 25  3e 38 58 65
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 244 bytes for STATE_MAIN_R1 through enp0s3:500 to 10.0.2.14:500 (using #5)
! peer's g:   8d 65 40 91  16 d1 ef a9  3a 7a 80 77  9c cc 01 b0
|   54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
! peer's g:   9b 2e 72 a6  c7 09 f8 30  2d 6e 33 fa  85 06 fa 51
|   67 56 98 0f  30 38 f8 c5  b2 63 cc 99  61 94 3e 89
|   43 e5 98 76  fe 5e 30 a4  14 ec 46 10  70 08 ec 40
! peer's g:   5f d2 da 55  63 3a c1 ad  ce 4b af a4  1c f2 19 5d
|   3c c3 96 70  e8 76 8b 40  74 eb 67 f5  3e dd ab 5c
|   de fe 5b b3  4a e7 04 73  47 19 f8 f5  f6 d5 f1 f4
|   48 1a 1d ea  48 f6 d4 d5  85 8c 14 c5  74 b3 52 9b
! peer's g:   2f bd c2 47  04 f9 e2 8f  ec ca 74 5e  f0 a2 d0 84
|   79 c3 43 40  ed 83 69 36  42 86 df 13  33 3b 5e d1
|   04 f1 48 a5  58 1c 22 1a  6e 24 2d 73  98 c1 7c 4e
|   f1 22 6e 93  e4 4e 4b d4  d0 37 b9 7b  4b 69 78 48
! peer's g:   8e 70 85 7a  67 77 2a 8c  9f 3a 9d e5  4e f7 29 8b
|   07 38 eb aa  74 97 eb 2c  48 78 15 d1  45 5b 0d 9c
|   ec 08 e8 86  11 d4 f9 b3  2f 71 4e 01  57 9c 46 03
|   ed 72 62 1e  61 e0 f4 eb  2c 57 c1 ab  0f 5e 8d 48
|   28 6c 8d ab  ed e0 68 76  9e 37 40 1a  e4 35 90 dc
! peer's g:   62 6c f7 0a  04 19 7e 7e  b9 c4 89 39  13 28 4b 1f
|   00 00 00 14  3f 4b ee 7b  f1 80 77 e6  06 6e c9 f7
|   97 c5 ac c7
! peer's g:   9a 96 fc 85  d6 c2 72 05  4a 4a ee 7a  03 ff d7 91
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #5 
| event added after event EVENT_SHUNT_SCAN
! peer's g:   69 b9 b6 41  ad f2 9a 2c  97 ec d6 ec  70 ce ab 71
"mytunnel" #5: STATE_MAIN_R2: sent MR2, expecting MI3
| modecfg pull: noquirk policy:push not-client
! peer's g:   21 0e e7 fc  53 ab db ea  a8 da fa 99  79 80 4c 3c
| phase 1 is done, looking for phase 2 to unpend
| * processed 1 messages from cryptographic helpers 
! peer's g:   ac b2 01 3c  c7 cc 40 fb  dd 0d d1 73  03 16 d1 76
| next event EVENT_PENDING_DDNS in 8 seconds
| next event EVENT_PENDING_DDNS in 8 seconds
! long term secret:   bb 8d dc fc  e2 31 17 fb  db 22 75 11  cc 7b 2f 69
! long term secret:   d3 83 0a 56  df 08 01 61  9c 87 84 0b  04 59 a1 45
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP1536): 530 usec
! DH shared-secret:
!   9a 51 4b 34  2c b3 10 59  ba 77 66 ce  4c 46 74 c4
!   62 1b cb e7  66 03 72 37  d8 22 8b a0  1a d6 51 88
!   52 90 1a 00  ca 81 fe 4f  9c 8a 80 80  9b a7 d3 78
!   ef 9c ef 01  19 2d 77 d1  4a 71 30 22  af 9d 12 38
!   6b 5f 56 2b  4d af 12 4e  6a ea ab 43  39 70 38 bd
!   bd f0 9d 0b  e8 6c 8d 88  e7 8d ad da  df 28 78 e7
!   d3 eb 3d 47  0f 92 ba a5  61 e0 3e 7f  42 37 91 99
!   84 8d bf 7c  db 9a fb 4c  65 87 74 fb  8f 73 2d f6
!   df 82 10 89  51 b7 61 cd  c3 fd 5c 31  8d ff 4f cd
!   01 b8 34 80  af fb 96 4a  fa b6 31 1f  bb 02 e3 0e
!   cd 68 9b 56  ee 82 3e 32  40 95 e6 1a  51 6f bd 7b
!   0d cc d0 fa  c9 2b 7c 2c  29 a5 e3 80  cc 05 79 71
! Skey inputs (PSK+NI+NR)
! ni:   9a 22 e5 c3  c9 60 76 29  00 9f cd e9  3c f4 9b 92
! nr:   3f 4b ee 7b  f1 80 77 e6  06 6e c9 f7  97 c5 ac c7
! keyid:   11 17 85 68  65 70 67 ba  df e8 c4 39  a9 67 5e 5b
! keyid:   e1 08 cb b5
! NSS: end of key computation 
! DH_i:  cf 87 41 47  b2 97 2e c8  47 3e 53 37  60 2b 6e 55
! DH_i:  1a 76 3c 60  04 f9 95 4d  cd 7a ff 25  3e 38 58 65
! DH_i:  8d 65 40 91  16 d1 ef a9  3a 7a 80 77  9c cc 01 b0
! DH_i:  9b 2e 72 a6  c7 09 f8 30  2d 6e 33 fa  85 06 fa 51
! DH_i:  5f d2 da 55  63 3a c1 ad  ce 4b af a4  1c f2 19 5d
! DH_i:  2f bd c2 47  04 f9 e2 8f  ec ca 74 5e  f0 a2 d0 84
! DH_i:  8e 70 85 7a  67 77 2a 8c  9f 3a 9d e5  4e f7 29 8b
! DH_i:  62 6c f7 0a  04 19 7e 7e  b9 c4 89 39  13 28 4b 1f
! DH_i:  9a 96 fc 85  d6 c2 72 05  4a 4a ee 7a  03 ff d7 91
! DH_i:  69 b9 b6 41  ad f2 9a 2c  97 ec d6 ec  70 ce ab 71
! DH_i:  21 0e e7 fc  53 ab db ea  a8 da fa 99  79 80 4c 3c
! DH_i:  ac b2 01 3c  c7 cc 40 fb  dd 0d d1 73  03 16 d1 76
! DH_r:  67 56 98 0f  30 38 f8 c5  b2 63 cc 99  61 94 3e 89
! DH_r:  43 e5 98 76  fe 5e 30 a4  14 ec 46 10  70 08 ec 40
! DH_r:  3c c3 96 70  e8 76 8b 40  74 eb 67 f5  3e dd ab 5c
! DH_r:  de fe 5b b3  4a e7 04 73  47 19 f8 f5  f6 d5 f1 f4
! DH_r:  48 1a 1d ea  48 f6 d4 d5  85 8c 14 c5  74 b3 52 9b
! DH_r:  79 c3 43 40  ed 83 69 36  42 86 df 13  33 3b 5e d1
! DH_r:  04 f1 48 a5  58 1c 22 1a  6e 24 2d 73  98 c1 7c 4e
! DH_r:  f1 22 6e 93  e4 4e 4b d4  d0 37 b9 7b  4b 69 78 48
! DH_r:  07 38 eb aa  74 97 eb 2c  48 78 15 d1  45 5b 0d 9c
! DH_r:  ec 08 e8 86  11 d4 f9 b3  2f 71 4e 01  57 9c 46 03
! DH_r:  ed 72 62 1e  61 e0 f4 eb  2c 57 c1 ab  0f 5e 8d 48
! DH_r:  28 6c 8d ab  ed e0 68 76  9e 37 40 1a  e4 35 90 dc
! end of IV generation 
! Skeyid:    11 17 85 68  65 70 67 ba  df e8 c4 39  a9 67 5e 5b
! Skeyid:    e1 08 cb b5
! Skeyid_d:  a5 fd ef 13  73 cd 62 b5  43 dc b2 1f  b6 26 bb e9
! Skeyid_d:  9a 6f 5f 99
! Skeyid_a:  98 ae e1 83  7d b3 9e 55  28 9b e2 ea  d6 cf a3 bb
! Skeyid_a:  5a 21 be 92
! Skeyid_e:  ac cb e8 02  d7 09 b6 56  99 83 f8 f2  3c 7a 1e 62
! Skeyid_e:  9a 60 cb 35
! enc key:  ac cb e8 02  d7 09 b6 56  99 83 f8 f2  3c 7a 1e 62
! IV:  e5 24 50 3d  05 21 ab 89  10 b8 09 f3  7e f8 cf ce
! IV:  2d b3 68 06
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#10
| calling callback function 0x5650f2303250
| main inI2_outR2: calculated DH finished
| processing connection mytunnel
| WARNING: finish_dh_secretiv:160: encryptor 'aes' expects keylen 16/128, SA #5 INITIATOR keylen is 20
| WARNING: finish_dh_secretiv:160: encryptor 'aes' expects keylen 16/128, SA #5 RESPONDER keylen is 0
| WARNING: main_inI2_outR2_calcdone:1230: encryptor 'aes' expects keylen 16/128, SA #5 INITIATOR keylen is 20
| WARNING: main_inI2_outR2_calcdone:1230: encryptor 'aes' expects keylen 16/128, SA #5 RESPONDER keylen is 0
| * processed 1 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 8 seconds
| next event EVENT_PENDING_DDNS in 8 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L
| *received 76 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:05
|   54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
|   05 10 02 01  00 00 00 00  00 00 00 4c  3b b8 ac 91
|   93 a8 18 40  4d df a2 5a  37 c4 c3 9a  68 d7 73 b0
|   6b 7d 77 22  1a fd 5c a5  27 08 dd 25  32 a2 24 09
|   6b 19 4b 7a  90 8c e2 14  e3 d1 46 92
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   54 c7 88 f2  d1 90 5f 9e
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  00 00 00 00
|    length: 76
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  54 c7 88 f2  d1 90 5f 9e
| RCOOKIE:  ec 02 3f 64  da 0e e2 f8
| state hash entry 8
| v1 peer and cookies match on #5, provided msgid 00000000 vs 00000000
| v1 state object #5 found, in STATE_MAIN_R2
| processing connection mytunnel
| received encrypted packet from 10.0.2.14:500
| decrypting 48 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   08 00 00 0c  01 00 00 00  0a 00 02 0e  00 00 00 18
|   64 c1 7f a9  fb d9 ef 89  aa 01 3d 5d  36 12 13 a7
|   66 af 99 f5  00 00 00 00  00 00 00 00  00 00 00 00
| next IV:  32 a2 24 09  6b 19 4b 7a  90 8c e2 14  e3 d1 46 92
| got payload 0x20(ISAKMP_NEXT_ID) needed: 0x120 opt: 0x2080
| ***parse ISAKMP Identification Payload:
|    length: 12
|    ID type: ID_IPV4_ADDR
|    DOI specific A: 0
|    DOI specific B: 0
|      obj:   0a 00 02 0e
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x2080
| ***parse ISAKMP Hash Payload:
|    length: 24
| removing 12 bytes of padding
"mytunnel" #5: Main mode peer ID is ID_IPV4_ADDR: '10.0.2.14'
| refine_connection: starting with mytunnel
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
|    match_id a=10.0.2.14
|             b=10.0.2.14
|    results  matched
|   trusted_ca_by_name called with a=(empty) b=(empty)
| refine_connection: checking mytunnel against mytunnel, best=(none) with match=1(id=1/ca=1/reqca=1)
| refine_connection: checked mytunnel against mytunnel, now for see if best
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| offered CA: '%none'
| hashing 88 bytes of SA
| authentication succeeded
| thinking about whether to send my certificate:
|   I have RSA key: OAKLEY_PRESHARED_KEY cert.type: CERT_NONE 
|   sendcert: CERT_SENDIFASKED and I did not get a certificate request 
|   so do not send cert.
| I did not send a certificate because digital signatures are not being used. (PSK)
| **emit ISAKMP Message:
|    initiator cookie:
|   54 c7 88 f2  d1 90 5f 9e
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  00 00 00 00
| ***emit ISAKMP Identification Payload (IPsec DOI):
|    ID type: ID_IPV4_ADDR
|    Protocol ID: 0
|    port: 0
| emitting 4 raw bytes of my identity into ISAKMP Identification Payload (IPsec DOI)
| my identity  0a 00 02 0f
| emitting length of ISAKMP Identification Payload (IPsec DOI): 12
| hashing 88 bytes of SA
| ***emit ISAKMP Hash Payload:
| emitting 20 raw bytes of HASH_R into ISAKMP Hash Payload
| HASH_R  51 b3 f4 f3  2c a9 cb b0  cf 6e c0 b3  40 61 1e 48
| HASH_R  d8 da 90 6c
| emitting length of ISAKMP Hash Payload: 24
| out_vendorid(): sending [CAN-IKEv2]
| ***emit ISAKMP Vendor ID Payload:
| emitting 5 raw bytes of V_ID into ISAKMP Vendor ID Payload
| V_ID  49 4b 45 76  32
| emitting length of ISAKMP Vendor ID Payload: 9
| encrypting:
|   08 00 00 0c  01 00 00 00  0a 00 02 0f  0d 00 00 18
|   51 b3 f4 f3  2c a9 cb b0  cf 6e c0 b3  40 61 1e 48
|   d8 da 90 6c  00 00 00 09  49 4b 45 76  32
| IV:
|   32 a2 24 09  6b 19 4b 7a  90 8c e2 14  e3 d1 46 92
| unpadded size is: 45
| emitting 3 zero bytes of encryption padding into ISAKMP Message
| encrypting 48 using OAKLEY_AES_CBC
| next IV:  ca fc 45 9a  a4 18 32 87  21 42 a8 9b  58 f1 47 1b
| emitting length of ISAKMP Message: 76
| last encrypted block of Phase 1:
|   ca fc 45 9a  a4 18 32 87  21 42 a8 9b  58 f1 47 1b
| complete state transition with STF_OK
"mytunnel" #5: transition from state STATE_MAIN_R2 to state STATE_MAIN_R3
| deleting event for #5
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 76 bytes for STATE_MAIN_R2 through enp0s3:500 to 10.0.2.14:500 (using #5)
|   54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
|   05 10 02 01  00 00 00 00  00 00 00 4c  48 18 b9 29
|   7c d3 44 ae  9f 2c 53 13  ed ef 7d 1c  28 86 56 87
|   45 1a 13 a0  85 67 86 03  25 06 d3 85  ca fc 45 9a
|   a4 18 32 87  21 42 a8 9b  58 f1 47 1b
| inserting event EVENT_SA_REPLACE, timeout in 3330 seconds for #5 
| event added after event EVENT_SA_REPLACE for #3
"mytunnel" #5: STATE_MAIN_R3: sent MR3, ISAKMP SA established {auth=OAKLEY_PRESHARED_KEY oursig= theirsig= cipher=aes_128 prf=oakley_sha group=modp1536}
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| unpending state #5
"mytunnel" #5: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 7 seconds
| next event EVENT_PENDING_DDNS in 7 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L\001
| *received 332 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:06
|   54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
|   08 10 20 01  b5 71 b2 9f  00 00 01 4c  37 68 d9 db
|   43 b0 89 86  d6 25 d0 ca  d9 4b 50 98  b3 7b 58 dc
|   4d 10 4d 5c  65 bd d1 52  4b a7 f1 1a  da 08 02 cc
|   67 1c 5a 6a  a2 88 cd 4b  08 d8 66 b0  29 97 b1 1b
|   25 6f 8c 72  ee e7 ee 91  32 eb e1 8c  b3 ba 16 0c
|   25 2c 95 5f  b2 56 9b c6  8c 9c 37 7a  81 30 d2 33
|   6e 7e fb 79  39 59 71 b3  78 88 26 4b  d0 15 df db
|   56 6f ea 50  f3 c5 3b b2  f7 ce 0b a2  a4 e4 60 fa
|   f8 25 3c f5  b7 0d 70 f8  57 10 61 9d  ce 98 da a4
|   7d a0 2b 87  d7 dc fe bb  d2 82 c3 5d  55 31 65 c4
|   5b 9b ac be  74 3f 0d 6c  ea 73 b4 4f  af 6b 93 6b
|   6f ff 8b f3  60 3b e6 1f  8e dd 2a f7  dc 12 29 e0
|   8c ce be 26  bc 8a 50 96  90 1c db 89  8e b1 ac 65
|   63 e3 15 2f  d0 bd 12 13  2e 22 0e 2d  a2 65 cd ce
|   d4 08 84 ab  a3 ba b5 b6  31 ec 83 2c  f4 9c 50 d7
|   b0 2a dd 6c  c2 75 7b 6e  6f bc 27 1f  eb a3 82 f8
|   55 94 ee bd  cc 34 8a 3b  94 46 7d ea  e6 86 36 b3
|   96 b5 55 7c  c4 2c 55 bd  73 48 43 0a  48 34 47 7e
|   d3 ce 9f 4e  56 d1 b2 e4  4f ff f1 14  f0 a9 b5 8a
|   24 2c 5d 95  29 9a 7f cb  a9 fa d1 84
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   54 c7 88 f2  d1 90 5f 9e
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  b5 71 b2 9f
|    length: 332
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_QUICK (32), msgid: 3044127391
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  54 c7 88 f2  d1 90 5f 9e
| RCOOKIE:  ec 02 3f 64  da 0e e2 f8
| state hash entry 8
| v1 peer and cookies match on #5, provided msgid b571b29f vs 00000000
| v1 state object not found
| ICOOKIE:  54 c7 88 f2  d1 90 5f 9e
| RCOOKIE:  ec 02 3f 64  da 0e e2 f8
| state hash entry 8
| v1 peer and cookies match on #5, provided msgid 00000000 vs 00000000
| v1 state object #5 found, in STATE_MAIN_R3
| processing connection mytunnel
| last Phase 1 IV:  ca fc 45 9a  a4 18 32 87  21 42 a8 9b  58 f1 47 1b
| current Phase 1 IV:  ca fc 45 9a  a4 18 32 87  21 42 a8 9b  58 f1 47 1b
| computed Phase 2 IV:
|   79 b5 ba 05  da ee e3 ef  3c 6a da bb  66 99 04 65
|   86 81 e6 86
| received encrypted packet from 10.0.2.14:500
| decrypting 304 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   01 00 00 18  8f db 47 32  24 d2 53 3d  89 52 eb 8c
|   52 8a 26 2d  d9 e5 9d 65  0a 00 00 38  00 00 00 01
|   00 00 00 01  00 00 00 2c  00 03 04 01  13 5a ce 28
|   00 00 00 20  00 0c 00 00  80 03 00 05  80 04 00 01
|   80 01 00 01  80 02 70 80  80 05 00 02  80 06 00 80
|   04 00 00 14  6b 52 a4 c9  62 e4 86 68  b0 9d 22 97
|   fa df 05 da  00 00 00 c4  16 2d d4 be  a0 63 f4 da
|   f9 6c 2a b0  45 b5 d6 2f  a2 f8 86 27  5b c5 78 da
|   7f 53 df da  91 55 f5 58  df 9f 32 3e  31 16 54 3f
|   83 8e d8 1c  2b 0e b1 69  37 29 68 34  fd d3 48 32
|   26 04 8a 76  8f c6 15 9d  f6 bc 74 46  3f a9 98 52
|   44 c3 63 a5  85 27 62 1e  d5 43 7b 09  72 33 1d ed
|   f4 47 bb 63  b3 2c b5 b1  8e e9 65 b2  15 0d 2e 45
|   f1 a5 aa 48  b7 e7 ce 4c  25 c2 a8 db  fc b6 c7 b6
|   a3 2d d2 f9  f5 f8 b8 03  30 dd 5f d9  56 ca 5d 10
|   52 27 22 93  35 7d 22 b2  c9 76 9b cc  2b 20 d5 68
|   88 94 41 e0  68 e7 dd 50  c3 8b 7e 66  f7 08 35 45
|   a0 f0 48 f6  69 b0 41 33  44 55 67 b6  c0 02 39 5c
|   be af 1a c4  0f 05 ce 5b  00 00 00 00  00 00 00 00
| next IV:  f0 a9 b5 8a  24 2c 5d 95  29 9a 7f cb  a9 fa d1 84
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x502 opt: 0x200030
| ***parse ISAKMP Hash Payload:
|    length: 24
| got payload 0x2(ISAKMP_NEXT_SA) needed: 0x402 opt: 0x200030
| ***parse ISAKMP Security Association Payload:
|    length: 56
|    DOI: ISAKMP_DOI_IPSEC
| got payload 0x400(ISAKMP_NEXT_NONCE) needed: 0x400 opt: 0x200030
| ***parse ISAKMP Nonce Payload:
|    length: 20
| got payload 0x10(ISAKMP_NEXT_KE) needed: 0x0 opt: 0x200030
| ***parse ISAKMP Key Exchange Payload:
|    length: 196
| removing 8 bytes of padding
| HASH(1) computed:
|   8f db 47 32  24 d2 53 3d  89 52 eb 8c  52 8a 26 2d
|   d9 e5 9d 65
"mytunnel" #5: the peer proposed: 10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0
| find_client_connection starting with mytunnel
|   looking for 10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0
|   concrete checking against sr#0 10.0.2.15/32 -> 10.0.2.14/32
| client wildcard: no  port wildcard: no  virtual: no
| duplicating state object #5
| creating state object #6 at 0x5650f3383fa0
| processing connection mytunnel
| ICOOKIE:  54 c7 88 f2  d1 90 5f 9e
| RCOOKIE:  ec 02 3f 64  da 0e e2 f8
| state hash entry 8
| inserting state object #6 bucket: 8
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #6 (head of queue)
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 44
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| parsing 4 raw bytes of ISAKMP Proposal Payload into SPI
| SPI  13 5a ce 28
| *****parse ISAKMP Transform Payload (ESP):
|    length: 32
|    transform number: 0
|    transform ID: ESP_AES
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: ENCAPSULATION_MODE
|    length/value: 1
|    [1 is ENCAPSULATION_MODE_TUNNEL]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_TYPE
|    length/value: 1
|    [1 is SA_LIFE_TYPE_SECONDS]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_DURATION
|    length/value: 28800
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: AUTH_ALGORITHM
|    length/value: 2
|    [2 is AUTH_ALGORITHM_HMAC_SHA1]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: KEY_LENGTH
|    length/value: 128
| kernel_alg_esp_enc_ok(12,128): alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| DH public value received:
|   16 2d d4 be  a0 63 f4 da  f9 6c 2a b0  45 b5 d6 2f
|   a2 f8 86 27  5b c5 78 da  7f 53 df da  91 55 f5 58
|   df 9f 32 3e  31 16 54 3f  83 8e d8 1c  2b 0e b1 69
|   37 29 68 34  fd d3 48 32  26 04 8a 76  8f c6 15 9d
|   f6 bc 74 46  3f a9 98 52  44 c3 63 a5  85 27 62 1e
|   d5 43 7b 09  72 33 1d ed  f4 47 bb 63  b3 2c b5 b1
|   8e e9 65 b2  15 0d 2e 45  f1 a5 aa 48  b7 e7 ce 4c
|   25 c2 a8 db  fc b6 c7 b6  a3 2d d2 f9  f5 f8 b8 03
|   30 dd 5f d9  56 ca 5d 10  52 27 22 93  35 7d 22 b2
|   c9 76 9b cc  2b 20 d5 68  88 94 41 e0  68 e7 dd 50
|   c3 8b 7e 66  f7 08 35 45  a0 f0 48 f6  69 b0 41 33
|   44 55 67 b6  c0 02 39 5c  be af 1a c4  0f 05 ce 5b
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 11 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #6
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #6 
| event added after event EVENT_SHUNT_SCAN
| complete state transition with STF_SUSPEND
"mytunnel" #6: [PIET]   read_packet returned false...(demux.c)
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing build_kenonce op id: 11
! Local DH secret:
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 6 seconds
| next event EVENT_PENDING_DDNS in 6 seconds
!   66 cf 56 ae  69 08 ca c1  22 47 d9 b7  83 e4 ec ee
!   38 6a 13 fe  31 eb 0c 3e  69 1e 4c 21  c7 0b 2e 5d
! Public DH value sent:
!   63 09 86 74  68 d5 b9 47  2f bd 1b 58  0d ff 0e fc
!   44 ef 08 c9  0f 46 60 bb  40 96 83 17  f6 58 13 bd
!   0c 09 e1 cb  ea 27 06 2a  83 3c a2 5f  47 b7 14 1e
!   6a 4b 35 82  e1 b7 6c 85  67 dc 88 a7  db 6b 59 06
!   bc c7 39 9f  28 b7 ae 0a  cd 32 e1 50  a8 cf fe 0a
!   be a2 43 74  9a 61 88 2e  06 52 e9 7b  e1 f6 ed d0
!   2c dc 8c 7e  62 af 8e dd  93 0f 6f 12  c4 9b 19 5d
!   5d 7e c0 9a  ab ea a7 16  eb cb 89 86  e1 dc 9a 62
!   56 c0 bd 31  ac eb 61 06  aa 75 1e 1f  f4 6e e8 a1
!   b3 8f a6 78  d5 77 4b c8  aa 10 10 81  74 04 b7 bc
!   ab 9b ce b9  13 ce 5c 5e  c7 16 df 5c  87 07 1f 6b
!   35 c2 e9 b9  50 9a ee 06  e8 f6 fd 89  14 de 23 88
! Generated nonce:
!   46 c5 a5 13  c4 b8 3c 98  2e 40 dc f2  cc bf 05 b9
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#11
| calling callback function 0x5650f230ae60
| quick inI1_outR1: calculated ke+nonce, calculating DH
| processing connection mytunnel
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh(p2) op on seq: 12 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #6
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #6 
! helper 0 read 2752+4/2760 bytesfd: 8
| event added after event EVENT_SHUNT_SCAN
| * processed 1 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 6 seconds
! helper 0 doing compute dh(p2) op id: 12
| next event EVENT_PENDING_DDNS in 6 seconds
! peer's g:   16 2d d4 be  a0 63 f4 da  f9 6c 2a b0  45 b5 d6 2f
! peer's g:   a2 f8 86 27  5b c5 78 da  7f 53 df da  91 55 f5 58
! peer's g:   df 9f 32 3e  31 16 54 3f  83 8e d8 1c  2b 0e b1 69
! peer's g:   37 29 68 34  fd d3 48 32  26 04 8a 76  8f c6 15 9d
! peer's g:   f6 bc 74 46  3f a9 98 52  44 c3 63 a5  85 27 62 1e
! peer's g:   d5 43 7b 09  72 33 1d ed  f4 47 bb 63  b3 2c b5 b1
! peer's g:   8e e9 65 b2  15 0d 2e 45  f1 a5 aa 48  b7 e7 ce 4c
! peer's g:   25 c2 a8 db  fc b6 c7 b6  a3 2d d2 f9  f5 f8 b8 03
! peer's g:   30 dd 5f d9  56 ca 5d 10  52 27 22 93  35 7d 22 b2
! peer's g:   c9 76 9b cc  2b 20 d5 68  88 94 41 e0  68 e7 dd 50
! peer's g:   c3 8b 7e 66  f7 08 35 45  a0 f0 48 f6  69 b0 41 33
! peer's g:   44 55 67 b6  c0 02 39 5c  be af 1a c4  0f 05 ce 5b
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP1536): 283 usec
! DH shared-secret:
!   f5 c7 ec ac  70 f6 82 c8  32 9a 40 04  e8 e7 3f cc
!   66 85 2e 86  f7 85 37 45  8b 37 a8 65  52 90 ec 0b
!   f7 41 1a 5e  e4 b3 1a a6  9e 21 16 8a  eb 68 29 b6
!   4e b3 b8 0a  01 fa 18 2d  d2 65 c5 36  a2 67 91 74
!   f4 ad 73 f3  18 7e 67 ba  66 fb 85 eb  ef 7b 50 33
!   52 b8 96 6d  16 15 8f 8e  dd 7d 21 0e  51 54 59 30
!   9d 45 36 df  5c d6 3b fe  20 cc 7a 5b  a8 8f 5d 58
!   ac 2c 2e b1  bf 69 15 e8  45 a7 8a dd  86 15 e6 83
!   ea 81 fd 93  bf a1 a7 1a  f1 02 5a 82  60 84 9c b5
!   71 6b 7c 77  ac 9b 67 be  b4 2b e4 92  6f 8a 13 ae
!   32 a5 16 fc  e4 66 0d 58  8b 59 82 4b  5b 45 cf 6d
!   5f 20 a6 ec  59 42 d9 a3  a7 93 70 c4  34 7f 8b 84
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#12
| calling callback function 0x5650f230b210
| quick inI1_outR1: calculated DH, sending R1
| processing connection mytunnel
| **emit ISAKMP Message:
|    initiator cookie:
|   54 c7 88 f2  d1 90 5f 9e
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  b5 71 b2 9f
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Security Association Payload:
|    DOI: ISAKMP_DOI_IPSEC
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 44
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| parsing 4 raw bytes of ISAKMP Proposal Payload into SPI
| SPI  13 5a ce 28
| *****parse ISAKMP Transform Payload (ESP):
|    length: 32
|    transform number: 0
|    transform ID: ESP_AES
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: ENCAPSULATION_MODE
|    length/value: 1
|    [1 is ENCAPSULATION_MODE_TUNNEL]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_TYPE
|    length/value: 1
|    [1 is SA_LIFE_TYPE_SECONDS]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_DURATION
|    length/value: 28800
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: AUTH_ALGORITHM
|    length/value: 2
|    [2 is AUTH_ALGORITHM_HMAC_SHA1]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: KEY_LENGTH
|    length/value: 128
| kernel_alg_esp_enc_ok(12,128): alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| ****emit IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****emit ISAKMP Proposal Payload:
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| netlink_get_spi: allocated 0x6b431d13 for esp.0@10.0.2.15
| emitting 4 raw bytes of SPI into ISAKMP Proposal Payload
| SPI  6b 43 1d 13
| *****emit ISAKMP Transform Payload (ESP):
|    transform number: 0
|    transform ID: ESP_AES
| emitting 24 raw bytes of attributes into ISAKMP Transform Payload (ESP)
| attributes  80 03 00 05  80 04 00 01  80 01 00 01  80 02 70 80
| attributes  80 05 00 02  80 06 00 80
| emitting length of ISAKMP Transform Payload (ESP): 32
| emitting length of ISAKMP Proposal Payload: 44
| emitting length of ISAKMP Security Association Payload: 56
"mytunnel" #6: responding to Quick Mode proposal {msgid:9fb271b5}
"mytunnel" #6:     us: 10.0.2.15
"mytunnel" #6:   them: 10.0.2.14
| ***emit ISAKMP Nonce Payload:
| emitting 16 raw bytes of Nr into ISAKMP Nonce Payload
| Nr  46 c5 a5 13  c4 b8 3c 98  2e 40 dc f2  cc bf 05 b9
| emitting length of ISAKMP Nonce Payload: 20
| ***emit ISAKMP Key Exchange Payload:
| emitting 192 raw bytes of keyex value into ISAKMP Key Exchange Payload
| keyex value  63 09 86 74  68 d5 b9 47  2f bd 1b 58  0d ff 0e fc
| keyex value  44 ef 08 c9  0f 46 60 bb  40 96 83 17  f6 58 13 bd
| keyex value  0c 09 e1 cb  ea 27 06 2a  83 3c a2 5f  47 b7 14 1e
| keyex value  6a 4b 35 82  e1 b7 6c 85  67 dc 88 a7  db 6b 59 06
| keyex value  bc c7 39 9f  28 b7 ae 0a  cd 32 e1 50  a8 cf fe 0a
| keyex value  be a2 43 74  9a 61 88 2e  06 52 e9 7b  e1 f6 ed d0
| keyex value  2c dc 8c 7e  62 af 8e dd  93 0f 6f 12  c4 9b 19 5d
| keyex value  5d 7e c0 9a  ab ea a7 16  eb cb 89 86  e1 dc 9a 62
| keyex value  56 c0 bd 31  ac eb 61 06  aa 75 1e 1f  f4 6e e8 a1
| keyex value  b3 8f a6 78  d5 77 4b c8  aa 10 10 81  74 04 b7 bc
| keyex value  ab 9b ce b9  13 ce 5c 5e  c7 16 df 5c  87 07 1f 6b
| keyex value  35 c2 e9 b9  50 9a ee 06  e8 f6 fd 89  14 de 23 88
| emitting length of ISAKMP Key Exchange Payload: 196
| HASH(2) computed:
|   68 fc 73 d4  17 c3 1f 17  ff db 5c 05  a5 27 f0 a3
|   a4 79 50 05
| compute_proto_keymat:needed_len (after ESP enc)=16
| compute_proto_keymat:needed_len (after ESP auth)=36
| ESP KEYMAT 
|   KEYMAT computed:
|   d3 fd ba 4d  ec cb 3b 98  7c 95 33 93  a9 8c c1 4e
|   67 8f 23 e9  8e 06 4e 1a  f4 1f a2 de  b8 4c 11 b4
|   2b fb 35 8f
|   Peer KEYMAT computed:
|   7d 41 94 20  1f 70 83 f6  b1 40 06 9f  ae 56 eb f3
|   63 da f0 2d  13 18 f6 f5  27 88 b5 e7  4a b8 7a af
|   67 7e 92 ac
| install_inbound_ipsec_sa() checking if we can route
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| could_route called for mytunnel (kind=CK_PERMANENT)
|    routing is easy, or has resolvable near-conflict
| checking if this is a replacement state
|   st=0x5650f3383fa0 ost=(nil) st->serialno=#6 ost->serialno=#0 
| installing outgoing SA now as refhim=0
| state #6(mytunnel): setup outbound esp-ipsec between 10.0.2.15<->10.0.2.14 for 10.0.2.15/32...10.0.2.14/32
| ipcomp maybe
| esp outbound maybe
| looking for outbound alg with transid: 12 keylen: 128 auth: 2 for spi=28ce5a13 [10.0.2.15->10.0.2.14] 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| ESP enckey:  7d 41 94 20  1f 70 83 f6  b1 40 06 9f  ae 56 eb f3
| ESP authkey:  63 da f0 2d  13 18 f6 f5  27 88 b5 e7  4a b8 7a af
| ESP authkey:  67 7e 92 ac
| creating SA spi=135ace28@0a00020e proto=50 family=2
| outgoing SA has refhim=4294901761
| state #6(mytunnel): setup inbound esp-ipsec between 10.0.2.14<->10.0.2.15 for 10.0.2.14/32...10.0.2.15/32
| ipcomp maybe
| esp inbound maybe
| looking for inbound alg with transid: 12 keylen: 128 auth: 2 for spi=131d436b [10.0.2.14->10.0.2.15] 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| ESP enckey:  d3 fd ba 4d  ec cb 3b 98  7c 95 33 93  a9 8c c1 4e
| ESP authkey:  67 8f 23 e9  8e 06 4e 1a  f4 1f a2 de  b8 4c 11 b4
| ESP authkey:  2b fb 35 8f
| updating SA spi=6b431d13@0a00020f proto=50 family=2
| creating SPD to 10.0.2.14->spi=00010000@10.0.2.15 proto=4
"mytunnel" #6: add inbound eroute 10.0.2.14/32:0 --0-> 10.0.2.15/32:0 => tun.10000@10.0.2.15 succeeded
| encrypting:
|   01 00 00 18  68 fc 73 d4  17 c3 1f 17  ff db 5c 05
|   a5 27 f0 a3  a4 79 50 05  0a 00 00 38  00 00 00 01
|   00 00 00 01  00 00 00 2c  00 03 04 01  6b 43 1d 13
|   00 00 00 20  00 0c 00 00  80 03 00 05  80 04 00 01
|   80 01 00 01  80 02 70 80  80 05 00 02  80 06 00 80
|   04 00 00 14  46 c5 a5 13  c4 b8 3c 98  2e 40 dc f2
|   cc bf 05 b9  00 00 00 c4  63 09 86 74  68 d5 b9 47
|   2f bd 1b 58  0d ff 0e fc  44 ef 08 c9  0f 46 60 bb
|   40 96 83 17  f6 58 13 bd  0c 09 e1 cb  ea 27 06 2a
|   83 3c a2 5f  47 b7 14 1e  6a 4b 35 82  e1 b7 6c 85
|   67 dc 88 a7  db 6b 59 06  bc c7 39 9f  28 b7 ae 0a
|   cd 32 e1 50  a8 cf fe 0a  be a2 43 74  9a 61 88 2e
|   06 52 e9 7b  e1 f6 ed d0  2c dc 8c 7e  62 af 8e dd
|   93 0f 6f 12  c4 9b 19 5d  5d 7e c0 9a  ab ea a7 16
|   eb cb 89 86  e1 dc 9a 62  56 c0 bd 31  ac eb 61 06
|   aa 75 1e 1f  f4 6e e8 a1  b3 8f a6 78  d5 77 4b c8
|   aa 10 10 81  74 04 b7 bc  ab 9b ce b9  13 ce 5c 5e
|   c7 16 df 5c  87 07 1f 6b  35 c2 e9 b9  50 9a ee 06
|   e8 f6 fd 89  14 de 23 88
| IV:
|   f0 a9 b5 8a  24 2c 5d 95  29 9a 7f cb  a9 fa d1 84
| unpadded size is: 296
| emitting 8 zero bytes of encryption padding into ISAKMP Message
| encrypting 304 using OAKLEY_AES_CBC
| next IV:  8f d9 3d 11  60 b5 d1 40  66 35 27 64  cb db f6 a8
| emitting length of ISAKMP Message: 332
| finished processing quick inI1
| complete state transition with STF_OK
"mytunnel" #6: transition from state STATE_QUICK_R0 to state STATE_QUICK_R1
| deleting event for #6
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 332 bytes for STATE_QUICK_R0 through enp0s3:500 to 10.0.2.14:500 (using #6)
|   54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
|   08 10 20 01  b5 71 b2 9f  00 00 01 4c  38 fd 68 79
|   74 3e 8d 8f  52 ab a5 ae  bd 55 db 4f  96 4e 22 3b
|   64 91 33 01  06 ef 23 18  b0 a9 c8 ed  d0 ea b3 a7
|   de 31 30 7a  45 f5 cf c8  53 1c ef 86  57 75 43 10
|   14 43 94 c8  65 b2 04 05  07 1e 00 dd  52 c6 9e 0d
|   c1 c6 8a d9  62 5a b1 7a  94 c7 a1 74  2b c3 06 4f
|   6b 88 6f 33  6e 52 56 86  c6 60 24 07  c5 4f 78 79
|   c9 3e 76 13  09 64 e3 b7  ee d9 7b 7b  10 ce 9a f7
|   b3 99 a8 43  76 70 0e 28  fe c5 85 84  ea ce e9 08
|   17 74 25 1f  72 1b 5b 0f  c9 38 a8 c3  89 88 ea a3
|   a2 09 8e 93  30 71 29 06  b0 6a db 13  e9 7b 10 59
|   de c1 b9 82  55 55 0e 80  61 42 a6 0f  be 2f 4e 84
|   53 c0 e5 a6  ab 2c e8 2c  52 70 91 a8  55 14 74 67
|   83 3b d7 c0  35 f7 02 15  0b 60 b2 36  5e 19 42 f8
|   b0 2e 00 e4  1b 43 81 06  fa 53 ab 2f  ea 03 84 62
|   9e d1 05 14  99 84 4f d7  dc 9a 8b c0  91 a9 44 e1
|   6c 0d 33 e3  9f 1b 3d 54  70 14 f2 df  32 8f ac 0b
|   d9 b2 bd bf  bc 75 30 be  6e 20 3c aa  5e c7 31 8a
|   d8 e9 fd 71  6f 40 9f ca  2f 94 33 14  8f d9 3d 11
|   60 b5 d1 40  66 35 27 64  cb db f6 a8
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #6 
| event added after event EVENT_SHUNT_SCAN
"mytunnel" #6: STATE_QUICK_R1: sent QR1, inbound IPsec SA installed, expecting QI2
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| * processed 1 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 6 seconds
| next event EVENT_PENDING_DDNS in 6 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
<
| *received 60 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:07
|   54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
|   08 10 20 01  b5 71 b2 9f  00 00 00 3c  1f c2 8c 4b
|   a4 12 56 22  fe 00 dc 65  bd 2b 04 54  04 e3 8e cb
|   fa 9c 6f 80  6a 50 12 2c  17 10 6a cb
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   54 c7 88 f2  d1 90 5f 9e
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  b5 71 b2 9f
|    length: 60
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_QUICK (32), msgid: 3044127391
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  54 c7 88 f2  d1 90 5f 9e
| RCOOKIE:  ec 02 3f 64  da 0e e2 f8
| state hash entry 8
| v1 peer and cookies match on #6, provided msgid b571b29f vs b571b29f
| v1 state object #6 found, in STATE_QUICK_R1
| processing connection mytunnel
| received encrypted packet from 10.0.2.14:500
| decrypting 32 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   00 00 00 18  5e 02 e9 fe  07 3a b6 e9  50 ca 86 c9
|   90 69 f3 e5  be 8f e1 8f  00 00 00 00  00 00 00 00
| next IV:  04 e3 8e cb  fa 9c 6f 80  6a 50 12 2c  17 10 6a cb
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x0
| ***parse ISAKMP Hash Payload:
|    length: 24
| removing 8 bytes of padding
| HASH(3) computed:  5e 02 e9 fe  07 3a b6 e9  50 ca 86 c9  90 69 f3 e5
| HASH(3) computed:  be 8f e1 8f
| state #6: install_ipsec_sa() for outbound only
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| could_route called for mytunnel (kind=CK_PERMANENT)
| state #6: now setting up incoming SA
| sr for #6: prospective erouted (eroute_owner: #0)
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| route_and_eroute with c: mytunnel (next: none) ero:mytunnel esr:{(nil)} ro:mytunnel rosr:{(nil)} and state: 6
| eroute_connection: between 10.0.2.15<->10.0.2.14
| creating SPD to 10.0.2.15->spi=00000000@10.0.2.14 proto=4
"mytunnel" #6: eroute_connection replace eroute 10.0.2.15/32:0 --0-> 10.0.2.14/32:0 => tun.0@10.0.2.14 succeeded
| command executing up-host
| executing up-host: 2>&1 PLUTO_VERB='up-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| route_and_eroute: firewall_notified: true
| route_and_eroute: instance "mytunnel", setting eroute_owner to #6 (was #0) (newest_ipsec_sa=#0)
| inI2: instance mytunnel[0], setting newest_ipsec_sa to #6 (was #0) (spd.eroute=#6)
| complete state transition with STF_OK
"mytunnel" #6: transition from state STATE_QUICK_R1 to state STATE_QUICK_R2
| deleting event for #6
| inserting event EVENT_SA_REPLACE, timeout in 28530 seconds for #6 
| event added after event EVENT_REINIT_SECRET
"mytunnel" #6: STATE_QUICK_R2: IPsec SA established tunnel mode {ESP=>0x135ace28 <0x6b431d13 xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
"mytunnel" #6: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 5 seconds
| next event EVENT_PENDING_DDNS in 5 seconds
|  
| next event EVENT_PENDING_DDNS in 0 seconds
| *time to handle event
| at 2020-01-27 11:23:12 handling event EVENT_PENDING_DDNS
| event after this is EVENT_PENDING_PHASE2 in 0 seconds
| inserting event EVENT_PENDING_DDNS, timeout in 60 seconds 
| event added after event EVENT_SHUNT_SCAN
| at 2020-01-27 11:23:12 handling event EVENT_PENDING_PHASE2
| event after this is EVENT_SHUNT_SCAN in 0 seconds
| inserting event EVENT_PENDING_PHASE2, timeout in 120 seconds 
| event added after event EVENT_PENDING_DDNS
| pending review: connection "mytunnel" was not up, skipped
| at 2020-01-27 11:23:12 handling event EVENT_SHUNT_SCAN
| event after this is EVENT_PENDING_DDNS in 60 seconds
| inserting event EVENT_SHUNT_SCAN, timeout in 120 seconds 
| event added after event EVENT_PENDING_DDNS
| scanning for expired bare shunts
| next event EVENT_PENDING_DDNS in 60 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L
| *received 76 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:13
|   54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
|   08 10 05 01  64 d9 8c 06  00 00 00 4c  c7 6d a2 66
|   2e 41 a6 71  dd 91 66 df  e3 49 c2 80  b9 64 28 aa
|   9a 4b 2b aa  92 15 8f 73  8e b9 92 c1  3f 13 b5 fa
|   aa 93 9d 1e  b3 65 54 55  3b e1 19 ad
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   54 c7 88 f2  d1 90 5f 9e
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  64 d9 8c 06
|    length: 76
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_INFO (5), msgid: 1691978758
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  54 c7 88 f2  d1 90 5f 9e
| RCOOKIE:  ec 02 3f 64  da 0e e2 f8
| state hash entry 8
| peer and cookies match on #6, provided msgid 00000000 vs b571b29f/00000000
| peer and cookies match on #5, provided msgid 00000000 vs 00000000/00000000
| p15 state object #5 found, in STATE_MAIN_R3
| processing connection mytunnel
| last Phase 1 IV:  ca fc 45 9a  a4 18 32 87  21 42 a8 9b  58 f1 47 1b
| current Phase 1 IV:  ca fc 45 9a  a4 18 32 87  21 42 a8 9b  58 f1 47 1b
| computed Phase 2 IV:
|   15 65 5f 13  fe 06 a7 06  67 07 b6 56  e4 f5 8b b8
|   4e bc 54 2a
| received encrypted packet from 10.0.2.14:500
| decrypting 48 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   0c 00 00 18  7e 22 3e 07  b5 b2 12 e3  f7 18 76 ab
|   97 25 4a d6  ad f4 f0 87  00 00 00 10  00 00 00 01
|   03 04 00 01  13 5a ce 28  00 00 00 00  00 00 00 00
| next IV:  3f 13 b5 fa  aa 93 9d 1e  b3 65 54 55  3b e1 19 ad
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x0
| ***parse ISAKMP Hash Payload:
|    length: 24
| got payload 0x1000(ISAKMP_NEXT_D) needed: 0x0 opt: 0x0
| ***parse ISAKMP Delete Payload:
|    length: 16
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 3
|    SPI size: 4
|    number of SPIs: 1
| removing 8 bytes of padding
| HASH(1) computed:
|   7e 22 3e 07  b5 b2 12 e3  f7 18 76 ab  97 25 4a d6
|   ad f4 f0 87
| received 'informational' message HASH(1) data ok
| processing connection mytunnel
"mytunnel" #5: received Delete SA(0x135ace28) payload: deleting IPSEC State #6
"mytunnel" #5: deleting state #6 (STATE_QUICK_R2)
| find_phase1_state: found SA #5 for conn 'mytunnel' in state STATE_MAIN_R3
| **emit ISAKMP Message:
|    initiator cookie:
|   54 c7 88 f2  d1 90 5f 9e
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  06 56 4c a5
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH(1) into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Delete Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 3
|    SPI size: 4
|    number of SPIs: 1
| emitting 4 raw bytes of delete payload into ISAKMP Delete Payload
| delete payload  6b 43 1d 13
| emitting length of ISAKMP Delete Payload: 16
| HASH(1) computed:
|   41 f8 cc fb  7d 4e 45 bd  88 94 59 c7  c4 da 90 a3
|   f5 8b 4c b1
| last Phase 1 IV:  ca fc 45 9a  a4 18 32 87  21 42 a8 9b  58 f1 47 1b
| current Phase 1 IV:  ca fc 45 9a  a4 18 32 87  21 42 a8 9b  58 f1 47 1b
| computed Phase 2 IV:
|   7b 18 aa 64  07 54 6f 52  d6 5a 8c 8c  6e 8f d2 b6
|   41 fc 9f 0d
| encrypting:
|   0c 00 00 18  41 f8 cc fb  7d 4e 45 bd  88 94 59 c7
|   c4 da 90 a3  f5 8b 4c b1  00 00 00 10  00 00 00 01
|   03 04 00 01  6b 43 1d 13
| IV:
|   7b 18 aa 64  07 54 6f 52  d6 5a 8c 8c  6e 8f d2 b6
|   41 fc 9f 0d
| unpadded size is: 40
| emitting 8 zero bytes of encryption padding into ISAKMP Message
| encrypting 48 using OAKLEY_AES_CBC
| next IV:  e1 9a a3 ce  be 51 0a a5  1a ef 5b b6  ef 9b 14 d2
| emitting length of ISAKMP Message: 76
| sending 76 bytes for delete notify through enp0s3:500 to 10.0.2.14:500 (using #5)
|   54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
|   08 10 05 01  06 56 4c a5  00 00 00 4c  8f fb 47 83
|   a8 09 52 78  3c 6c 1d 41  32 6c 7b f9  1e 05 90 9c
|   5a 28 02 ef  fc 32 08 23  1e 98 fb 45  e1 9a a3 ce
|   be 51 0a a5  1a ef 5b b6  ef 9b 14 d2
| deleting event for #6
| no suspended cryptographic state for 6 
| removing state object #6
| ICOOKIE:  54 c7 88 f2  d1 90 5f 9e
| RCOOKIE:  ec 02 3f 64  da 0e e2 f8
| state hash entry 8
| command executing down-host
| executing down-host: 2>&1 PLUTO_VERB='down-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| request to replace with shunt a prospective erouted policy with netkey kernel --- experimental
| creating SPD to 10.0.2.15->spi=00000104@0.0.0.0 proto=61
| delete esp.135ace28@10.0.2.14
| creating SPD to 10.0.2.14->spi=00010000@10.0.2.15 proto=255
"mytunnel" #5: delete (half) inbound eroute 10.0.2.14/32:0 --0-> 10.0.2.15/32:0 => unk255.10000@10.0.2.15 succeeded
| delete esp.6b431d13@10.0.2.15
| del:  13 5a ce 28
"mytunnel" #5: received and ignored informational message
| complete state transition with STF_IGNORE
"mytunnel" #5: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 59 seconds
| next event EVENT_PENDING_DDNS in 59 seconds
| deleting event for #6
| freeing state object #6
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\234
| *received 156 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:16
|   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00
|   01 10 02 00  00 00 00 00  00 00 00 9c  0d 00 00 5c
|   00 00 00 01  00 00 00 01  00 00 00 50  00 01 00 02
|   03 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  00 00 00 24  01 01 00 00  80 0b 00 01
|   80 0c 0e 10  80 01 00 07  80 02 00 02  80 03 00 01
|   80 04 00 02  80 0e 00 80  0d 00 00 10  4f 53 57 7e
|   7c 74 59 69  57 59 73 57  00 00 00 14  af ca d7 13
|   68 a1 f1 c9  6b 86 96 fc  77 57 01 00
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 156
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
packet from 10.0.2.14:500: Initiator Cookie must not be zero in phase 1 message
packet from 10.0.2.14:500: [PIET] I detected a ZERO initiator cookie... (ikev1.c)
packet from 10.0.2.14:500: sending notification INVALID_COOKIE to 10.0.2.14:500
| **emit ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Notification Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 0
|    Notify Message Type: INVALID_COOKIE
| emitting length of ISAKMP Notification Payload: 12
| emitting length of ISAKMP Message: 40
| sending 40 bytes for notification packet through enp0s3:500 to 10.0.2.14:500 (using #0)
|   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00
|   0b 10 05 00  00 00 00 00  00 00 00 28  00 00 00 0c
|   00 00 00 01  01 00 00 04
packet from 10.0.2.14:500: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 56 seconds
| next event EVENT_PENDING_DDNS in 56 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\234
| *received 156 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:26
|   43 46 15 a5  3d 97 37 f2  00 00 00 00  00 00 00 00
|   01 10 02 00  00 00 00 00  00 00 00 9c  0d 00 00 5c
|   00 00 00 01  00 00 00 01  00 00 00 50  00 01 00 02
|   03 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  00 00 00 24  01 01 00 00  80 0b 00 01
|   80 0c 0e 10  80 01 00 07  80 02 00 02  80 03 00 01
|   80 04 00 02  80 0e 00 80  0d 00 00 10  4f 53 57 7e
|   7c 74 59 69  57 59 73 57  00 00 00 14  af ca d7 13
|   68 a1 f1 c9  6b 86 96 fc  77 57 01 00
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   43 46 15 a5  3d 97 37 f2
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 156
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| got payload 0x2(ISAKMP_NEXT_SA) needed: 0x2 opt: 0x2080
| ***parse ISAKMP Security Association Payload:
|    length: 92
|    DOI: ISAKMP_DOI_IPSEC
| got payload 0x2000(ISAKMP_NEXT_VID) needed: 0x0 opt: 0x2080
| ***parse ISAKMP Vendor ID Payload:
|    length: 16
| got payload 0x2000(ISAKMP_NEXT_VID) needed: 0x0 opt: 0x2080
| ***parse ISAKMP Vendor ID Payload:
|    length: 20
packet from 10.0.2.14:500: ignoring unknown Vendor ID payload [4f53577e7c74596957597357]
packet from 10.0.2.14:500: received Vendor ID payload [Dead Peer Detection]
| find_host_connection2 called from main_inI1_outR1, me=10.0.2.15:500 him=10.0.2.14:500 policy=/!IKEv1
| find_host_pair: looking for me=10.0.2.15:500 %address him=10.0.2.14:500 any-match 
| find_host_pair: comparing to me=10.0.2.15:500 %address him=10.0.2.14:500 
| find_host_pair: concluded with mytunnel
| found_host_pair_conn (find_host_connection2): 10.0.2.15:500 %address/10.0.2.14:500 -> hp:mytunnel 
| searching for connection with policy = /!IKEv1
| found policy = PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK (mytunnel)
| find_host_connection2 returns mytunnel (ike=none/none)
| creating state object #7 at 0x5650f3383fa0
| processing connection mytunnel
| ICOOKIE:  43 46 15 a5  3d 97 37 f2
| RCOOKIE:  f1 c9 8a ab  81 fa bc 40
| state hash entry 30
| inserting state object #7 bucket: 30
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #7 (head of queue)
"mytunnel" #7: responding to Main Mode
| **emit ISAKMP Message:
|    initiator cookie:
|   43 46 15 a5  3d 97 37 f2
|    responder cookie:
|   f1 c9 8a ab  81 fa bc 40
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Security Association Payload:
|    DOI: ISAKMP_DOI_IPSEC
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 80
|    proposal number: 0
|    protocol ID: PROTO_ISAKMP
|    SPI size: 0
|    number of transforms: 2
| *****parse ISAKMP Transform Payload (ISAKMP):
|    length: 36
|    transform number: 0
|    transform ID: KEY_IKE
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_LIFE_TYPE
|    length/value: 1
|    [1 is OAKLEY_LIFE_SECONDS]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_LIFE_DURATION
|    length/value: 3600
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_ENCRYPTION_ALGORITHM
|    length/value: 7
|    [7 is OAKLEY_AES_CBC]
| ike_alg_enc_ok(ealg=7,key_len=0): blocksize=16, keyminlen=128, keydeflen=128, keymaxlen=256, ret=1
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_HASH_ALGORITHM
|    length/value: 2
|    [2 is OAKLEY_SHA1]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_AUTHENTICATION_METHOD
|    length/value: 1
|    [1 is OAKLEY_PRESHARED_KEY]
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_KEY_LENGTH
|    length/value: 128
| ike_alg_enc_ok(ealg=7,key_len=128): blocksize=16, keyminlen=128, keydeflen=128, keymaxlen=256, ret=1
| Oakley Transform 0 accepted
| ****emit IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****emit ISAKMP Proposal Payload:
|    proposal number: 0
|    protocol ID: PROTO_ISAKMP
|    SPI size: 0
|    number of transforms: 1
| *****emit ISAKMP Transform Payload (ISAKMP):
|    transform number: 0
|    transform ID: KEY_IKE
| emitting 28 raw bytes of attributes into ISAKMP Transform Payload (ISAKMP)
| attributes  80 0b 00 01  80 0c 0e 10  80 01 00 07  80 02 00 02
| attributes  80 03 00 01  80 04 00 05  80 0e 00 80
| emitting length of ISAKMP Transform Payload (ISAKMP): 36
| emitting length of ISAKMP Proposal Payload: 44
| emitting length of ISAKMP Security Association Payload: 56
| ***emit ISAKMP Vendor ID Payload:
| emitting 12 raw bytes of Vendor ID into ISAKMP Vendor ID Payload
| Vendor ID  4f 53 57 5e  41 76 56 4b  68 7b 55 50
| emitting length of ISAKMP Vendor ID Payload: 16
| out_vendorid(): sending [Dead Peer Detection]
| ***emit ISAKMP Vendor ID Payload:
| emitting 16 raw bytes of V_ID into ISAKMP Vendor ID Payload
| V_ID  af ca d7 13  68 a1 f1 c9  6b 86 96 fc  77 57 01 00
| emitting length of ISAKMP Vendor ID Payload: 20
| sender checking NAT-T: 0 and 0
| emitting length of ISAKMP Message: 120
| peer supports dpd
| complete state transition with STF_OK
"mytunnel" #7: transition from state STATE_MAIN_R0 to state STATE_MAIN_R1
| deleting event for #7
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 120 bytes for STATE_MAIN_R0 through enp0s3:500 to 10.0.2.14:500 (using #7)
|   43 46 15 a5  3d 97 37 f2  f1 c9 8a ab  81 fa bc 40
|   01 10 02 00  00 00 00 00  00 00 00 78  0d 00 00 38
|   00 00 00 01  00 00 00 01  00 00 00 2c  00 01 00 01
|   00 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  0d 00 00 10  4f 53 57 5e  41 76 56 4b
|   68 7b 55 50  00 00 00 14  af ca d7 13  68 a1 f1 c9
|   6b 86 96 fc  77 57 01 00
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #7 (head of queue)
"mytunnel" #7: STATE_MAIN_R1: sent MR1, expecting MI2
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
"mytunnel" #7: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #7 (2020-01-27 11:23:26)
| next event EVENT_RETRANSMIT in 10 seconds for #7 (2020-01-27 11:23:26)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\364
| *received 244 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:27
|   43 46 15 a5  3d 97 37 f2  f1 c9 8a ab  81 fa bc 40
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
|   d1 02 dd 9a  94 84 1b 0d  22 4e 8c 43  50 79 0d e2
|   e0 24 2e 58  5e 26 73 32  96 98 85 d8  70 1b 11 22
|   25 18 26 5f  84 dd fe b4  ff ee b4 98  61 a8 b3 77
|   75 5f f9 ba  cc e5 2f 3c  d5 7a c4 9b  d9 0c bc 99
|   a2 b5 17 2c  1f c5 d2 e3  d3 be d8 ff  9b 55 63 94
|   d2 d6 98 9d  c7 62 d3 a6  ed fa 4a 8a  cc ae 7a f8
|   6e df 5d 26  5a 89 5f f1  44 79 fb f7  48 d6 44 1c
|   48 f7 2f 69  da 07 d0 f6  be dd 98 7e  11 b5 18 cc
|   26 41 a5 75  52 d4 48 46  9c 49 de 23  73 4c 52 dd
|   41 bc 9d 9e  a0 c3 9d 34  84 2d 14 2f  48 ba 5e 8e
|   03 6a 20 10  40 9e 90 0f  f7 af d6 a3  3a 33 34 43
|   b2 c4 5c c8  be 83 4b dc  05 38 d5 50  c8 88 9d a7
|   00 00 00 14  55 86 d7 ae  3e 8c c7 aa  74 4e 0c 83
|   37 bb 5e bf
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   43 46 15 a5  3d 97 37 f2
|    responder cookie:
|   f1 c9 8a ab  81 fa bc 40
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 244
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  43 46 15 a5  3d 97 37 f2
| RCOOKIE:  f1 c9 8a ab  81 fa bc 40
| state hash entry 30
| v1 peer and cookies match on #7, provided msgid 00000000 vs 00000000
| v1 state object #7 found, in STATE_MAIN_R1
| processing connection mytunnel
| got payload 0x10(ISAKMP_NEXT_KE) needed: 0x410 opt: 0x102080
| ***parse ISAKMP Key Exchange Payload:
|    length: 196
| got payload 0x400(ISAKMP_NEXT_NONCE) needed: 0x400 opt: 0x102080
| ***parse ISAKMP Nonce Payload:
|    length: 20
| DH public value received:
|   d1 02 dd 9a  94 84 1b 0d  22 4e 8c 43  50 79 0d e2
|   e0 24 2e 58  5e 26 73 32  96 98 85 d8  70 1b 11 22
|   25 18 26 5f  84 dd fe b4  ff ee b4 98  61 a8 b3 77
|   75 5f f9 ba  cc e5 2f 3c  d5 7a c4 9b  d9 0c bc 99
|   a2 b5 17 2c  1f c5 d2 e3  d3 be d8 ff  9b 55 63 94
|   d2 d6 98 9d  c7 62 d3 a6  ed fa 4a 8a  cc ae 7a f8
|   6e df 5d 26  5a 89 5f f1  44 79 fb f7  48 d6 44 1c
|   48 f7 2f 69  da 07 d0 f6  be dd 98 7e  11 b5 18 cc
|   26 41 a5 75  52 d4 48 46  9c 49 de 23  73 4c 52 dd
|   41 bc 9d 9e  a0 c3 9d 34  84 2d 14 2f  48 ba 5e 8e
|   03 6a 20 10  40 9e 90 0f  f7 af d6 a3  3a 33 34 43
|   b2 c4 5c c8  be 83 4b dc  05 38 d5 50  c8 88 9d a7
| inI2: checking NAT-T: 0 and 0
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 13 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #7
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing build_kenonce op id: 13
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #7 
| event added after event EVENT_PENDING_PHASE2
| complete state transition with STF_SUSPEND
"mytunnel" #7: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 45 seconds
| next event EVENT_PENDING_DDNS in 45 seconds
! Local DH secret:
!   79 bf 8b f6  e4 6f e7 4d  7c c3 24 00  b1 a8 bd dc
!   b9 42 70 69  68 57 43 8e  a5 fa c7 f7  95 27 a3 c8
! Public DH value sent:
!   9f 8c a2 72  36 26 4f e8  7a 31 3d 75  37 3e fa 74
!   cb ad b5 1d  45 c5 e8 8b  8d 89 a0 37  f1 4c aa 46
!   2d 9a a8 46  50 12 d8 57  ea 7c 11 71  07 48 94 2c
!   62 7d 42 2e  e6 5e de f2  89 09 49 7e  de b2 bf 8f
!   71 e2 09 d3  13 0d 74 33  d3 4d d5 b6  53 15 0e b5
!   a8 78 9e b8  ab 33 51 89  47 b0 0d 62  19 0c 7d 11
!   38 5a a3 9b  2c 33 ad 8e  b1 da fc 73  0f 41 d2 87
!   7c af 21 f7  a7 78 ee e6  f8 a6 2e 22  d4 9e ac 93
!   f4 da 4f 67  77 d1 72 4d  6a 26 dc e1  3c f7 38 6a
!   45 d3 c6 2c  7c bb 3a 3c  f5 75 95 34  80 07 d1 4c
!   8c de 24 67  54 3b b0 ac  45 be 5e 16  bd f4 c2 da
!   14 3a 0b ab  db 31 6e 96  b7 dc d1 ee  7f f2 c6 c1
! Generated nonce:
!   1e cc 03 b7  fd 4d 4f 3b  fa 81 b2 7d  7c 5c 98 88
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#13
| calling callback function 0x5650f2303aa0
| main inI2_outR2: calculated ke+nonce, sending R2
| processing connection mytunnel
| **emit ISAKMP Message:
|    initiator cookie:
|   43 46 15 a5  3d 97 37 f2
|    responder cookie:
|   f1 c9 8a ab  81 fa bc 40
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Key Exchange Payload:
| emitting 192 raw bytes of keyex value into ISAKMP Key Exchange Payload
| keyex value  9f 8c a2 72  36 26 4f e8  7a 31 3d 75  37 3e fa 74
| keyex value  cb ad b5 1d  45 c5 e8 8b  8d 89 a0 37  f1 4c aa 46
| keyex value  2d 9a a8 46  50 12 d8 57  ea 7c 11 71  07 48 94 2c
| keyex value  62 7d 42 2e  e6 5e de f2  89 09 49 7e  de b2 bf 8f
| keyex value  71 e2 09 d3  13 0d 74 33  d3 4d d5 b6  53 15 0e b5
| keyex value  a8 78 9e b8  ab 33 51 89  47 b0 0d 62  19 0c 7d 11
| keyex value  38 5a a3 9b  2c 33 ad 8e  b1 da fc 73  0f 41 d2 87
| keyex value  7c af 21 f7  a7 78 ee e6  f8 a6 2e 22  d4 9e ac 93
| keyex value  f4 da 4f 67  77 d1 72 4d  6a 26 dc e1  3c f7 38 6a
| keyex value  45 d3 c6 2c  7c bb 3a 3c  f5 75 95 34  80 07 d1 4c
| keyex value  8c de 24 67  54 3b b0 ac  45 be 5e 16  bd f4 c2 da
| keyex value  14 3a 0b ab  db 31 6e 96  b7 dc d1 ee  7f f2 c6 c1
| emitting length of ISAKMP Key Exchange Payload: 196
| ***emit ISAKMP Nonce Payload:
| emitting 16 raw bytes of Nr into ISAKMP Nonce Payload
| Nr  1e cc 03 b7  fd 4d 4f 3b  fa 81 b2 7d  7c 5c 98 88
| emitting length of ISAKMP Nonce Payload: 20
| emitting length of ISAKMP Message: 244
| main inI2_outR2: starting async DH calculation (group=5)
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| parent1 type: 7 group: 5 len: 2760 
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh+iv op on seq: 14 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #7
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #7 
! helper 0 read 2752+4/2760 bytesfd: 8
| event added after event EVENT_PENDING_PHASE2
| started dh_secretiv, returned: stf=STF_SUSPEND 
! helper 0 doing compute dh+iv op id: 14
| complete state transition with STF_OK
"mytunnel" #7: transition from state STATE_MAIN_R1 to state STATE_MAIN_R2
| deleting event for #7
! peer's g:   d1 02 dd 9a  94 84 1b 0d  22 4e 8c 43  50 79 0d e2
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 244 bytes for STATE_MAIN_R1 through enp0s3:500 to 10.0.2.14:500 (using #7)
! peer's g:   e0 24 2e 58  5e 26 73 32  96 98 85 d8  70 1b 11 22
|   43 46 15 a5  3d 97 37 f2  f1 c9 8a ab  81 fa bc 40
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
! peer's g:   25 18 26 5f  84 dd fe b4  ff ee b4 98  61 a8 b3 77
|   9f 8c a2 72  36 26 4f e8  7a 31 3d 75  37 3e fa 74
|   cb ad b5 1d  45 c5 e8 8b  8d 89 a0 37  f1 4c aa 46
! peer's g:   75 5f f9 ba  cc e5 2f 3c  d5 7a c4 9b  d9 0c bc 99
|   2d 9a a8 46  50 12 d8 57  ea 7c 11 71  07 48 94 2c
|   62 7d 42 2e  e6 5e de f2  89 09 49 7e  de b2 bf 8f
! peer's g:   a2 b5 17 2c  1f c5 d2 e3  d3 be d8 ff  9b 55 63 94
|   71 e2 09 d3  13 0d 74 33  d3 4d d5 b6  53 15 0e b5
|   a8 78 9e b8  ab 33 51 89  47 b0 0d 62  19 0c 7d 11
! peer's g:   d2 d6 98 9d  c7 62 d3 a6  ed fa 4a 8a  cc ae 7a f8
|   38 5a a3 9b  2c 33 ad 8e  b1 da fc 73  0f 41 d2 87
|   7c af 21 f7  a7 78 ee e6  f8 a6 2e 22  d4 9e ac 93
|   f4 da 4f 67  77 d1 72 4d  6a 26 dc e1  3c f7 38 6a
|   45 d3 c6 2c  7c bb 3a 3c  f5 75 95 34  80 07 d1 4c
|   8c de 24 67  54 3b b0 ac  45 be 5e 16  bd f4 c2 da
|   14 3a 0b ab  db 31 6e 96  b7 dc d1 ee  7f f2 c6 c1
|   00 00 00 14  1e cc 03 b7  fd 4d 4f 3b  fa 81 b2 7d
|   7c 5c 98 88
! peer's g:   6e df 5d 26  5a 89 5f f1  44 79 fb f7  48 d6 44 1c
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #7 (head of queue)
"mytunnel" #7: STATE_MAIN_R2: sent MR2, expecting MI3
! peer's g:   48 f7 2f 69  da 07 d0 f6  be dd 98 7e  11 b5 18 cc
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| * processed 1 messages from cryptographic helpers 
! peer's g:   26 41 a5 75  52 d4 48 46  9c 49 de 23  73 4c 52 dd
| next event EVENT_RETRANSMIT in 10 seconds for #7 (2020-01-27 11:23:27)
| next event EVENT_RETRANSMIT in 10 seconds for #7 (2020-01-27 11:23:27)
! peer's g:   41 bc 9d 9e  a0 c3 9d 34  84 2d 14 2f  48 ba 5e 8e
! peer's g:   03 6a 20 10  40 9e 90 0f  f7 af d6 a3  3a 33 34 43
! peer's g:   b2 c4 5c c8  be 83 4b dc  05 38 d5 50  c8 88 9d a7
! long term secret:   79 bf 8b f6  e4 6f e7 4d  7c c3 24 00  b1 a8 bd dc
! long term secret:   b9 42 70 69  68 57 43 8e  a5 fa c7 f7  95 27 a3 c8
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP1536): 470 usec
! DH shared-secret:
!   8e 2f fe 37  64 9f 13 5a  18 2f 06 dc  4b 5f b3 e6
!   e5 e4 90 2b  8e de f9 88  2a 39 f8 c1  bc 1a 43 5b
!   a0 cf c1 84  cd 27 ac 87  58 d4 80 19  3e 62 e7 9d
!   66 57 0a 42  b4 27 2a 22  2c 52 c3 e6  79 2e cf a0
!   ce 80 bb 1d  d6 62 4d 18  ac d4 93 a3  a4 9e 34 4c
!   0b 6a df 52  a4 20 ce 2b  bc ef 9b 95  3b 20 7e 29
!   c4 26 5a 39  79 d1 f9 e4  5d ad fb ef  81 75 7c 96
!   84 d0 0f 8d  e8 f6 73 36  7d ce bc 1e  a3 4e a1 c0
!   90 72 ee 3b  b9 4d 97 17  39 72 df cd  f3 02 b2 37
!   fc b2 da e0  d2 1d 5e 66  0c e9 af 7c  b0 4f b9 b1
!   ae 1d 6b 71  06 d0 15 55  dc a3 3b ff  9e db bd e4
!   18 bf ea 8e  35 5c 2e 9c  55 e4 57 06  38 d9 4d 6d
! Skey inputs (PSK+NI+NR)
! ni:   55 86 d7 ae  3e 8c c7 aa  74 4e 0c 83  37 bb 5e bf
! nr:   1e cc 03 b7  fd 4d 4f 3b  fa 81 b2 7d  7c 5c 98 88
! keyid:   8c 19 a9 54  60 16 bc a2  90 6a 37 82  06 8f c5 92
! keyid:   41 94 9e 78
! NSS: end of key computation 
! DH_i:  d1 02 dd 9a  94 84 1b 0d  22 4e 8c 43  50 79 0d e2
! DH_i:  e0 24 2e 58  5e 26 73 32  96 98 85 d8  70 1b 11 22
! DH_i:  25 18 26 5f  84 dd fe b4  ff ee b4 98  61 a8 b3 77
! DH_i:  75 5f f9 ba  cc e5 2f 3c  d5 7a c4 9b  d9 0c bc 99
! DH_i:  a2 b5 17 2c  1f c5 d2 e3  d3 be d8 ff  9b 55 63 94
! DH_i:  d2 d6 98 9d  c7 62 d3 a6  ed fa 4a 8a  cc ae 7a f8
! DH_i:  6e df 5d 26  5a 89 5f f1  44 79 fb f7  48 d6 44 1c
! DH_i:  48 f7 2f 69  da 07 d0 f6  be dd 98 7e  11 b5 18 cc
! DH_i:  26 41 a5 75  52 d4 48 46  9c 49 de 23  73 4c 52 dd
! DH_i:  41 bc 9d 9e  a0 c3 9d 34  84 2d 14 2f  48 ba 5e 8e
! DH_i:  03 6a 20 10  40 9e 90 0f  f7 af d6 a3  3a 33 34 43
! DH_i:  b2 c4 5c c8  be 83 4b dc  05 38 d5 50  c8 88 9d a7
! DH_r:  9f 8c a2 72  36 26 4f e8  7a 31 3d 75  37 3e fa 74
! DH_r:  cb ad b5 1d  45 c5 e8 8b  8d 89 a0 37  f1 4c aa 46
! DH_r:  2d 9a a8 46  50 12 d8 57  ea 7c 11 71  07 48 94 2c
! DH_r:  62 7d 42 2e  e6 5e de f2  89 09 49 7e  de b2 bf 8f
! DH_r:  71 e2 09 d3  13 0d 74 33  d3 4d d5 b6  53 15 0e b5
! DH_r:  a8 78 9e b8  ab 33 51 89  47 b0 0d 62  19 0c 7d 11
! DH_r:  38 5a a3 9b  2c 33 ad 8e  b1 da fc 73  0f 41 d2 87
! DH_r:  7c af 21 f7  a7 78 ee e6  f8 a6 2e 22  d4 9e ac 93
! DH_r:  f4 da 4f 67  77 d1 72 4d  6a 26 dc e1  3c f7 38 6a
! DH_r:  45 d3 c6 2c  7c bb 3a 3c  f5 75 95 34  80 07 d1 4c
! DH_r:  8c de 24 67  54 3b b0 ac  45 be 5e 16  bd f4 c2 da
! DH_r:  14 3a 0b ab  db 31 6e 96  b7 dc d1 ee  7f f2 c6 c1
! end of IV generation 
! Skeyid:    8c 19 a9 54  60 16 bc a2  90 6a 37 82  06 8f c5 92
! Skeyid:    41 94 9e 78
! Skeyid_d:  84 3d 76 b5  be 98 98 ee  12 7a 42 c4  fe 92 2f 29
! Skeyid_d:  35 0e 94 fd
! Skeyid_a:  86 32 33 3f  22 80 4e 1c  7d 53 76 a6  3c 99 81 92
! Skeyid_a:  86 2e fb 2a
! Skeyid_e:  29 68 2e 21  65 2c 19 f7  77 8f 90 a3  12 ab ff 71
! Skeyid_e:  95 2d f5 03
! enc key:  29 68 2e 21  65 2c 19 f7  77 8f 90 a3  12 ab ff 71
! IV:  18 3e 88 24  3f 0b 02 3e  75 f1 ef 7f  9a 2d 1a 66
! IV:  fe a4 ff b1
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#14
| calling callback function 0x5650f2303250
| main inI2_outR2: calculated DH finished
| processing connection mytunnel
| WARNING: finish_dh_secretiv:160: encryptor 'aes' expects keylen 16/128, SA #7 INITIATOR keylen is 20
| WARNING: finish_dh_secretiv:160: encryptor 'aes' expects keylen 16/128, SA #7 RESPONDER keylen is 0
| WARNING: main_inI2_outR2_calcdone:1230: encryptor 'aes' expects keylen 16/128, SA #7 INITIATOR keylen is 20
| WARNING: main_inI2_outR2_calcdone:1230: encryptor 'aes' expects keylen 16/128, SA #7 RESPONDER keylen is 0
| * processed 1 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #7 (2020-01-27 11:23:27)
| next event EVENT_RETRANSMIT in 10 seconds for #7 (2020-01-27 11:23:27)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L
| *received 76 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:28
|   43 46 15 a5  3d 97 37 f2  f1 c9 8a ab  81 fa bc 40
|   05 10 02 01  00 00 00 00  00 00 00 4c  d2 6b 71 51
|   23 9c 70 f7  dc c4 20 ad  51 5b b1 ea  e0 16 dd 49
|   84 5d f0 98  10 a4 ef a9  fa f5 95 87  f0 96 a6 37
|   91 b0 15 ef  fe f8 52 34  b4 51 91 5f
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   43 46 15 a5  3d 97 37 f2
|    responder cookie:
|   f1 c9 8a ab  81 fa bc 40
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  00 00 00 00
|    length: 76
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  43 46 15 a5  3d 97 37 f2
| RCOOKIE:  f1 c9 8a ab  81 fa bc 40
| state hash entry 30
| v1 peer and cookies match on #7, provided msgid 00000000 vs 00000000
| v1 state object #7 found, in STATE_MAIN_R2
| processing connection mytunnel
| received encrypted packet from 10.0.2.14:500
| decrypting 48 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   08 00 00 0c  01 00 00 00  0a 00 02 0e  00 00 00 18
|   1e 91 48 15  81 55 6e af  9d f4 b0 32  49 c5 87 c9
|   2a f7 8b 82  00 00 00 00  00 00 00 00  00 00 00 00
| next IV:  f0 96 a6 37  91 b0 15 ef  fe f8 52 34  b4 51 91 5f
| got payload 0x20(ISAKMP_NEXT_ID) needed: 0x120 opt: 0x2080
| ***parse ISAKMP Identification Payload:
|    length: 12
|    ID type: ID_IPV4_ADDR
|    DOI specific A: 0
|    DOI specific B: 0
|      obj:   0a 00 02 0e
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x2080
| ***parse ISAKMP Hash Payload:
|    length: 24
| removing 12 bytes of padding
"mytunnel" #7: Main mode peer ID is ID_IPV4_ADDR: '10.0.2.14'
| refine_connection: starting with mytunnel
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
|    match_id a=10.0.2.14
|             b=10.0.2.14
|    results  matched
|   trusted_ca_by_name called with a=(empty) b=(empty)
| refine_connection: checking mytunnel against mytunnel, best=(none) with match=1(id=1/ca=1/reqca=1)
| refine_connection: checked mytunnel against mytunnel, now for see if best
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| offered CA: '%none'
| hashing 88 bytes of SA
| authentication succeeded
| thinking about whether to send my certificate:
|   I have RSA key: OAKLEY_PRESHARED_KEY cert.type: CERT_NONE 
|   sendcert: CERT_SENDIFASKED and I did not get a certificate request 
|   so do not send cert.
| I did not send a certificate because digital signatures are not being used. (PSK)
| **emit ISAKMP Message:
|    initiator cookie:
|   43 46 15 a5  3d 97 37 f2
|    responder cookie:
|   f1 c9 8a ab  81 fa bc 40
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  00 00 00 00
| ***emit ISAKMP Identification Payload (IPsec DOI):
|    ID type: ID_IPV4_ADDR
|    Protocol ID: 0
|    port: 0
| emitting 4 raw bytes of my identity into ISAKMP Identification Payload (IPsec DOI)
| my identity  0a 00 02 0f
| emitting length of ISAKMP Identification Payload (IPsec DOI): 12
| hashing 88 bytes of SA
| ***emit ISAKMP Hash Payload:
| emitting 20 raw bytes of HASH_R into ISAKMP Hash Payload
| HASH_R  cc bf 3c b1  4d 17 04 93  db e8 7f 62  b3 07 5a 09
| HASH_R  ee 3d 45 5b
| emitting length of ISAKMP Hash Payload: 24
| out_vendorid(): sending [CAN-IKEv2]
| ***emit ISAKMP Vendor ID Payload:
| emitting 5 raw bytes of V_ID into ISAKMP Vendor ID Payload
| V_ID  49 4b 45 76  32
| emitting length of ISAKMP Vendor ID Payload: 9
| encrypting:
|   08 00 00 0c  01 00 00 00  0a 00 02 0f  0d 00 00 18
|   cc bf 3c b1  4d 17 04 93  db e8 7f 62  b3 07 5a 09
|   ee 3d 45 5b  00 00 00 09  49 4b 45 76  32
| IV:
|   f0 96 a6 37  91 b0 15 ef  fe f8 52 34  b4 51 91 5f
| unpadded size is: 45
| emitting 3 zero bytes of encryption padding into ISAKMP Message
| encrypting 48 using OAKLEY_AES_CBC
| next IV:  f7 71 b5 d1  71 2f b9 d4  be 51 5f 07  e5 d7 1d 86
| emitting length of ISAKMP Message: 76
| last encrypted block of Phase 1:
|   f7 71 b5 d1  71 2f b9 d4  be 51 5f 07  e5 d7 1d 86
| complete state transition with STF_OK
"mytunnel" #7: transition from state STATE_MAIN_R2 to state STATE_MAIN_R3
| deleting event for #7
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 76 bytes for STATE_MAIN_R2 through enp0s3:500 to 10.0.2.14:500 (using #7)
|   43 46 15 a5  3d 97 37 f2  f1 c9 8a ab  81 fa bc 40
|   05 10 02 01  00 00 00 00  00 00 00 4c  ba 7e bf ba
|   43 e8 b4 41  80 20 56 e3  ea 06 b2 2c  c6 88 bb 46
|   63 69 cf e0  4a 67 1a 7b  47 8c c2 6b  f7 71 b5 d1
|   71 2f b9 d4  be 51 5f 07  e5 d7 1d 86
| inserting event EVENT_SA_REPLACE, timeout in 3330 seconds for #7 
| event added after event EVENT_SA_REPLACE for #5
"mytunnel" #7: STATE_MAIN_R3: sent MR3, ISAKMP SA established {auth=OAKLEY_PRESHARED_KEY oursig= theirsig= cipher=aes_128 prf=oakley_sha group=modp1536}
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| unpending state #7
"mytunnel" #7: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 44 seconds
| next event EVENT_PENDING_DDNS in 44 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L\001
| *received 332 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:29
|   43 46 15 a5  3d 97 37 f2  f1 c9 8a ab  81 fa bc 40
|   08 10 20 01  77 96 9d fa  00 00 01 4c  3f 52 d8 06
|   42 d0 b7 d4  44 02 94 50  2b c3 2c 17  4c 34 5e c5
|   32 ef 8e df  74 a6 3e a2  74 c7 7f 53  f0 1d 1f 64
|   af 00 65 6f  94 63 27 55  7e 97 f8 4b  87 55 ba 19
|   4c 56 e8 47  1d fe 05 11  c9 91 ff fa  0f 0d 5b 79
|   3a 18 70 8a  ed a4 a0 a5  a8 37 c7 f2  f6 36 84 6b
|   52 01 b2 77  97 24 e5 d7  85 b6 8d e0  65 60 97 3a
|   36 18 1a c4  3a 99 5b 67  69 a9 49 99  ba f3 0e f0
|   3e f5 bc a2  d5 04 28 03  51 3a ae 93  b0 41 ae 54
|   1a 07 8c 9e  1e bc c3 c9  7f 74 13 64  b6 2d 34 ad
|   cd fd 66 b6  db 22 73 68  91 b1 c1 cb  16 6c af fa
|   7b 42 17 23  c8 5e 2f a6  bc f5 16 0b  52 72 b0 62
|   7f d3 62 f4  09 8a 80 6a  45 3f a4 2b  60 ed 57 7d
|   4a bb da 1a  23 64 5d 1e  89 86 2b 7a  92 8c b7 f1
|   33 7e 7b cf  de c6 59 41  e6 0e 3a 37  f6 a4 1e 61
|   c9 f5 1b d1  b5 d1 38 fc  8d 79 c1 b1  35 dd f0 d8
|   13 24 7c be  ea ac 6d b8  58 0e 2a 8d  b1 36 86 9e
|   75 53 de 71  b8 c5 f1 54  dc 53 de 8b  e3 d5 72 1a
|   68 3c 4a 9c  4b 80 b8 f2  28 f3 2f d8  7d a5 7b 80
|   41 af da e2  08 7c f3 67  07 c1 5b 4d
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   43 46 15 a5  3d 97 37 f2
|    responder cookie:
|   f1 c9 8a ab  81 fa bc 40
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  77 96 9d fa
|    length: 332
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_QUICK (32), msgid: 2006359546
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  43 46 15 a5  3d 97 37 f2
| RCOOKIE:  f1 c9 8a ab  81 fa bc 40
| state hash entry 30
| v1 peer and cookies match on #7, provided msgid 77969dfa vs 00000000
| v1 state object not found
| ICOOKIE:  43 46 15 a5  3d 97 37 f2
| RCOOKIE:  f1 c9 8a ab  81 fa bc 40
| state hash entry 30
| v1 peer and cookies match on #7, provided msgid 00000000 vs 00000000
| v1 state object #7 found, in STATE_MAIN_R3
| processing connection mytunnel
| last Phase 1 IV:  f7 71 b5 d1  71 2f b9 d4  be 51 5f 07  e5 d7 1d 86
| current Phase 1 IV:  f7 71 b5 d1  71 2f b9 d4  be 51 5f 07  e5 d7 1d 86
| computed Phase 2 IV:
|   04 86 fd 1a  f8 84 d1 14  47 ad 62 f1  08 8c de 6a
|   50 50 bf a2
| received encrypted packet from 10.0.2.14:500
| decrypting 304 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   01 00 00 18  6e 2d 6d b0  34 c5 ab 44  cc 9b b1 87
|   b0 bd ec f3  12 43 e1 4f  0a 00 00 38  00 00 00 01
|   00 00 00 01  00 00 00 2c  00 03 04 01  e0 bd ca 95
|   00 00 00 20  00 0c 00 00  80 03 00 05  80 04 00 01
|   80 01 00 01  80 02 70 80  80 05 00 02  80 06 00 80
|   04 00 00 14  39 5f 46 d8  55 35 47 54  0b e6 38 6e
|   5e 14 76 86  00 00 00 c4  fb 84 1d c7  8b a6 a6 2e
|   a5 6c 01 38  53 84 af 78  34 77 28 e1  a8 d9 9a 61
|   02 20 bb 58  7f f1 b3 1d  51 66 1c a0  e3 bb 36 89
|   69 46 da 48  96 53 79 f3  14 9d b8 14  27 69 2f 23
|   c5 1a f9 f3  30 da 08 5e  50 70 4e 9b  64 f5 21 ba
|   81 49 2a c4  e0 b4 7f 1a  43 fe 6f aa  bf 71 15 e7
|   3e 92 3c 54  27 d3 2b 45  b4 ea 1e dd  02 03 ee 5c
|   15 73 59 2d  4e 99 55 25  a0 00 f0 18  de 8f b4 1c
|   fd 00 24 3a  7e 38 50 a6  58 42 76 94  13 11 63 c3
|   0f fa 10 40  06 4f da 46  19 b1 c1 cc  05 f9 1c c6
|   75 ac 5c 6f  1b 53 6b da  e0 c1 1d 60  e6 27 c6 58
|   d4 53 76 68  22 6c 36 e8  25 5d f3 69  dd 90 d7 04
|   be 15 74 b7  a0 74 41 5d  00 00 00 00  00 00 00 00
| next IV:  7d a5 7b 80  41 af da e2  08 7c f3 67  07 c1 5b 4d
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x502 opt: 0x200030
| ***parse ISAKMP Hash Payload:
|    length: 24
| got payload 0x2(ISAKMP_NEXT_SA) needed: 0x402 opt: 0x200030
| ***parse ISAKMP Security Association Payload:
|    length: 56
|    DOI: ISAKMP_DOI_IPSEC
| got payload 0x400(ISAKMP_NEXT_NONCE) needed: 0x400 opt: 0x200030
| ***parse ISAKMP Nonce Payload:
|    length: 20
| got payload 0x10(ISAKMP_NEXT_KE) needed: 0x0 opt: 0x200030
| ***parse ISAKMP Key Exchange Payload:
|    length: 196
| removing 8 bytes of padding
| HASH(1) computed:
|   6e 2d 6d b0  34 c5 ab 44  cc 9b b1 87  b0 bd ec f3
|   12 43 e1 4f
"mytunnel" #7: the peer proposed: 10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0
| find_client_connection starting with mytunnel
|   looking for 10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0
|   concrete checking against sr#0 10.0.2.15/32 -> 10.0.2.14/32
| client wildcard: no  port wildcard: no  virtual: no
| duplicating state object #7
| creating state object #8 at 0x5650f3385130
| processing connection mytunnel
| ICOOKIE:  43 46 15 a5  3d 97 37 f2
| RCOOKIE:  f1 c9 8a ab  81 fa bc 40
| state hash entry 30
| inserting state object #8 bucket: 30
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #8 (head of queue)
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 44
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| parsing 4 raw bytes of ISAKMP Proposal Payload into SPI
| SPI  e0 bd ca 95
| *****parse ISAKMP Transform Payload (ESP):
|    length: 32
|    transform number: 0
|    transform ID: ESP_AES
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: ENCAPSULATION_MODE
|    length/value: 1
|    [1 is ENCAPSULATION_MODE_TUNNEL]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_TYPE
|    length/value: 1
|    [1 is SA_LIFE_TYPE_SECONDS]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_DURATION
|    length/value: 28800
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: AUTH_ALGORITHM
|    length/value: 2
|    [2 is AUTH_ALGORITHM_HMAC_SHA1]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: KEY_LENGTH
|    length/value: 128
| kernel_alg_esp_enc_ok(12,128): alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| DH public value received:
|   fb 84 1d c7  8b a6 a6 2e  a5 6c 01 38  53 84 af 78
|   34 77 28 e1  a8 d9 9a 61  02 20 bb 58  7f f1 b3 1d
|   51 66 1c a0  e3 bb 36 89  69 46 da 48  96 53 79 f3
|   14 9d b8 14  27 69 2f 23  c5 1a f9 f3  30 da 08 5e
|   50 70 4e 9b  64 f5 21 ba  81 49 2a c4  e0 b4 7f 1a
|   43 fe 6f aa  bf 71 15 e7  3e 92 3c 54  27 d3 2b 45
|   b4 ea 1e dd  02 03 ee 5c  15 73 59 2d  4e 99 55 25
|   a0 00 f0 18  de 8f b4 1c  fd 00 24 3a  7e 38 50 a6
|   58 42 76 94  13 11 63 c3  0f fa 10 40  06 4f da 46
|   19 b1 c1 cc  05 f9 1c c6  75 ac 5c 6f  1b 53 6b da
|   e0 c1 1d 60  e6 27 c6 58  d4 53 76 68  22 6c 36 e8
|   25 5d f3 69  dd 90 d7 04  be 15 74 b7  a0 74 41 5d
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 15 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #8
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing build_kenonce op id: 15
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #8 
| event added after event EVENT_PENDING_PHASE2
! Local DH secret:
| complete state transition with STF_SUSPEND
"mytunnel" #8: [PIET]   read_packet returned false...(demux.c)
!   8a 11 5c da  33 31 6d a7  0c d0 31 e6  c5 ee df bd
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
!   8e fc 11 22  e5 03 f3 85  09 48 04 c4  73 56 d3 e9
| next event EVENT_PENDING_DDNS in 43 seconds
| next event EVENT_PENDING_DDNS in 43 seconds
! Public DH value sent:
!   b8 47 1e 5b  57 96 1d 8a  02 ec d5 99  11 d7 b0 dc
!   7e 0c 9d bb  96 b5 fd c5  4e 4c 92 61  18 d8 8e fe
!   60 81 18 5b  43 f5 ee ec  8d f6 5f 0f  d9 09 31 d3
!   8f 7c f7 68  a8 97 04 92  ca 9e 05 a5  03 bf d7 10
!   69 68 c8 d7  3a a0 e1 c5  a8 34 28 82  04 6f 6c 60
!   f8 3d 68 8b  24 8a 3f 1e  af b1 f3 82  41 1c 18 9c
!   a3 8e 41 9c  c3 b0 e8 9b  35 2c e1 0a  94 8f a4 2c
!   6e 99 22 e2  3d 4d 08 6d  be eb ab 6b  8e d1 e4 1e
!   ff a4 10 3a  1d aa c4 48  d9 a5 25 e9  9f 07 ac 86
!   41 a6 a1 64  23 20 74 c7  38 e1 7c ac  2a 77 3e c0
!   21 81 18 11  a4 57 6d 6d  eb 32 fa 50  07 57 55 2e
!   4c ec 4a 13  9b 11 a3 62  83 f6 dc d7  d5 5a da 68
! Generated nonce:
!   ed de f8 d5  a0 47 2b d1  2c 17 97 78  68 d7 9e 86
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#15
| calling callback function 0x5650f230ae60
| quick inI1_outR1: calculated ke+nonce, calculating DH
| processing connection mytunnel
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh(p2) op on seq: 16 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #8
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #8 
| event added after event EVENT_PENDING_PHASE2
| * processed 1 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 43 seconds
| next event EVENT_PENDING_DDNS in 43 seconds
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing compute dh(p2) op id: 16
! peer's g:   fb 84 1d c7  8b a6 a6 2e  a5 6c 01 38  53 84 af 78
! peer's g:   34 77 28 e1  a8 d9 9a 61  02 20 bb 58  7f f1 b3 1d
! peer's g:   51 66 1c a0  e3 bb 36 89  69 46 da 48  96 53 79 f3
! peer's g:   14 9d b8 14  27 69 2f 23  c5 1a f9 f3  30 da 08 5e
! peer's g:   50 70 4e 9b  64 f5 21 ba  81 49 2a c4  e0 b4 7f 1a
! peer's g:   43 fe 6f aa  bf 71 15 e7  3e 92 3c 54  27 d3 2b 45
! peer's g:   b4 ea 1e dd  02 03 ee 5c  15 73 59 2d  4e 99 55 25
! peer's g:   a0 00 f0 18  de 8f b4 1c  fd 00 24 3a  7e 38 50 a6
! peer's g:   58 42 76 94  13 11 63 c3  0f fa 10 40  06 4f da 46
! peer's g:   19 b1 c1 cc  05 f9 1c c6  75 ac 5c 6f  1b 53 6b da
! peer's g:   e0 c1 1d 60  e6 27 c6 58  d4 53 76 68  22 6c 36 e8
! peer's g:   25 5d f3 69  dd 90 d7 04  be 15 74 b7  a0 74 41 5d
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP1536): 279 usec
! DH shared-secret:
!   31 32 86 6e  db 00 d9 62  b6 01 0b 10  ee 25 6a cb
!   f8 3a 1c 8c  61 fa 1b 4d  bc 62 b7 45  57 6b 06 b1
!   0d 73 25 1d  75 57 eb ee  1a 1c 6c a0  51 3b 5f cd
!   18 26 7c f2  f7 ab 55 fa  f3 72 32 56  c8 13 51 79
!   90 bb c1 86  2c d7 e5 ea  55 ae 9c 59  df 10 12 03
!   ee 45 18 be  ac ad 70 ff  71 cd 20 01  f0 6b a0 39
!   94 f7 28 2c  1f 5e a3 32  f3 f2 de 31  65 a1 c7 e3
!   97 80 6f 5b  6a 4c a7 75  f1 80 df 84  a4 28 59 a5
!   6e 90 39 0b  c2 5a 7b f0  ae c8 01 83  3e 7a 31 fd
!   f1 08 ec e9  c2 33 25 53  bc d3 bf 72  58 0e 88 05
!   c7 7f 3c 3c  73 2b 64 46  c3 ba ae 30  79 0d 47 e8
!   2a 59 6e fe  75 49 1e 13  cf 06 38 37  e6 ce c0 a2
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#16
| calling callback function 0x5650f230b210
| quick inI1_outR1: calculated DH, sending R1
| processing connection mytunnel
| **emit ISAKMP Message:
|    initiator cookie:
|   43 46 15 a5  3d 97 37 f2
|    responder cookie:
|   f1 c9 8a ab  81 fa bc 40
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  77 96 9d fa
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Security Association Payload:
|    DOI: ISAKMP_DOI_IPSEC
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 44
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| parsing 4 raw bytes of ISAKMP Proposal Payload into SPI
| SPI  e0 bd ca 95
| *****parse ISAKMP Transform Payload (ESP):
|    length: 32
|    transform number: 0
|    transform ID: ESP_AES
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: ENCAPSULATION_MODE
|    length/value: 1
|    [1 is ENCAPSULATION_MODE_TUNNEL]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_TYPE
|    length/value: 1
|    [1 is SA_LIFE_TYPE_SECONDS]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_DURATION
|    length/value: 28800
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: AUTH_ALGORITHM
|    length/value: 2
|    [2 is AUTH_ALGORITHM_HMAC_SHA1]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: KEY_LENGTH
|    length/value: 128
| kernel_alg_esp_enc_ok(12,128): alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| ****emit IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****emit ISAKMP Proposal Payload:
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| netlink_get_spi: allocated 0xa6ae52c6 for esp.0@10.0.2.15
| emitting 4 raw bytes of SPI into ISAKMP Proposal Payload
| SPI  a6 ae 52 c6
| *****emit ISAKMP Transform Payload (ESP):
|    transform number: 0
|    transform ID: ESP_AES
| emitting 24 raw bytes of attributes into ISAKMP Transform Payload (ESP)
| attributes  80 03 00 05  80 04 00 01  80 01 00 01  80 02 70 80
| attributes  80 05 00 02  80 06 00 80
| emitting length of ISAKMP Transform Payload (ESP): 32
| emitting length of ISAKMP Proposal Payload: 44
| emitting length of ISAKMP Security Association Payload: 56
"mytunnel" #8: responding to Quick Mode proposal {msgid:fa9d9677}
"mytunnel" #8:     us: 10.0.2.15
"mytunnel" #8:   them: 10.0.2.14
| ***emit ISAKMP Nonce Payload:
| emitting 16 raw bytes of Nr into ISAKMP Nonce Payload
| Nr  ed de f8 d5  a0 47 2b d1  2c 17 97 78  68 d7 9e 86
| emitting length of ISAKMP Nonce Payload: 20
| ***emit ISAKMP Key Exchange Payload:
| emitting 192 raw bytes of keyex value into ISAKMP Key Exchange Payload
| keyex value  b8 47 1e 5b  57 96 1d 8a  02 ec d5 99  11 d7 b0 dc
| keyex value  7e 0c 9d bb  96 b5 fd c5  4e 4c 92 61  18 d8 8e fe
| keyex value  60 81 18 5b  43 f5 ee ec  8d f6 5f 0f  d9 09 31 d3
| keyex value  8f 7c f7 68  a8 97 04 92  ca 9e 05 a5  03 bf d7 10
| keyex value  69 68 c8 d7  3a a0 e1 c5  a8 34 28 82  04 6f 6c 60
| keyex value  f8 3d 68 8b  24 8a 3f 1e  af b1 f3 82  41 1c 18 9c
| keyex value  a3 8e 41 9c  c3 b0 e8 9b  35 2c e1 0a  94 8f a4 2c
| keyex value  6e 99 22 e2  3d 4d 08 6d  be eb ab 6b  8e d1 e4 1e
| keyex value  ff a4 10 3a  1d aa c4 48  d9 a5 25 e9  9f 07 ac 86
| keyex value  41 a6 a1 64  23 20 74 c7  38 e1 7c ac  2a 77 3e c0
| keyex value  21 81 18 11  a4 57 6d 6d  eb 32 fa 50  07 57 55 2e
| keyex value  4c ec 4a 13  9b 11 a3 62  83 f6 dc d7  d5 5a da 68
| emitting length of ISAKMP Key Exchange Payload: 196
| HASH(2) computed:
|   9b bc 2e 7e  0b 90 e8 10  f4 e0 18 94  40 28 c5 42
|   43 15 88 41
| compute_proto_keymat:needed_len (after ESP enc)=16
| compute_proto_keymat:needed_len (after ESP auth)=36
| ESP KEYMAT 
|   KEYMAT computed:
|   fb d9 da 64  ab cb 10 b7  f6 63 ac 10  31 18 8b 17
|   a5 01 7f 1d  2e 44 bc 5a  ca ca ee 5c  7c ef 14 4c
|   92 46 30 4a
|   Peer KEYMAT computed:
|   43 da d8 b0  2f 57 e1 aa  51 01 1b ea  c4 76 ee 6f
|   4a 55 82 59  9c 25 8e 29  30 62 81 7f  90 ba 0d 64
|   c9 95 22 f8
| install_inbound_ipsec_sa() checking if we can route
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| could_route called for mytunnel (kind=CK_PERMANENT)
|    routing is easy, or has resolvable near-conflict
| checking if this is a replacement state
|   st=0x5650f3385130 ost=(nil) st->serialno=#8 ost->serialno=#0 
| installing outgoing SA now as refhim=0
| state #8(mytunnel): setup outbound esp-ipsec between 10.0.2.15<->10.0.2.14 for 10.0.2.15/32...10.0.2.14/32
| ipcomp maybe
| esp outbound maybe
| looking for outbound alg with transid: 12 keylen: 128 auth: 2 for spi=95cabde0 [10.0.2.15->10.0.2.14] 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| ESP enckey:  43 da d8 b0  2f 57 e1 aa  51 01 1b ea  c4 76 ee 6f
| ESP authkey:  4a 55 82 59  9c 25 8e 29  30 62 81 7f  90 ba 0d 64
| ESP authkey:  c9 95 22 f8
| creating SA spi=e0bdca95@0a00020e proto=50 family=2
| outgoing SA has refhim=4294901761
| state #8(mytunnel): setup inbound esp-ipsec between 10.0.2.14<->10.0.2.15 for 10.0.2.14/32...10.0.2.15/32
| ipcomp maybe
| esp inbound maybe
| looking for inbound alg with transid: 12 keylen: 128 auth: 2 for spi=c652aea6 [10.0.2.14->10.0.2.15] 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| ESP enckey:  fb d9 da 64  ab cb 10 b7  f6 63 ac 10  31 18 8b 17
| ESP authkey:  a5 01 7f 1d  2e 44 bc 5a  ca ca ee 5c  7c ef 14 4c
| ESP authkey:  92 46 30 4a
| updating SA spi=a6ae52c6@0a00020f proto=50 family=2
| creating SPD to 10.0.2.14->spi=00010000@10.0.2.15 proto=4
"mytunnel" #8: add inbound eroute 10.0.2.14/32:0 --0-> 10.0.2.15/32:0 => tun.10000@10.0.2.15 succeeded
| encrypting:
|   01 00 00 18  9b bc 2e 7e  0b 90 e8 10  f4 e0 18 94
|   40 28 c5 42  43 15 88 41  0a 00 00 38  00 00 00 01
|   00 00 00 01  00 00 00 2c  00 03 04 01  a6 ae 52 c6
|   00 00 00 20  00 0c 00 00  80 03 00 05  80 04 00 01
|   80 01 00 01  80 02 70 80  80 05 00 02  80 06 00 80
|   04 00 00 14  ed de f8 d5  a0 47 2b d1  2c 17 97 78
|   68 d7 9e 86  00 00 00 c4  b8 47 1e 5b  57 96 1d 8a
|   02 ec d5 99  11 d7 b0 dc  7e 0c 9d bb  96 b5 fd c5
|   4e 4c 92 61  18 d8 8e fe  60 81 18 5b  43 f5 ee ec
|   8d f6 5f 0f  d9 09 31 d3  8f 7c f7 68  a8 97 04 92
|   ca 9e 05 a5  03 bf d7 10  69 68 c8 d7  3a a0 e1 c5
|   a8 34 28 82  04 6f 6c 60  f8 3d 68 8b  24 8a 3f 1e
|   af b1 f3 82  41 1c 18 9c  a3 8e 41 9c  c3 b0 e8 9b
|   35 2c e1 0a  94 8f a4 2c  6e 99 22 e2  3d 4d 08 6d
|   be eb ab 6b  8e d1 e4 1e  ff a4 10 3a  1d aa c4 48
|   d9 a5 25 e9  9f 07 ac 86  41 a6 a1 64  23 20 74 c7
|   38 e1 7c ac  2a 77 3e c0  21 81 18 11  a4 57 6d 6d
|   eb 32 fa 50  07 57 55 2e  4c ec 4a 13  9b 11 a3 62
|   83 f6 dc d7  d5 5a da 68
| IV:
|   7d a5 7b 80  41 af da e2  08 7c f3 67  07 c1 5b 4d
| unpadded size is: 296
| emitting 8 zero bytes of encryption padding into ISAKMP Message
| encrypting 304 using OAKLEY_AES_CBC
| next IV:  ef 28 09 09  a4 96 63 39  20 c4 82 39  2b de ce be
| emitting length of ISAKMP Message: 332
| finished processing quick inI1
| complete state transition with STF_OK
"mytunnel" #8: transition from state STATE_QUICK_R0 to state STATE_QUICK_R1
| deleting event for #8
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 332 bytes for STATE_QUICK_R0 through enp0s3:500 to 10.0.2.14:500 (using #8)
|   43 46 15 a5  3d 97 37 f2  f1 c9 8a ab  81 fa bc 40
|   08 10 20 01  77 96 9d fa  00 00 01 4c  1f 1c e8 1e
|   54 74 5c 58  40 8b 17 74  80 57 16 82  da 43 e7 5c
|   86 10 bb ab  e8 3a 3a 06  38 f7 23 be  d2 2d 2c ea
|   c7 fa 39 60  54 74 67 19  28 8e e4 e2  fa e8 38 49
|   b8 ad ca 4f  75 9c 3b 7a  3a 40 ff 37  36 55 c7 bf
|   70 fd 90 ae  ad 7a 86 a9  04 7c 84 a8  d1 53 e1 15
|   1f 8a c4 1f  f8 d4 1f 77  1a 15 b1 f8  38 59 cf bd
|   bc c5 fc 4b  b1 3b 50 be  ec 49 7a fd  fd 08 d5 25
|   a7 4d cc 78  53 31 1a 4e  17 a1 0a 6f  6e 4c d7 ad
|   ee 2a 3a 5f  9d 31 5e 76  32 51 d0 f5  d4 90 ba a4
|   c6 20 51 1a  0b ad 62 64  c8 ff 8e f7  c7 9f ee 58
|   b0 dc 17 6d  3a 5d 03 81  16 b6 ce 73  c9 b0 b9 7a
|   1c b2 c9 3e  68 3e 79 d3  9d 88 7a 04  b8 4b cb 2f
|   ed 13 03 15  4f 57 ec 25  db aa 9e 0c  6a 63 83 2b
|   52 4b fb 13  25 2c 85 73  38 26 88 07  4a 5b f7 a7
|   8b 41 05 fb  00 7a e6 e4  66 f7 d1 dc  c2 52 4c 52
|   7c 84 17 7a  ba 02 73 02  b9 8b 49 11  f3 bd cc 85
|   d8 74 86 89  c3 8d bf 98  d4 1d 80 22  3e 02 d4 3e
|   3c 3c 97 f2  db 72 95 6a  db 74 8e 59  ef 28 09 09
|   a4 96 63 39  20 c4 82 39  2b de ce be
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #8 (head of queue)
"mytunnel" #8: STATE_QUICK_R1: sent QR1, inbound IPsec SA installed, expecting QI2
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| * processed 1 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #8 (2020-01-27 11:23:29)
| next event EVENT_RETRANSMIT in 10 seconds for #8 (2020-01-27 11:23:29)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
<
| *received 60 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:30
|   43 46 15 a5  3d 97 37 f2  f1 c9 8a ab  81 fa bc 40
|   08 10 20 01  77 96 9d fa  00 00 00 3c  07 0d 16 9b
|   0e f6 30 8e  a1 7d 8a 5a  2d 6b 03 f7  bb 28 2d 4b
|   94 99 66 20  0b e8 19 aa  c0 f2 22 9b
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   43 46 15 a5  3d 97 37 f2
|    responder cookie:
|   f1 c9 8a ab  81 fa bc 40
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  77 96 9d fa
|    length: 60
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_QUICK (32), msgid: 2006359546
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  43 46 15 a5  3d 97 37 f2
| RCOOKIE:  f1 c9 8a ab  81 fa bc 40
| state hash entry 30
| v1 peer and cookies match on #8, provided msgid 77969dfa vs 77969dfa
| v1 state object #8 found, in STATE_QUICK_R1
| processing connection mytunnel
| received encrypted packet from 10.0.2.14:500
| decrypting 32 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   00 00 00 18  4e e0 83 50  9d 9a 28 27  5a dc f6 fa
|   b1 32 86 51  01 25 b3 bb  00 00 00 00  00 00 00 00
| next IV:  bb 28 2d 4b  94 99 66 20  0b e8 19 aa  c0 f2 22 9b
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x0
| ***parse ISAKMP Hash Payload:
|    length: 24
| removing 8 bytes of padding
| HASH(3) computed:  4e e0 83 50  9d 9a 28 27  5a dc f6 fa  b1 32 86 51
| HASH(3) computed:  01 25 b3 bb
| state #8: install_ipsec_sa() for outbound only
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| could_route called for mytunnel (kind=CK_PERMANENT)
| state #8: now setting up incoming SA
| sr for #8: prospective erouted (eroute_owner: #0)
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| route_and_eroute with c: mytunnel (next: none) ero:mytunnel esr:{(nil)} ro:mytunnel rosr:{(nil)} and state: 8
| eroute_connection: between 10.0.2.15<->10.0.2.14
| creating SPD to 10.0.2.15->spi=00000000@10.0.2.14 proto=4
"mytunnel" #8: eroute_connection replace eroute 10.0.2.15/32:0 --0-> 10.0.2.14/32:0 => tun.0@10.0.2.14 succeeded
| command executing up-host
| executing up-host: 2>&1 PLUTO_VERB='up-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| route_and_eroute: firewall_notified: true
| route_and_eroute: instance "mytunnel", setting eroute_owner to #8 (was #0) (newest_ipsec_sa=#0)
| inI2: instance mytunnel[0], setting newest_ipsec_sa to #8 (was #0) (spd.eroute=#8)
| complete state transition with STF_OK
"mytunnel" #8: transition from state STATE_QUICK_R1 to state STATE_QUICK_R2
| deleting event for #8
| inserting event EVENT_SA_REPLACE, timeout in 28530 seconds for #8 
| event added after event EVENT_REINIT_SECRET
"mytunnel" #8: STATE_QUICK_R2: IPsec SA established tunnel mode {ESP=>0xe0bdca95 <0xa6ae52c6 xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
"mytunnel" #8: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 42 seconds
| next event EVENT_PENDING_DDNS in 42 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L
| *received 76 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:36
|   43 46 15 a5  3d 97 37 f2  f1 c9 8a ab  81 fa bc 40
|   08 10 05 01  47 0d da 09  00 00 00 4c  1a b3 c9 e9
|   0a 16 55 78  25 1d d2 f9  19 61 e5 dc  3a 8f d9 af
|   c2 47 ce c9  ae 56 55 5c  6a a0 0c 6e  f7 a5 01 ce
|   b9 35 20 53  0d e4 88 53  8a 2e 7c dc
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   43 46 15 a5  3d 97 37 f2
|    responder cookie:
|   f1 c9 8a ab  81 fa bc 40
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  47 0d da 09
|    length: 76
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_INFO (5), msgid: 1192090121
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  43 46 15 a5  3d 97 37 f2
| RCOOKIE:  f1 c9 8a ab  81 fa bc 40
| state hash entry 30
| peer and cookies match on #8, provided msgid 00000000 vs 77969dfa/00000000
| peer and cookies match on #7, provided msgid 00000000 vs 00000000/00000000
| p15 state object #7 found, in STATE_MAIN_R3
| processing connection mytunnel
| last Phase 1 IV:  f7 71 b5 d1  71 2f b9 d4  be 51 5f 07  e5 d7 1d 86
| current Phase 1 IV:  f7 71 b5 d1  71 2f b9 d4  be 51 5f 07  e5 d7 1d 86
| computed Phase 2 IV:
|   e9 f8 20 93  bc c0 6b 3f  5d 40 e1 bd  92 55 f1 41
|   64 97 78 67
| received encrypted packet from 10.0.2.14:500
| decrypting 48 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   0c 00 00 18  f4 0d 75 64  25 34 e3 13  49 c9 8c d0
|   b1 e4 53 80  1f b8 e8 c2  00 00 00 10  00 00 00 01
|   03 04 00 01  e0 bd ca 95  00 00 00 00  00 00 00 00
| next IV:  f7 a5 01 ce  b9 35 20 53  0d e4 88 53  8a 2e 7c dc
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x0
| ***parse ISAKMP Hash Payload:
|    length: 24
| got payload 0x1000(ISAKMP_NEXT_D) needed: 0x0 opt: 0x0
| ***parse ISAKMP Delete Payload:
|    length: 16
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 3
|    SPI size: 4
|    number of SPIs: 1
| removing 8 bytes of padding
| HASH(1) computed:
|   f4 0d 75 64  25 34 e3 13  49 c9 8c d0  b1 e4 53 80
|   1f b8 e8 c2
| received 'informational' message HASH(1) data ok
| processing connection mytunnel
"mytunnel" #7: received Delete SA(0xe0bdca95) payload: deleting IPSEC State #8
"mytunnel" #7: deleting state #8 (STATE_QUICK_R2)
| find_phase1_state: found SA #7 for conn 'mytunnel' in state STATE_MAIN_R3
| **emit ISAKMP Message:
|    initiator cookie:
|   43 46 15 a5  3d 97 37 f2
|    responder cookie:
|   f1 c9 8a ab  81 fa bc 40
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  ae b7 28 2f
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH(1) into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Delete Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 3
|    SPI size: 4
|    number of SPIs: 1
| emitting 4 raw bytes of delete payload into ISAKMP Delete Payload
| delete payload  a6 ae 52 c6
| emitting length of ISAKMP Delete Payload: 16
| HASH(1) computed:
|   ed 87 d4 21  a9 2a 37 d9  fb d0 86 8d  94 ac 53 a8
|   53 58 fc 2d
| last Phase 1 IV:  f7 71 b5 d1  71 2f b9 d4  be 51 5f 07  e5 d7 1d 86
| current Phase 1 IV:  f7 71 b5 d1  71 2f b9 d4  be 51 5f 07  e5 d7 1d 86
| computed Phase 2 IV:
|   7f 58 19 30  32 ec b6 aa  ce 1a 4b d4  cb ac f0 d6
|   c5 fe d4 93
| encrypting:
|   0c 00 00 18  ed 87 d4 21  a9 2a 37 d9  fb d0 86 8d
|   94 ac 53 a8  53 58 fc 2d  00 00 00 10  00 00 00 01
|   03 04 00 01  a6 ae 52 c6
| IV:
|   7f 58 19 30  32 ec b6 aa  ce 1a 4b d4  cb ac f0 d6
|   c5 fe d4 93
| unpadded size is: 40
| emitting 8 zero bytes of encryption padding into ISAKMP Message
| encrypting 48 using OAKLEY_AES_CBC
| next IV:  23 ad 55 ac  ab 01 05 2f  67 67 fa f2  7b 73 4f 7f
| emitting length of ISAKMP Message: 76
| sending 76 bytes for delete notify through enp0s3:500 to 10.0.2.14:500 (using #7)
|   43 46 15 a5  3d 97 37 f2  f1 c9 8a ab  81 fa bc 40
|   08 10 05 01  ae b7 28 2f  00 00 00 4c  b9 3c a1 17
|   d1 b1 98 d2  55 85 2a 9c  e7 94 71 58  99 96 cd 48
|   90 a6 b1 f6  c9 75 5c af  fe 90 02 99  23 ad 55 ac
|   ab 01 05 2f  67 67 fa f2  7b 73 4f 7f
| deleting event for #8
| no suspended cryptographic state for 8 
| removing state object #8
| ICOOKIE:  43 46 15 a5  3d 97 37 f2
| RCOOKIE:  f1 c9 8a ab  81 fa bc 40
| state hash entry 30
| command executing down-host
| executing down-host: 2>&1 PLUTO_VERB='down-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| request to replace with shunt a prospective erouted policy with netkey kernel --- experimental
| creating SPD to 10.0.2.15->spi=00000104@0.0.0.0 proto=61
| delete esp.e0bdca95@10.0.2.14
| creating SPD to 10.0.2.14->spi=00010000@10.0.2.15 proto=255
"mytunnel" #7: delete (half) inbound eroute 10.0.2.14/32:0 --0-> 10.0.2.15/32:0 => unk255.10000@10.0.2.15 succeeded
| delete esp.a6ae52c6@10.0.2.15
| del:  e0 bd ca 95
"mytunnel" #7: received and ignored informational message
| complete state transition with STF_IGNORE
"mytunnel" #7: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 36 seconds
| next event EVENT_PENDING_DDNS in 36 seconds
| deleting event for #8
| freeing state object #8
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\234
| *received 156 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:39
|   c4 a7 92 f2  1a a4 1b c0  00 00 00 00  00 00 00 00
|   01 10 02 00  00 00 00 00  00 00 00 9c  0d 00 00 5c
|   00 00 00 01  00 00 00 01  00 00 00 50  00 01 00 02
|   03 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  00 00 00 24  01 01 00 00  80 0b 00 01
|   80 0c 0e 10  80 01 00 07  80 02 00 02  80 03 00 01
|   80 04 00 02  80 0e 00 80  0d 00 00 10  4f 53 57 7e
|   7c 74 59 69  57 59 73 57  00 00 00 14  af ca d7 13
|   68 a1 f1 c9  6b 86 96 fc  77 57 01 00
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   c4 a7 92 f2  1a a4 1b c0
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 156
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| got payload 0x2(ISAKMP_NEXT_SA) needed: 0x2 opt: 0x2080
| ***parse ISAKMP Security Association Payload:
|    length: 92
|    DOI: ISAKMP_DOI_IPSEC
| got payload 0x2000(ISAKMP_NEXT_VID) needed: 0x0 opt: 0x2080
| ***parse ISAKMP Vendor ID Payload:
|    length: 16
| got payload 0x2000(ISAKMP_NEXT_VID) needed: 0x0 opt: 0x2080
| ***parse ISAKMP Vendor ID Payload:
|    length: 20
packet from 10.0.2.14:500: ignoring unknown Vendor ID payload [4f53577e7c74596957597357]
packet from 10.0.2.14:500: received Vendor ID payload [Dead Peer Detection]
| find_host_connection2 called from main_inI1_outR1, me=10.0.2.15:500 him=10.0.2.14:500 policy=/!IKEv1
| find_host_pair: looking for me=10.0.2.15:500 %address him=10.0.2.14:500 any-match 
| find_host_pair: comparing to me=10.0.2.15:500 %address him=10.0.2.14:500 
| find_host_pair: concluded with mytunnel
| found_host_pair_conn (find_host_connection2): 10.0.2.15:500 %address/10.0.2.14:500 -> hp:mytunnel 
| searching for connection with policy = /!IKEv1
| found policy = PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK (mytunnel)
| find_host_connection2 returns mytunnel (ike=none/none)
| creating state object #9 at 0x5650f3385130
| processing connection mytunnel
| ICOOKIE:  c4 a7 92 f2  1a a4 1b c0
| RCOOKIE:  77 87 1e af  e7 ae a4 3a
| state hash entry 24
| inserting state object #9 bucket: 24
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #9 (head of queue)
"mytunnel" #9: responding to Main Mode
| **emit ISAKMP Message:
|    initiator cookie:
|   c4 a7 92 f2  1a a4 1b c0
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Security Association Payload:
|    DOI: ISAKMP_DOI_IPSEC
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 80
|    proposal number: 0
|    protocol ID: PROTO_ISAKMP
|    SPI size: 0
|    number of transforms: 2
| *****parse ISAKMP Transform Payload (ISAKMP):
|    length: 36
|    transform number: 0
|    transform ID: KEY_IKE
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_LIFE_TYPE
|    length/value: 1
|    [1 is OAKLEY_LIFE_SECONDS]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_LIFE_DURATION
|    length/value: 3600
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_ENCRYPTION_ALGORITHM
|    length/value: 7
|    [7 is OAKLEY_AES_CBC]
| ike_alg_enc_ok(ealg=7,key_len=0): blocksize=16, keyminlen=128, keydeflen=128, keymaxlen=256, ret=1
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_HASH_ALGORITHM
|    length/value: 2
|    [2 is OAKLEY_SHA1]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_AUTHENTICATION_METHOD
|    length/value: 1
|    [1 is OAKLEY_PRESHARED_KEY]
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_KEY_LENGTH
|    length/value: 128
| ike_alg_enc_ok(ealg=7,key_len=128): blocksize=16, keyminlen=128, keydeflen=128, keymaxlen=256, ret=1
| Oakley Transform 0 accepted
| ****emit IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****emit ISAKMP Proposal Payload:
|    proposal number: 0
|    protocol ID: PROTO_ISAKMP
|    SPI size: 0
|    number of transforms: 1
| *****emit ISAKMP Transform Payload (ISAKMP):
|    transform number: 0
|    transform ID: KEY_IKE
| emitting 28 raw bytes of attributes into ISAKMP Transform Payload (ISAKMP)
| attributes  80 0b 00 01  80 0c 0e 10  80 01 00 07  80 02 00 02
| attributes  80 03 00 01  80 04 00 05  80 0e 00 80
| emitting length of ISAKMP Transform Payload (ISAKMP): 36
| emitting length of ISAKMP Proposal Payload: 44
| emitting length of ISAKMP Security Association Payload: 56
| ***emit ISAKMP Vendor ID Payload:
| emitting 12 raw bytes of Vendor ID into ISAKMP Vendor ID Payload
| Vendor ID  4f 53 57 5e  41 76 56 4b  68 7b 55 50
| emitting length of ISAKMP Vendor ID Payload: 16
| out_vendorid(): sending [Dead Peer Detection]
| ***emit ISAKMP Vendor ID Payload:
| emitting 16 raw bytes of V_ID into ISAKMP Vendor ID Payload
| V_ID  af ca d7 13  68 a1 f1 c9  6b 86 96 fc  77 57 01 00
| emitting length of ISAKMP Vendor ID Payload: 20
| sender checking NAT-T: 0 and 0
| emitting length of ISAKMP Message: 120
| peer supports dpd
| complete state transition with STF_OK
"mytunnel" #9: transition from state STATE_MAIN_R0 to state STATE_MAIN_R1
| deleting event for #9
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 120 bytes for STATE_MAIN_R0 through enp0s3:500 to 10.0.2.14:500 (using #9)
|   c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
|   01 10 02 00  00 00 00 00  00 00 00 78  0d 00 00 38
|   00 00 00 01  00 00 00 01  00 00 00 2c  00 01 00 01
|   00 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  0d 00 00 10  4f 53 57 5e  41 76 56 4b
|   68 7b 55 50  00 00 00 14  af ca d7 13  68 a1 f1 c9
|   6b 86 96 fc  77 57 01 00
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #9 (head of queue)
"mytunnel" #9: STATE_MAIN_R1: sent MR1, expecting MI2
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
"mytunnel" #9: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #9 (2020-01-27 11:23:39)
| next event EVENT_RETRANSMIT in 10 seconds for #9 (2020-01-27 11:23:39)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\364
| *received 244 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:40
|   00 00 00 00  00 00 00 00  77 87 1e af  e7 ae a4 3a
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
|   5b 38 e3 ab  b2 74 fe 1a  bd 84 94 22  ea d6 00 e0
|   fd 76 9b 96  77 cf b0 ca  23 27 9d f7  1f 54 7b 4a
|   db 55 e7 6f  e5 eb 8a 0d  29 28 97 48  15 84 ea b9
|   82 57 28 c1  2e 7e 16 45  87 65 9d cd  92 d5 89 fb
|   81 95 03 cf  26 18 a2 36  41 fa fa 40  3f 92 15 00
|   cc 78 da 78  ec 68 a9 ed  60 01 97 da  d7 f6 d7 48
|   33 b8 61 1f  52 d8 e4 60  8f 43 4d 0f  71 cb f5 61
|   19 ed 47 2d  34 d3 2e d3  20 5e 25 38  b5 25 14 97
|   8c 12 76 7c  6f 15 67 30  80 1e 64 c7  85 42 d0 5b
|   e2 54 76 2f  26 7c df b1  80 01 7e 26  a6 40 8b 34
|   79 92 30 85  66 07 44 59  8f 5c d0 2d  d3 44 da f4
|   2d 91 98 90  89 34 aa 81  45 96 cc 21  ef 61 85 59
|   00 00 00 14  5e 02 ad 14  85 f5 c3 a4  0e 59 8b 86
|   ab 5b cc 2e
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 244
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
packet from 10.0.2.14:500: Initiator Cookie must not be zero in phase 1 message
packet from 10.0.2.14:500: [PIET] I detected a ZERO initiator cookie... (ikev1.c)
packet from 10.0.2.14:500: sending notification INVALID_COOKIE to 10.0.2.14:500
| **emit ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Notification Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 0
|    Notify Message Type: INVALID_COOKIE
| emitting length of ISAKMP Notification Payload: 12
| emitting length of ISAKMP Message: 40
| sending 40 bytes for notification packet through enp0s3:500 to 10.0.2.14:500 (using #0)
|   00 00 00 00  00 00 00 00  77 87 1e af  e7 ae a4 3a
|   0b 10 05 00  00 00 00 00  00 00 00 28  00 00 00 0c
|   00 00 00 01  01 00 00 04
packet from 10.0.2.14:500: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 9 seconds for #9 (2020-01-27 11:23:40)
| next event EVENT_RETRANSMIT in 9 seconds for #9 (2020-01-27 11:23:40)
|  
| next event EVENT_RETRANSMIT in 0 seconds for #9 (2020-01-27 11:23:49)
| *time to handle event
| at 2020-01-27 11:23:49 handling event EVENT_RETRANSMIT
| event after this is EVENT_PENDING_DDNS in 23 seconds
| processing connection mytunnel
| handling event EVENT_RETRANSMIT for 10.0.2.14 "mytunnel" #9
| sending 120 bytes for EVENT_RETRANSMIT through enp0s3:500 to 10.0.2.14:500 (using #9)
|   c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
|   01 10 02 00  00 00 00 00  00 00 00 78  0d 00 00 38
|   00 00 00 01  00 00 00 01  00 00 00 2c  00 01 00 01
|   00 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  0d 00 00 10  4f 53 57 5e  41 76 56 4b
|   68 7b 55 50  00 00 00 14  af ca d7 13  68 a1 f1 c9
|   6b 86 96 fc  77 57 01 00
| inserting event EVENT_RETRANSMIT, timeout in 20 seconds for #9 (head of queue)
| next event EVENT_RETRANSMIT in 20 seconds for #9 (2020-01-27 11:23:49)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\364
| *received 244 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:49
|   c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
|   5b 38 e3 ab  b2 74 fe 1a  bd 84 94 22  ea d6 00 e0
|   fd 76 9b 96  77 cf b0 ca  23 27 9d f7  1f 54 7b 4a
|   db 55 e7 6f  e5 eb 8a 0d  29 28 97 48  15 84 ea b9
|   82 57 28 c1  2e 7e 16 45  87 65 9d cd  92 d5 89 fb
|   81 95 03 cf  26 18 a2 36  41 fa fa 40  3f 92 15 00
|   cc 78 da 78  ec 68 a9 ed  60 01 97 da  d7 f6 d7 48
|   33 b8 61 1f  52 d8 e4 60  8f 43 4d 0f  71 cb f5 61
|   19 ed 47 2d  34 d3 2e d3  20 5e 25 38  b5 25 14 97
|   8c 12 76 7c  6f 15 67 30  80 1e 64 c7  85 42 d0 5b
|   e2 54 76 2f  26 7c df b1  80 01 7e 26  a6 40 8b 34
|   79 92 30 85  66 07 44 59  8f 5c d0 2d  d3 44 da f4
|   2d 91 98 90  89 34 aa 81  45 96 cc 21  ef 61 85 59
|   00 00 00 14  5e 02 ad 14  85 f5 c3 a4  0e 59 8b 86
|   ab 5b cc 2e
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   c4 a7 92 f2  1a a4 1b c0
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 244
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  c4 a7 92 f2  1a a4 1b c0
| RCOOKIE:  77 87 1e af  e7 ae a4 3a
| state hash entry 24
| v1 peer and cookies match on #9, provided msgid 00000000 vs 00000000
| v1 state object #9 found, in STATE_MAIN_R1
| processing connection mytunnel
| got payload 0x10(ISAKMP_NEXT_KE) needed: 0x410 opt: 0x102080
| ***parse ISAKMP Key Exchange Payload:
|    length: 196
| got payload 0x400(ISAKMP_NEXT_NONCE) needed: 0x400 opt: 0x102080
| ***parse ISAKMP Nonce Payload:
|    length: 20
| DH public value received:
|   5b 38 e3 ab  b2 74 fe 1a  bd 84 94 22  ea d6 00 e0
|   fd 76 9b 96  77 cf b0 ca  23 27 9d f7  1f 54 7b 4a
|   db 55 e7 6f  e5 eb 8a 0d  29 28 97 48  15 84 ea b9
|   82 57 28 c1  2e 7e 16 45  87 65 9d cd  92 d5 89 fb
|   81 95 03 cf  26 18 a2 36  41 fa fa 40  3f 92 15 00
|   cc 78 da 78  ec 68 a9 ed  60 01 97 da  d7 f6 d7 48
|   33 b8 61 1f  52 d8 e4 60  8f 43 4d 0f  71 cb f5 61
|   19 ed 47 2d  34 d3 2e d3  20 5e 25 38  b5 25 14 97
|   8c 12 76 7c  6f 15 67 30  80 1e 64 c7  85 42 d0 5b
|   e2 54 76 2f  26 7c df b1  80 01 7e 26  a6 40 8b 34
|   79 92 30 85  66 07 44 59  8f 5c d0 2d  d3 44 da f4
|   2d 91 98 90  89 34 aa 81  45 96 cc 21  ef 61 85 59
| inI2: checking NAT-T: 0 and 0
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 17 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #9
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #9 
| event added after event EVENT_PENDING_PHASE2
| complete state transition with STF_SUSPEND
"mytunnel" #9: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 23 seconds
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing build_kenonce op id: 17
| next event EVENT_PENDING_DDNS in 23 seconds
! Local DH secret:
!   12 43 10 cb  4d b3 51 4c  2d ba 27 32  f9 5c 9e e2
!   c9 fe 92 3f  7a 64 5e db  2a 86 e3 95  f1 b7 8c 34
! Public DH value sent:
!   36 e7 43 99  b1 b7 a3 ee  10 e8 37 47  c4 48 2b fc
!   4f 74 c3 6c  55 c1 ea f5  a6 b5 84 68  f6 ec 93 e6
!   00 d0 33 3a  02 8e bf 07  58 d6 96 98  bb d8 f5 d5
!   6a e1 ab 62  43 89 d3 e9  a2 86 f7 19  53 6f 72 2f
!   45 e2 24 aa  f8 36 f4 4b  b7 4a 57 3c  eb 28 d7 8f
!   c5 c0 5e d2  98 1e b3 18  26 bc 22 01  64 11 3d 94
!   c1 82 b8 f1  da b9 23 95  b6 08 a1 d0  87 75 32 71
!   31 91 e7 68  22 ef 7d 44  a0 b2 f8 4e  5c 80 e0 48
!   ec 59 12 5b  7c b8 1a bb  29 fc e0 80  3c ba 9b b4
!   63 ea a7 62  df 8b 5a 32  51 f8 e3 c6  3e f9 55 6e
!   1e 56 a9 04  b1 74 ed e9  7e f7 bc f4  54 c3 3d 27
!   f2 24 5a 56  b8 75 3e 38  f7 bf 4f 5d  49 4a 94 54
! Generated nonce:
!   82 67 e6 c4  90 88 0c b6  5c f3 b6 d0  79 57 ac db
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#17
| calling callback function 0x5650f2303aa0
| main inI2_outR2: calculated ke+nonce, sending R2
| processing connection mytunnel
| **emit ISAKMP Message:
|    initiator cookie:
|   c4 a7 92 f2  1a a4 1b c0
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Key Exchange Payload:
| emitting 192 raw bytes of keyex value into ISAKMP Key Exchange Payload
| keyex value  36 e7 43 99  b1 b7 a3 ee  10 e8 37 47  c4 48 2b fc
| keyex value  4f 74 c3 6c  55 c1 ea f5  a6 b5 84 68  f6 ec 93 e6
| keyex value  00 d0 33 3a  02 8e bf 07  58 d6 96 98  bb d8 f5 d5
| keyex value  6a e1 ab 62  43 89 d3 e9  a2 86 f7 19  53 6f 72 2f
| keyex value  45 e2 24 aa  f8 36 f4 4b  b7 4a 57 3c  eb 28 d7 8f
| keyex value  c5 c0 5e d2  98 1e b3 18  26 bc 22 01  64 11 3d 94
| keyex value  c1 82 b8 f1  da b9 23 95  b6 08 a1 d0  87 75 32 71
| keyex value  31 91 e7 68  22 ef 7d 44  a0 b2 f8 4e  5c 80 e0 48
| keyex value  ec 59 12 5b  7c b8 1a bb  29 fc e0 80  3c ba 9b b4
| keyex value  63 ea a7 62  df 8b 5a 32  51 f8 e3 c6  3e f9 55 6e
| keyex value  1e 56 a9 04  b1 74 ed e9  7e f7 bc f4  54 c3 3d 27
| keyex value  f2 24 5a 56  b8 75 3e 38  f7 bf 4f 5d  49 4a 94 54
| emitting length of ISAKMP Key Exchange Payload: 196
| ***emit ISAKMP Nonce Payload:
| emitting 16 raw bytes of Nr into ISAKMP Nonce Payload
| Nr  82 67 e6 c4  90 88 0c b6  5c f3 b6 d0  79 57 ac db
| emitting length of ISAKMP Nonce Payload: 20
| emitting length of ISAKMP Message: 244
| main inI2_outR2: starting async DH calculation (group=5)
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| parent1 type: 7 group: 5 len: 2760 
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh+iv op on seq: 18 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #9
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #9 
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing compute dh+iv op id: 18
| event added after event EVENT_PENDING_PHASE2
| started dh_secretiv, returned: stf=STF_SUSPEND 
! peer's g:   5b 38 e3 ab  b2 74 fe 1a  bd 84 94 22  ea d6 00 e0
! peer's g:   fd 76 9b 96  77 cf b0 ca  23 27 9d f7  1f 54 7b 4a
| complete state transition with STF_OK
"mytunnel" #9: transition from state STATE_MAIN_R1 to state STATE_MAIN_R2
! peer's g:   db 55 e7 6f  e5 eb 8a 0d  29 28 97 48  15 84 ea b9
! peer's g:   82 57 28 c1  2e 7e 16 45  87 65 9d cd  92 d5 89 fb
| deleting event for #9
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 244 bytes for STATE_MAIN_R1 through enp0s3:500 to 10.0.2.14:500 (using #9)
! peer's g:   81 95 03 cf  26 18 a2 36  41 fa fa 40  3f 92 15 00
|   c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
|   36 e7 43 99  b1 b7 a3 ee  10 e8 37 47  c4 48 2b fc
! peer's g:   cc 78 da 78  ec 68 a9 ed  60 01 97 da  d7 f6 d7 48
|   4f 74 c3 6c  55 c1 ea f5  a6 b5 84 68  f6 ec 93 e6
|   00 d0 33 3a  02 8e bf 07  58 d6 96 98  bb d8 f5 d5
! peer's g:   33 b8 61 1f  52 d8 e4 60  8f 43 4d 0f  71 cb f5 61
|   6a e1 ab 62  43 89 d3 e9  a2 86 f7 19  53 6f 72 2f
|   45 e2 24 aa  f8 36 f4 4b  b7 4a 57 3c  eb 28 d7 8f
! peer's g:   19 ed 47 2d  34 d3 2e d3  20 5e 25 38  b5 25 14 97
|   c5 c0 5e d2  98 1e b3 18  26 bc 22 01  64 11 3d 94
|   c1 82 b8 f1  da b9 23 95  b6 08 a1 d0  87 75 32 71
! peer's g:   8c 12 76 7c  6f 15 67 30  80 1e 64 c7  85 42 d0 5b
|   31 91 e7 68  22 ef 7d 44  a0 b2 f8 4e  5c 80 e0 48
|   ec 59 12 5b  7c b8 1a bb  29 fc e0 80  3c ba 9b b4
! peer's g:   e2 54 76 2f  26 7c df b1  80 01 7e 26  a6 40 8b 34
|   63 ea a7 62  df 8b 5a 32  51 f8 e3 c6  3e f9 55 6e
|   1e 56 a9 04  b1 74 ed e9  7e f7 bc f4  54 c3 3d 27
! peer's g:   79 92 30 85  66 07 44 59  8f 5c d0 2d  d3 44 da f4
|   f2 24 5a 56  b8 75 3e 38  f7 bf 4f 5d  49 4a 94 54
|   00 00 00 14  82 67 e6 c4  90 88 0c b6  5c f3 b6 d0
! peer's g:   2d 91 98 90  89 34 aa 81  45 96 cc 21  ef 61 85 59
|   79 57 ac db
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #9 (head of queue)
! long term secret:   12 43 10 cb  4d b3 51 4c  2d ba 27 32  f9 5c 9e e2
"mytunnel" #9: STATE_MAIN_R2: sent MR2, expecting MI3
| modecfg pull: noquirk policy:push not-client
! long term secret:   c9 fe 92 3f  7a 64 5e db  2a 86 e3 95  f1 b7 8c 34
| phase 1 is done, looking for phase 2 to unpend
| * processed 1 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #9 (2020-01-27 11:23:49)
| next event EVENT_RETRANSMIT in 10 seconds for #9 (2020-01-27 11:23:49)
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP1536): 1745 usec
! DH shared-secret:
!   52 0f d6 92  65 d3 6e c0  28 05 4d d9  67 32 82 d9
!   71 c8 ee 7a  b6 d6 a5 93  4c 42 c3 2f  cd ae 50 68
!   a7 96 78 5c  a9 fa 77 9e  42 bb 61 48  fc db 6a 20
!   56 79 d5 1d  a5 3f 42 26  a2 95 04 df  6b 01 c0 12
!   b1 11 d5 a2  e3 24 54 b1  66 5c d4 6d  6f 2d 26 33
!   fe c6 26 41  82 52 14 9a  1c e1 0c da  08 0d 6c 81
!   a0 87 c9 2d  74 19 a3 96  e1 2a 67 09  83 2a 9f d1
!   56 f2 b9 c4  d0 52 0a c9  d0 29 ac d9  08 d5 63 df
!   be a0 60 a7  70 de bc 14  a0 af 2e 12  fc 25 5c 33
!   85 3b 87 ea  d2 e9 30 58  f8 33 f6 54  f4 fa de 59
!   3a d7 81 90  e7 12 58 0d  ac 50 b6 39  44 9c 8a 20
!   a1 60 59 36  aa a4 1e ea  ab 1b 7b 58  33 52 36 94
! Skey inputs (PSK+NI+NR)
! ni:   5e 02 ad 14  85 f5 c3 a4  0e 59 8b 86  ab 5b cc 2e
! nr:   82 67 e6 c4  90 88 0c b6  5c f3 b6 d0  79 57 ac db
! keyid:   64 f9 b4 7b  19 1c 5d 17  9f 1e 11 0f  2c 70 60 aa
! keyid:   d8 75 2b 8d
! NSS: end of key computation 
! DH_i:  5b 38 e3 ab  b2 74 fe 1a  bd 84 94 22  ea d6 00 e0
! DH_i:  fd 76 9b 96  77 cf b0 ca  23 27 9d f7  1f 54 7b 4a
! DH_i:  db 55 e7 6f  e5 eb 8a 0d  29 28 97 48  15 84 ea b9
! DH_i:  82 57 28 c1  2e 7e 16 45  87 65 9d cd  92 d5 89 fb
! DH_i:  81 95 03 cf  26 18 a2 36  41 fa fa 40  3f 92 15 00
! DH_i:  cc 78 da 78  ec 68 a9 ed  60 01 97 da  d7 f6 d7 48
! DH_i:  33 b8 61 1f  52 d8 e4 60  8f 43 4d 0f  71 cb f5 61
! DH_i:  19 ed 47 2d  34 d3 2e d3  20 5e 25 38  b5 25 14 97
! DH_i:  8c 12 76 7c  6f 15 67 30  80 1e 64 c7  85 42 d0 5b
! DH_i:  e2 54 76 2f  26 7c df b1  80 01 7e 26  a6 40 8b 34
! DH_i:  79 92 30 85  66 07 44 59  8f 5c d0 2d  d3 44 da f4
! DH_i:  2d 91 98 90  89 34 aa 81  45 96 cc 21  ef 61 85 59
! DH_r:  36 e7 43 99  b1 b7 a3 ee  10 e8 37 47  c4 48 2b fc
! DH_r:  4f 74 c3 6c  55 c1 ea f5  a6 b5 84 68  f6 ec 93 e6
! DH_r:  00 d0 33 3a  02 8e bf 07  58 d6 96 98  bb d8 f5 d5
! DH_r:  6a e1 ab 62  43 89 d3 e9  a2 86 f7 19  53 6f 72 2f
! DH_r:  45 e2 24 aa  f8 36 f4 4b  b7 4a 57 3c  eb 28 d7 8f
! DH_r:  c5 c0 5e d2  98 1e b3 18  26 bc 22 01  64 11 3d 94
! DH_r:  c1 82 b8 f1  da b9 23 95  b6 08 a1 d0  87 75 32 71
! DH_r:  31 91 e7 68  22 ef 7d 44  a0 b2 f8 4e  5c 80 e0 48
! DH_r:  ec 59 12 5b  7c b8 1a bb  29 fc e0 80  3c ba 9b b4
! DH_r:  63 ea a7 62  df 8b 5a 32  51 f8 e3 c6  3e f9 55 6e
! DH_r:  1e 56 a9 04  b1 74 ed e9  7e f7 bc f4  54 c3 3d 27
! DH_r:  f2 24 5a 56  b8 75 3e 38  f7 bf 4f 5d  49 4a 94 54
! end of IV generation 
! Skeyid:    64 f9 b4 7b  19 1c 5d 17  9f 1e 11 0f  2c 70 60 aa
! Skeyid:    d8 75 2b 8d
! Skeyid_d:  53 27 18 92  74 16 20 ee  94 9f f8 dc  da e7 d9 ac
! Skeyid_d:  2f 8c 3d be
! Skeyid_a:  ef 16 bf aa  5c a0 9e 5f  e3 b5 36 be  6a 4f 5a ae
! Skeyid_a:  78 a8 34 92
! Skeyid_e:  90 5d 4a 3b  04 36 f1 1c  d2 b8 cd 23  24 e7 17 ac
! Skeyid_e:  24 a1 3c 42
! enc key:  90 5d 4a 3b  04 36 f1 1c  d2 b8 cd 23  24 e7 17 ac
! IV:  85 d3 d8 2e  4d 20 09 0a  df 43 2b 18  8f ef d7 12
! IV:  4d 94 4c f8
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#18
| calling callback function 0x5650f2303250
| main inI2_outR2: calculated DH finished
| processing connection mytunnel
| WARNING: finish_dh_secretiv:160: encryptor 'aes' expects keylen 16/128, SA #9 INITIATOR keylen is 20
| WARNING: finish_dh_secretiv:160: encryptor 'aes' expects keylen 16/128, SA #9 RESPONDER keylen is 0
| WARNING: main_inI2_outR2_calcdone:1230: encryptor 'aes' expects keylen 16/128, SA #9 INITIATOR keylen is 20
| WARNING: main_inI2_outR2_calcdone:1230: encryptor 'aes' expects keylen 16/128, SA #9 RESPONDER keylen is 0
| * processed 1 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #9 (2020-01-27 11:23:49)
| next event EVENT_RETRANSMIT in 10 seconds for #9 (2020-01-27 11:23:49)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L
| *received 76 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:50
|   c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
|   05 10 02 01  00 00 00 00  00 00 00 4c  9e 91 27 59
|   a7 c0 d7 c9  62 ad d0 a7  81 e6 e8 83  d2 82 9d b9
|   bc 4c 09 52  49 db 72 46  c1 2b 1e d1  ef 74 48 c4
|   4f c5 45 75  be 04 00 54  2b fd 24 86
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   c4 a7 92 f2  1a a4 1b c0
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  00 00 00 00
|    length: 76
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  c4 a7 92 f2  1a a4 1b c0
| RCOOKIE:  77 87 1e af  e7 ae a4 3a
| state hash entry 24
| v1 peer and cookies match on #9, provided msgid 00000000 vs 00000000
| v1 state object #9 found, in STATE_MAIN_R2
| processing connection mytunnel
| received encrypted packet from 10.0.2.14:500
| decrypting 48 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   08 00 00 0c  01 00 00 00  0a 00 02 0e  00 00 00 18
|   4a 8f e8 31  44 03 c9 c9  63 da 35 97  42 1c b1 cf
|   d8 49 6c a3  00 00 00 00  00 00 00 00  00 00 00 00
| next IV:  ef 74 48 c4  4f c5 45 75  be 04 00 54  2b fd 24 86
| got payload 0x20(ISAKMP_NEXT_ID) needed: 0x120 opt: 0x2080
| ***parse ISAKMP Identification Payload:
|    length: 12
|    ID type: ID_IPV4_ADDR
|    DOI specific A: 0
|    DOI specific B: 0
|      obj:   0a 00 02 0e
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x2080
| ***parse ISAKMP Hash Payload:
|    length: 24
| removing 12 bytes of padding
"mytunnel" #9: Main mode peer ID is ID_IPV4_ADDR: '10.0.2.14'
| refine_connection: starting with mytunnel
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
|    match_id a=10.0.2.14
|             b=10.0.2.14
|    results  matched
|   trusted_ca_by_name called with a=(empty) b=(empty)
| refine_connection: checking mytunnel against mytunnel, best=(none) with match=1(id=1/ca=1/reqca=1)
| refine_connection: checked mytunnel against mytunnel, now for see if best
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| offered CA: '%none'
| hashing 88 bytes of SA
| authentication succeeded
| thinking about whether to send my certificate:
|   I have RSA key: OAKLEY_PRESHARED_KEY cert.type: CERT_NONE 
|   sendcert: CERT_SENDIFASKED and I did not get a certificate request 
|   so do not send cert.
| I did not send a certificate because digital signatures are not being used. (PSK)
| **emit ISAKMP Message:
|    initiator cookie:
|   c4 a7 92 f2  1a a4 1b c0
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  00 00 00 00
| ***emit ISAKMP Identification Payload (IPsec DOI):
|    ID type: ID_IPV4_ADDR
|    Protocol ID: 0
|    port: 0
| emitting 4 raw bytes of my identity into ISAKMP Identification Payload (IPsec DOI)
| my identity  0a 00 02 0f
| emitting length of ISAKMP Identification Payload (IPsec DOI): 12
| hashing 88 bytes of SA
| ***emit ISAKMP Hash Payload:
| emitting 20 raw bytes of HASH_R into ISAKMP Hash Payload
| HASH_R  7b 02 d6 a8  e6 43 07 12  cd fa d2 d2  8e c1 33 f7
| HASH_R  17 cc ed d3
| emitting length of ISAKMP Hash Payload: 24
| out_vendorid(): sending [CAN-IKEv2]
| ***emit ISAKMP Vendor ID Payload:
| emitting 5 raw bytes of V_ID into ISAKMP Vendor ID Payload
| V_ID  49 4b 45 76  32
| emitting length of ISAKMP Vendor ID Payload: 9
| encrypting:
|   08 00 00 0c  01 00 00 00  0a 00 02 0f  0d 00 00 18
|   7b 02 d6 a8  e6 43 07 12  cd fa d2 d2  8e c1 33 f7
|   17 cc ed d3  00 00 00 09  49 4b 45 76  32
| IV:
|   ef 74 48 c4  4f c5 45 75  be 04 00 54  2b fd 24 86
| unpadded size is: 45
| emitting 3 zero bytes of encryption padding into ISAKMP Message
| encrypting 48 using OAKLEY_AES_CBC
| next IV:  10 0d cb b9  c7 c0 81 25  42 6e e1 fc  d5 af 8a 24
| emitting length of ISAKMP Message: 76
| last encrypted block of Phase 1:
|   10 0d cb b9  c7 c0 81 25  42 6e e1 fc  d5 af 8a 24
| complete state transition with STF_OK
"mytunnel" #9: transition from state STATE_MAIN_R2 to state STATE_MAIN_R3
| deleting event for #9
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 76 bytes for STATE_MAIN_R2 through enp0s3:500 to 10.0.2.14:500 (using #9)
|   c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
|   05 10 02 01  00 00 00 00  00 00 00 4c  60 ad 62 32
|   e4 ee bd 24  53 ab d7 d8  6a fe e6 0f  3e 97 0a 58
|   a3 5f 38 f9  6a 8a 86 15  b9 a3 2a 04  10 0d cb b9
|   c7 c0 81 25  42 6e e1 fc  d5 af 8a 24
| inserting event EVENT_SA_REPLACE, timeout in 3330 seconds for #9 
| event added after event EVENT_REINIT_SECRET
"mytunnel" #9: STATE_MAIN_R3: sent MR3, ISAKMP SA established {auth=OAKLEY_PRESHARED_KEY oursig= theirsig= cipher=aes_128 prf=oakley_sha group=modp1536}
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| unpending state #9
"mytunnel" #9: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 22 seconds
| next event EVENT_PENDING_DDNS in 22 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L\001
| *received 332 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:51
|   c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
|   08 10 20 01  b5 89 9f 3b  00 00 01 4c  d6 2f 44 78
|   05 85 26 dc  da 71 ad 11  97 05 ee 6d  aa 8d 6f 94
|   51 84 f2 6b  87 fa 91 6a  92 78 c5 7c  b3 36 36 3f
|   b3 76 ba 87  3f 5f 31 e2  6b 3d 16 74  93 99 0e c4
|   fb 02 47 c2  5c 3a 23 39  f2 6e dd 62  a4 b0 5b e8
|   94 d7 e1 ac  c7 36 01 e8  9f 1b e4 50  c3 1e 7a 00
|   55 6b d5 4a  66 1c bf 1c  83 5b 35 ab  ad 91 5a 19
|   46 67 2c c0  d6 2c 7c 1c  cd 24 89 d8  d1 ae 94 3a
|   53 1b b8 49  a9 ab bb 70  5c 0c 91 24  70 ae d0 dd
|   0e 21 2b 85  ca 38 c0 ec  14 cb 3e b2  1f 66 55 5f
|   e3 6c 9d 5e  f4 61 60 85  51 77 38 26  32 69 a9 a8
|   38 35 e8 a1  40 ff fd 9d  ca 3d 66 07  70 56 f0 ea
|   c9 0d 7b c6  82 7e 9f 9d  38 57 a9 f1  f5 51 82 c6
|   be 4d 7c 83  16 72 5a 5e  62 66 6b d6  05 5b 9d 60
|   d7 a8 2a ae  c0 9e 52 68  81 5d 97 cc  3b 51 92 b9
|   d3 89 83 d2  72 53 34 55  ab 56 3b 79  5c a2 bb b3
|   e1 7a ad e8  25 c8 e3 0e  94 10 d8 18  a0 bf e5 62
|   72 ec 44 14  99 cf ef aa  16 dc d5 11  cc d7 04 a8
|   3d c5 fa 52  83 6a 01 00  20 a5 cc bc  a9 6b 9f 75
|   ce bc e2 a7  52 23 75 75  c4 03 5e 0a
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   c4 a7 92 f2  1a a4 1b c0
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  b5 89 9f 3b
|    length: 332
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_QUICK (32), msgid: 3045695291
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  c4 a7 92 f2  1a a4 1b c0
| RCOOKIE:  77 87 1e af  e7 ae a4 3a
| state hash entry 24
| v1 peer and cookies match on #9, provided msgid b5899f3b vs 00000000
| v1 state object not found
| ICOOKIE:  c4 a7 92 f2  1a a4 1b c0
| RCOOKIE:  77 87 1e af  e7 ae a4 3a
| state hash entry 24
| v1 peer and cookies match on #9, provided msgid 00000000 vs 00000000
| v1 state object #9 found, in STATE_MAIN_R3
| processing connection mytunnel
| last Phase 1 IV:  10 0d cb b9  c7 c0 81 25  42 6e e1 fc  d5 af 8a 24
| current Phase 1 IV:  10 0d cb b9  c7 c0 81 25  42 6e e1 fc  d5 af 8a 24
| computed Phase 2 IV:
|   75 03 c2 74  70 9c 38 55  ff 12 33 37  8a 3d 1e b5
|   80 10 13 6d
| received encrypted packet from 10.0.2.14:500
| decrypting 304 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   01 00 00 18  e5 ec 5b ab  47 da 67 42  39 32 a8 dd
|   7d 85 e9 d3  21 1b fb e6  0a 00 00 38  00 00 00 01
|   00 00 00 01  00 00 00 2c  00 03 04 01  db 49 65 49
|   00 00 00 20  00 0c 00 00  80 03 00 05  80 04 00 01
|   80 01 00 01  80 02 70 80  80 05 00 02  80 06 00 80
|   04 00 00 14  f8 97 46 c9  82 b8 0e 8d  74 88 a8 9f
|   7d 1b 7e 49  00 00 00 c4  53 12 d0 46  c8 1f 1e fa
|   f7 c1 fc cf  73 06 13 03  30 79 2b 13  fd 2f a7 66
|   42 69 dd 57  89 44 54 35  af f0 d0 c6  21 8b 8d c3
|   9a b4 d2 4e  72 1f 73 5b  e5 d2 3f c8  40 96 bd 35
|   db fb 45 fd  d1 cc 65 01  97 3f db 64  11 99 d2 94
|   25 2e f7 a1  b3 50 52 71  97 5f 03 1b  64 64 d6 d9
|   b2 50 ca 48  1f 49 e7 22  78 f5 ad e8  b5 fc fc d3
|   22 81 32 c5  2f e1 5e 29  4d e7 3e 3c  50 25 c9 90
|   18 f2 cc bb  4f 44 11 a1  d5 a6 2c d4  51 0f 35 94
|   d9 e6 88 25  11 20 58 7b  fd 0a 26 92  24 ec 5b 67
|   82 1d fb 75  11 99 f7 f2  c5 61 87 17  40 8b 5c 62
|   f0 69 0a 6e  b2 14 11 41  ea 27 5a 99  94 2a 58 32
|   60 f6 c5 cb  ab d9 41 a7  00 00 00 00  00 00 00 00
| next IV:  a9 6b 9f 75  ce bc e2 a7  52 23 75 75  c4 03 5e 0a
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x502 opt: 0x200030
| ***parse ISAKMP Hash Payload:
|    length: 24
| got payload 0x2(ISAKMP_NEXT_SA) needed: 0x402 opt: 0x200030
| ***parse ISAKMP Security Association Payload:
|    length: 56
|    DOI: ISAKMP_DOI_IPSEC
| got payload 0x400(ISAKMP_NEXT_NONCE) needed: 0x400 opt: 0x200030
| ***parse ISAKMP Nonce Payload:
|    length: 20
| got payload 0x10(ISAKMP_NEXT_KE) needed: 0x0 opt: 0x200030
| ***parse ISAKMP Key Exchange Payload:
|    length: 196
| removing 8 bytes of padding
| HASH(1) computed:
|   e5 ec 5b ab  47 da 67 42  39 32 a8 dd  7d 85 e9 d3
|   21 1b fb e6
"mytunnel" #9: the peer proposed: 10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0
| find_client_connection starting with mytunnel
|   looking for 10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0
|   concrete checking against sr#0 10.0.2.15/32 -> 10.0.2.14/32
| client wildcard: no  port wildcard: no  virtual: no
| duplicating state object #9
| creating state object #10 at 0x5650f3386270
| processing connection mytunnel
| ICOOKIE:  c4 a7 92 f2  1a a4 1b c0
| RCOOKIE:  77 87 1e af  e7 ae a4 3a
| state hash entry 24
| inserting state object #10 bucket: 24
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #10 (head of queue)
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 44
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| parsing 4 raw bytes of ISAKMP Proposal Payload into SPI
| SPI  db 49 65 49
| *****parse ISAKMP Transform Payload (ESP):
|    length: 32
|    transform number: 0
|    transform ID: ESP_AES
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: ENCAPSULATION_MODE
|    length/value: 1
|    [1 is ENCAPSULATION_MODE_TUNNEL]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_TYPE
|    length/value: 1
|    [1 is SA_LIFE_TYPE_SECONDS]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_DURATION
|    length/value: 28800
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: AUTH_ALGORITHM
|    length/value: 2
|    [2 is AUTH_ALGORITHM_HMAC_SHA1]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: KEY_LENGTH
|    length/value: 128
| kernel_alg_esp_enc_ok(12,128): alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| DH public value received:
|   53 12 d0 46  c8 1f 1e fa  f7 c1 fc cf  73 06 13 03
|   30 79 2b 13  fd 2f a7 66  42 69 dd 57  89 44 54 35
|   af f0 d0 c6  21 8b 8d c3  9a b4 d2 4e  72 1f 73 5b
|   e5 d2 3f c8  40 96 bd 35  db fb 45 fd  d1 cc 65 01
|   97 3f db 64  11 99 d2 94  25 2e f7 a1  b3 50 52 71
|   97 5f 03 1b  64 64 d6 d9  b2 50 ca 48  1f 49 e7 22
|   78 f5 ad e8  b5 fc fc d3  22 81 32 c5  2f e1 5e 29
|   4d e7 3e 3c  50 25 c9 90  18 f2 cc bb  4f 44 11 a1
|   d5 a6 2c d4  51 0f 35 94  d9 e6 88 25  11 20 58 7b
|   fd 0a 26 92  24 ec 5b 67  82 1d fb 75  11 99 f7 f2
|   c5 61 87 17  40 8b 5c 62  f0 69 0a 6e  b2 14 11 41
|   ea 27 5a 99  94 2a 58 32  60 f6 c5 cb  ab d9 41 a7
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 19 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #10
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing build_kenonce op id: 19
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #10 
| event added after event EVENT_PENDING_PHASE2
! Local DH secret:
| complete state transition with STF_SUSPEND
"mytunnel" #10: [PIET]   read_packet returned false...(demux.c)
!   d0 4b d7 7c  db 5b c5 ce  49 d4 83 dd  28 82 bc 50
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
!   f8 5a 8d 63  78 a2 1e ac  b4 33 e6 2b  1a db 29 22
| next event EVENT_PENDING_DDNS in 21 seconds
| next event EVENT_PENDING_DDNS in 21 seconds
! Public DH value sent:
!   7b 80 1a ea  58 e6 c4 0a  b6 92 12 d8  83 ca 38 45
!   80 44 7c 9d  ec 5b 02 8c  29 7f a2 9d  13 fb bf f0
!   cd 62 91 33  9e cb fd 37  17 db 97 85  72 46 ac 5f
!   43 6a cf e3  1b 36 82 89  16 80 b8 1e  05 be c0 1e
!   6d e8 42 ff  2c 7c c9 6d  2c a0 67 b3  75 cf ac ec
!   7c ed 3f 62  56 57 c5 35  b9 73 fd b2  a5 3a 1f cf
!   11 90 9c d5  e9 ed 5d 08  ea c8 87 3e  0d f2 cb 6e
!   fb 4b ef c5  3d 29 6e ff  63 14 f0 b5  c9 de 17 2c
!   cd 31 c9 48  ac a1 95 f3  20 37 db c1  d6 87 00 88
!   30 0c ab 39  a8 4d 20 52  e8 24 dc 3d  43 fa 54 e9
!   e6 b4 9f 25  68 44 6d 09  6e b5 a3 8e  54 ac 5e 68
!   ef 6e f2 97  aa 7f c8 f7  27 cf 27 b9  af 29 81 7c
! Generated nonce:
!   4a 7b 01 a9  73 98 b0 bf  bd b3 bf 23  03 ad eb 92
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#19
| calling callback function 0x5650f230ae60
| quick inI1_outR1: calculated ke+nonce, calculating DH
| processing connection mytunnel
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh(p2) op on seq: 20 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #10
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #10 
! helper 0 read 2752+4/2760 bytesfd: 8
| event added after event EVENT_PENDING_PHASE2
| * processed 1 messages from cryptographic helpers 
! helper 0 doing compute dh(p2) op id: 20
| next event EVENT_PENDING_DDNS in 21 seconds
| next event EVENT_PENDING_DDNS in 21 seconds
! peer's g:   53 12 d0 46  c8 1f 1e fa  f7 c1 fc cf  73 06 13 03
! peer's g:   30 79 2b 13  fd 2f a7 66  42 69 dd 57  89 44 54 35
! peer's g:   af f0 d0 c6  21 8b 8d c3  9a b4 d2 4e  72 1f 73 5b
! peer's g:   e5 d2 3f c8  40 96 bd 35  db fb 45 fd  d1 cc 65 01
! peer's g:   97 3f db 64  11 99 d2 94  25 2e f7 a1  b3 50 52 71
! peer's g:   97 5f 03 1b  64 64 d6 d9  b2 50 ca 48  1f 49 e7 22
! peer's g:   78 f5 ad e8  b5 fc fc d3  22 81 32 c5  2f e1 5e 29
! peer's g:   4d e7 3e 3c  50 25 c9 90  18 f2 cc bb  4f 44 11 a1
! peer's g:   d5 a6 2c d4  51 0f 35 94  d9 e6 88 25  11 20 58 7b
! peer's g:   fd 0a 26 92  24 ec 5b 67  82 1d fb 75  11 99 f7 f2
! peer's g:   c5 61 87 17  40 8b 5c 62  f0 69 0a 6e  b2 14 11 41
! peer's g:   ea 27 5a 99  94 2a 58 32  60 f6 c5 cb  ab d9 41 a7
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP1536): 438 usec
! DH shared-secret:
!   bf ff 15 91  d9 8d cf 9f  45 8d a9 83  4a f8 48 49
!   55 14 d0 e3  5b 0f 4c 11  68 bc 7b 30  f6 37 c9 cd
!   68 31 ff 08  9c 20 3f 9f  1f ad e1 c4  23 1b d9 38
!   e8 65 6b 88  b6 b6 8d 75  72 6c 56 ff  ab 2c dc 04
!   29 a2 18 ee  8a 4c cf ff  67 b0 58 1f  60 b8 9b 1e
!   35 26 89 78  da 1b 6e 7f  0c dd 28 fd  94 3d cf 86
!   e3 b4 bb 46  19 d2 1f c7  27 8d 0c e8  0a f9 7e 1c
!   ee 4e 2e ce  bd 01 e8 d2  6d 2b 87 19  1c be 2a 96
!   44 8a 29 ab  1d 9d 20 9e  c9 5b b9 5e  c8 29 8b ce
!   be 91 18 01  0b 91 ad 30  ba 48 9c be  57 43 a7 0b
!   46 0e ae 13  ed e2 1b de  11 7d c8 e9  60 a3 80 ad
!   fe f5 ff 2d  09 c6 15 c5  37 09 a7 8a  15 4f 06 54
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#20
| calling callback function 0x5650f230b210
| quick inI1_outR1: calculated DH, sending R1
| processing connection mytunnel
| **emit ISAKMP Message:
|    initiator cookie:
|   c4 a7 92 f2  1a a4 1b c0
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  b5 89 9f 3b
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Security Association Payload:
|    DOI: ISAKMP_DOI_IPSEC
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 44
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| parsing 4 raw bytes of ISAKMP Proposal Payload into SPI
| SPI  db 49 65 49
| *****parse ISAKMP Transform Payload (ESP):
|    length: 32
|    transform number: 0
|    transform ID: ESP_AES
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: ENCAPSULATION_MODE
|    length/value: 1
|    [1 is ENCAPSULATION_MODE_TUNNEL]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_TYPE
|    length/value: 1
|    [1 is SA_LIFE_TYPE_SECONDS]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_DURATION
|    length/value: 28800
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: AUTH_ALGORITHM
|    length/value: 2
|    [2 is AUTH_ALGORITHM_HMAC_SHA1]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: KEY_LENGTH
|    length/value: 128
| kernel_alg_esp_enc_ok(12,128): alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| ****emit IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****emit ISAKMP Proposal Payload:
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| netlink_get_spi: allocated 0xa94938f4 for esp.0@10.0.2.15
| emitting 4 raw bytes of SPI into ISAKMP Proposal Payload
| SPI  a9 49 38 f4
| *****emit ISAKMP Transform Payload (ESP):
|    transform number: 0
|    transform ID: ESP_AES
| emitting 24 raw bytes of attributes into ISAKMP Transform Payload (ESP)
| attributes  80 03 00 05  80 04 00 01  80 01 00 01  80 02 70 80
| attributes  80 05 00 02  80 06 00 80
| emitting length of ISAKMP Transform Payload (ESP): 32
| emitting length of ISAKMP Proposal Payload: 44
| emitting length of ISAKMP Security Association Payload: 56
"mytunnel" #10: responding to Quick Mode proposal {msgid:3b9f89b5}
"mytunnel" #10:     us: 10.0.2.15
"mytunnel" #10:   them: 10.0.2.14
| ***emit ISAKMP Nonce Payload:
| emitting 16 raw bytes of Nr into ISAKMP Nonce Payload
| Nr  4a 7b 01 a9  73 98 b0 bf  bd b3 bf 23  03 ad eb 92
| emitting length of ISAKMP Nonce Payload: 20
| ***emit ISAKMP Key Exchange Payload:
| emitting 192 raw bytes of keyex value into ISAKMP Key Exchange Payload
| keyex value  7b 80 1a ea  58 e6 c4 0a  b6 92 12 d8  83 ca 38 45
| keyex value  80 44 7c 9d  ec 5b 02 8c  29 7f a2 9d  13 fb bf f0
| keyex value  cd 62 91 33  9e cb fd 37  17 db 97 85  72 46 ac 5f
| keyex value  43 6a cf e3  1b 36 82 89  16 80 b8 1e  05 be c0 1e
| keyex value  6d e8 42 ff  2c 7c c9 6d  2c a0 67 b3  75 cf ac ec
| keyex value  7c ed 3f 62  56 57 c5 35  b9 73 fd b2  a5 3a 1f cf
| keyex value  11 90 9c d5  e9 ed 5d 08  ea c8 87 3e  0d f2 cb 6e
| keyex value  fb 4b ef c5  3d 29 6e ff  63 14 f0 b5  c9 de 17 2c
| keyex value  cd 31 c9 48  ac a1 95 f3  20 37 db c1  d6 87 00 88
| keyex value  30 0c ab 39  a8 4d 20 52  e8 24 dc 3d  43 fa 54 e9
| keyex value  e6 b4 9f 25  68 44 6d 09  6e b5 a3 8e  54 ac 5e 68
| keyex value  ef 6e f2 97  aa 7f c8 f7  27 cf 27 b9  af 29 81 7c
| emitting length of ISAKMP Key Exchange Payload: 196
| HASH(2) computed:
|   f6 06 6f 65  de d2 73 36  21 55 8d f9  ab 24 52 6d
|   7d f9 82 7e
| compute_proto_keymat:needed_len (after ESP enc)=16
| compute_proto_keymat:needed_len (after ESP auth)=36
| ESP KEYMAT 
|   KEYMAT computed:
|   2b 50 e9 92  b2 3c 7b 40  b9 f7 9d de  fd 2b df 24
|   7f f2 4d bf  c7 d1 70 42  7c 0a 15 be  2a 5b a0 e3
|   0a 32 70 b9
|   Peer KEYMAT computed:
|   61 2a ba aa  07 1f f2 d7  1b fa 85 b7  6c b5 45 9f
|   f0 70 47 87  13 a4 c4 89  c1 c6 ee f0  eb 9e f1 5b
|   c9 9b 0f ca
| install_inbound_ipsec_sa() checking if we can route
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| could_route called for mytunnel (kind=CK_PERMANENT)
|    routing is easy, or has resolvable near-conflict
| checking if this is a replacement state
|   st=0x5650f3386270 ost=(nil) st->serialno=#10 ost->serialno=#0 
| installing outgoing SA now as refhim=0
| state #10(mytunnel): setup outbound esp-ipsec between 10.0.2.15<->10.0.2.14 for 10.0.2.15/32...10.0.2.14/32
| ipcomp maybe
| esp outbound maybe
| looking for outbound alg with transid: 12 keylen: 128 auth: 2 for spi=496549db [10.0.2.15->10.0.2.14] 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| ESP enckey:  61 2a ba aa  07 1f f2 d7  1b fa 85 b7  6c b5 45 9f
| ESP authkey:  f0 70 47 87  13 a4 c4 89  c1 c6 ee f0  eb 9e f1 5b
| ESP authkey:  c9 9b 0f ca
| creating SA spi=db496549@0a00020e proto=50 family=2
| outgoing SA has refhim=4294901761
| state #10(mytunnel): setup inbound esp-ipsec between 10.0.2.14<->10.0.2.15 for 10.0.2.14/32...10.0.2.15/32
| ipcomp maybe
| esp inbound maybe
| looking for inbound alg with transid: 12 keylen: 128 auth: 2 for spi=f43849a9 [10.0.2.14->10.0.2.15] 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| ESP enckey:  2b 50 e9 92  b2 3c 7b 40  b9 f7 9d de  fd 2b df 24
| ESP authkey:  7f f2 4d bf  c7 d1 70 42  7c 0a 15 be  2a 5b a0 e3
| ESP authkey:  0a 32 70 b9
| updating SA spi=a94938f4@0a00020f proto=50 family=2
| creating SPD to 10.0.2.14->spi=00010000@10.0.2.15 proto=4
"mytunnel" #10: add inbound eroute 10.0.2.14/32:0 --0-> 10.0.2.15/32:0 => tun.10000@10.0.2.15 succeeded
| encrypting:
|   01 00 00 18  f6 06 6f 65  de d2 73 36  21 55 8d f9
|   ab 24 52 6d  7d f9 82 7e  0a 00 00 38  00 00 00 01
|   00 00 00 01  00 00 00 2c  00 03 04 01  a9 49 38 f4
|   00 00 00 20  00 0c 00 00  80 03 00 05  80 04 00 01
|   80 01 00 01  80 02 70 80  80 05 00 02  80 06 00 80
|   04 00 00 14  4a 7b 01 a9  73 98 b0 bf  bd b3 bf 23
|   03 ad eb 92  00 00 00 c4  7b 80 1a ea  58 e6 c4 0a
|   b6 92 12 d8  83 ca 38 45  80 44 7c 9d  ec 5b 02 8c
|   29 7f a2 9d  13 fb bf f0  cd 62 91 33  9e cb fd 37
|   17 db 97 85  72 46 ac 5f  43 6a cf e3  1b 36 82 89
|   16 80 b8 1e  05 be c0 1e  6d e8 42 ff  2c 7c c9 6d
|   2c a0 67 b3  75 cf ac ec  7c ed 3f 62  56 57 c5 35
|   b9 73 fd b2  a5 3a 1f cf  11 90 9c d5  e9 ed 5d 08
|   ea c8 87 3e  0d f2 cb 6e  fb 4b ef c5  3d 29 6e ff
|   63 14 f0 b5  c9 de 17 2c  cd 31 c9 48  ac a1 95 f3
|   20 37 db c1  d6 87 00 88  30 0c ab 39  a8 4d 20 52
|   e8 24 dc 3d  43 fa 54 e9  e6 b4 9f 25  68 44 6d 09
|   6e b5 a3 8e  54 ac 5e 68  ef 6e f2 97  aa 7f c8 f7
|   27 cf 27 b9  af 29 81 7c
| IV:
|   a9 6b 9f 75  ce bc e2 a7  52 23 75 75  c4 03 5e 0a
| unpadded size is: 296
| emitting 8 zero bytes of encryption padding into ISAKMP Message
| encrypting 304 using OAKLEY_AES_CBC
| next IV:  5f 84 a4 72  fe 61 02 d2  e7 c1 78 ad  0a 66 d9 64
| emitting length of ISAKMP Message: 332
| finished processing quick inI1
| complete state transition with STF_OK
"mytunnel" #10: transition from state STATE_QUICK_R0 to state STATE_QUICK_R1
| deleting event for #10
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 332 bytes for STATE_QUICK_R0 through enp0s3:500 to 10.0.2.14:500 (using #10)
|   c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
|   08 10 20 01  b5 89 9f 3b  00 00 01 4c  29 92 ca bb
|   87 44 bd 30  55 03 75 39  f1 5c bd 67  3b e5 f8 9f
|   2e 0e 60 21  4b b3 98 09  eb 8c b4 b6  9b dc 65 c8
|   96 e8 22 28  68 67 06 88  db 92 53 aa  52 38 6d e2
|   b3 70 6b 03  9f 62 f6 81  f6 72 1e 86  fa 72 3f 0f
|   fb 21 5a 87  a5 66 ce a2  6b fe a4 60  89 64 bc c1
|   ff 87 61 38  a5 0e 18 aa  72 50 d8 68  54 82 c0 16
|   f9 7a fc 9b  8f 5e 90 07  86 2c ac 92  b6 cb b5 da
|   77 2f fd 95  6b 40 c3 06  1b 7d 2f d6  dd d2 34 80
|   3a fb 7c a5  a6 ea 4c ed  28 29 cb 4f  f5 a2 d8 d0
|   33 d2 a8 25  56 bf 87 4e  b6 67 d1 b7  da 9b 62 84
|   5e 1a 8e 80  3b 41 81 c9  96 af a9 9b  ba 67 17 4c
|   dd 03 ef 3a  e4 7a 37 d5  89 38 31 0f  5f 32 e3 d1
|   8c 96 d8 2d  9c 50 f2 a8  e8 95 76 ad  98 10 76 1f
|   4a bd fb 1c  e7 29 80 00  29 bb d6 a8  ca 35 e8 7d
|   0b 0f 7f eb  f9 b7 75 13  61 63 b9 cc  69 2b b8 48
|   78 69 61 80  14 95 56 72  bf 65 58 74  51 12 35 6e
|   02 0f aa 87  75 fe 44 b4  f3 13 2b eb  e4 f7 b3 fd
|   58 9c 8d 2e  5a 4e 00 83  9c 75 96 2b  5f 84 a4 72
|   fe 61 02 d2  e7 c1 78 ad  0a 66 d9 64
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #10 (head of queue)
"mytunnel" #10: STATE_QUICK_R1: sent QR1, inbound IPsec SA installed, expecting QI2
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| * processed 1 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #10 (2020-01-27 11:23:51)
| next event EVENT_RETRANSMIT in 10 seconds for #10 (2020-01-27 11:23:51)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
<
| *received 60 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:52
|   c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
|   08 10 20 01  b5 89 9f 3b  00 00 00 3c  ba 7e e8 8f
|   19 d8 d0 dd  a9 49 33 8c  a3 59 6e 09  84 6a 7e db
|   d0 51 3b d5  f0 e2 fe 5f  cb 94 7a 3b
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   c4 a7 92 f2  1a a4 1b c0
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  b5 89 9f 3b
|    length: 60
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_QUICK (32), msgid: 3045695291
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  c4 a7 92 f2  1a a4 1b c0
| RCOOKIE:  77 87 1e af  e7 ae a4 3a
| state hash entry 24
| v1 peer and cookies match on #10, provided msgid b5899f3b vs b5899f3b
| v1 state object #10 found, in STATE_QUICK_R1
| processing connection mytunnel
| received encrypted packet from 10.0.2.14:500
| decrypting 32 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   00 00 00 18  21 d5 30 c3  d8 4c 8c 41  e1 47 7b 5d
|   59 ee ce 61  1d 85 58 f8  00 00 00 00  00 00 00 00
| next IV:  84 6a 7e db  d0 51 3b d5  f0 e2 fe 5f  cb 94 7a 3b
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x0
| ***parse ISAKMP Hash Payload:
|    length: 24
| removing 8 bytes of padding
| HASH(3) computed:  21 d5 30 c3  d8 4c 8c 41  e1 47 7b 5d  59 ee ce 61
| HASH(3) computed:  1d 85 58 f8
| state #10: install_ipsec_sa() for outbound only
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| could_route called for mytunnel (kind=CK_PERMANENT)
| state #10: now setting up incoming SA
| sr for #10: prospective erouted (eroute_owner: #0)
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| route_and_eroute with c: mytunnel (next: none) ero:mytunnel esr:{(nil)} ro:mytunnel rosr:{(nil)} and state: 10
| eroute_connection: between 10.0.2.15<->10.0.2.14
| creating SPD to 10.0.2.15->spi=00000000@10.0.2.14 proto=4
"mytunnel" #10: eroute_connection replace eroute 10.0.2.15/32:0 --0-> 10.0.2.14/32:0 => tun.0@10.0.2.14 succeeded
| command executing up-host
| executing up-host: 2>&1 PLUTO_VERB='up-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| route_and_eroute: firewall_notified: true
| route_and_eroute: instance "mytunnel", setting eroute_owner to #10 (was #0) (newest_ipsec_sa=#0)
| inI2: instance mytunnel[0], setting newest_ipsec_sa to #10 (was #0) (spd.eroute=#10)
| complete state transition with STF_OK
"mytunnel" #10: transition from state STATE_QUICK_R1 to state STATE_QUICK_R2
| deleting event for #10
| inserting event EVENT_SA_REPLACE, timeout in 28530 seconds for #10 
| event added after event EVENT_SA_REPLACE for #9
"mytunnel" #10: STATE_QUICK_R2: IPsec SA established tunnel mode {ESP=>0xdb496549 <0xa94938f4 xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
"mytunnel" #10: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 20 seconds
| next event EVENT_PENDING_DDNS in 20 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L
| *received 76 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:23:59
|   c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
|   08 10 05 01  ce 42 b0 b1  00 00 00 4c  f9 a3 ca a5
|   74 9e ac 4c  fb 27 ad f1  10 1a 56 43  1b ef 4c 85
|   4f fa 79 e0  63 df 19 96  e9 55 7c c6  6b d5 21 2d
|   4f 47 ae a6  c5 22 ab 31  d0 fb 2e 7f
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   c4 a7 92 f2  1a a4 1b c0
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  ce 42 b0 b1
|    length: 76
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_INFO (5), msgid: 3460477105
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  c4 a7 92 f2  1a a4 1b c0
| RCOOKIE:  77 87 1e af  e7 ae a4 3a
| state hash entry 24
| peer and cookies match on #10, provided msgid 00000000 vs b5899f3b/00000000
| peer and cookies match on #9, provided msgid 00000000 vs 00000000/00000000
| p15 state object #9 found, in STATE_MAIN_R3
| processing connection mytunnel
| last Phase 1 IV:  10 0d cb b9  c7 c0 81 25  42 6e e1 fc  d5 af 8a 24
| current Phase 1 IV:  10 0d cb b9  c7 c0 81 25  42 6e e1 fc  d5 af 8a 24
| computed Phase 2 IV:
|   1d 90 3c 80  49 89 fc 5a  6f 8f 77 64  24 ba 60 38
|   3a 39 38 17
| received encrypted packet from 10.0.2.14:500
| decrypting 48 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   0c 00 00 18  bd e4 a2 ff  50 36 52 0a  78 b3 af 98
|   7c 85 5c ab  a3 66 e9 70  00 00 00 10  00 00 00 01
|   03 04 00 01  db 49 65 49  00 00 00 00  00 00 00 00
| next IV:  6b d5 21 2d  4f 47 ae a6  c5 22 ab 31  d0 fb 2e 7f
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x0
| ***parse ISAKMP Hash Payload:
|    length: 24
| got payload 0x1000(ISAKMP_NEXT_D) needed: 0x0 opt: 0x0
| ***parse ISAKMP Delete Payload:
|    length: 16
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 3
|    SPI size: 4
|    number of SPIs: 1
| removing 8 bytes of padding
| HASH(1) computed:
|   bd e4 a2 ff  50 36 52 0a  78 b3 af 98  7c 85 5c ab
|   a3 66 e9 70
| received 'informational' message HASH(1) data ok
| processing connection mytunnel
"mytunnel" #9: received Delete SA(0xdb496549) payload: deleting IPSEC State #10
"mytunnel" #9: deleting state #10 (STATE_QUICK_R2)
| find_phase1_state: found SA #9 for conn 'mytunnel' in state STATE_MAIN_R3
| **emit ISAKMP Message:
|    initiator cookie:
|   c4 a7 92 f2  1a a4 1b c0
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  59 c4 47 84
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH(1) into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Delete Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 3
|    SPI size: 4
|    number of SPIs: 1
| emitting 4 raw bytes of delete payload into ISAKMP Delete Payload
| delete payload  a9 49 38 f4
| emitting length of ISAKMP Delete Payload: 16
| HASH(1) computed:
|   93 5a e0 81  cb 97 3b e0  4a 55 6f 52  aa d9 88 09
|   23 39 17 41
| last Phase 1 IV:  10 0d cb b9  c7 c0 81 25  42 6e e1 fc  d5 af 8a 24
| current Phase 1 IV:  10 0d cb b9  c7 c0 81 25  42 6e e1 fc  d5 af 8a 24
| computed Phase 2 IV:
|   c8 0f 6d 44  fa 85 54 f3  7c 06 f1 e0  f0 60 b0 3e
|   ef 05 6f d9
| encrypting:
|   0c 00 00 18  93 5a e0 81  cb 97 3b e0  4a 55 6f 52
|   aa d9 88 09  23 39 17 41  00 00 00 10  00 00 00 01
|   03 04 00 01  a9 49 38 f4
| IV:
|   c8 0f 6d 44  fa 85 54 f3  7c 06 f1 e0  f0 60 b0 3e
|   ef 05 6f d9
| unpadded size is: 40
| emitting 8 zero bytes of encryption padding into ISAKMP Message
| encrypting 48 using OAKLEY_AES_CBC
| next IV:  e9 ad 1e 81  79 02 33 9b  38 c0 89 fa  a4 40 94 01
| emitting length of ISAKMP Message: 76
| sending 76 bytes for delete notify through enp0s3:500 to 10.0.2.14:500 (using #9)
|   c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
|   08 10 05 01  59 c4 47 84  00 00 00 4c  d8 e0 91 e0
|   cd 79 a5 e0  cd fb ff 5e  be 01 a4 d8  70 7c 6d 6e
|   13 f0 64 48  8c 80 5e df  30 89 6e 2f  e9 ad 1e 81
|   79 02 33 9b  38 c0 89 fa  a4 40 94 01
| deleting event for #10
| no suspended cryptographic state for 10 
| removing state object #10
| ICOOKIE:  c4 a7 92 f2  1a a4 1b c0
| RCOOKIE:  77 87 1e af  e7 ae a4 3a
| state hash entry 24
| command executing down-host
| executing down-host: 2>&1 PLUTO_VERB='down-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| request to replace with shunt a prospective erouted policy with netkey kernel --- experimental
| creating SPD to 10.0.2.15->spi=00000104@0.0.0.0 proto=61
| delete esp.db496549@10.0.2.14
| creating SPD to 10.0.2.14->spi=00010000@10.0.2.15 proto=255
"mytunnel" #9: delete (half) inbound eroute 10.0.2.14/32:0 --0-> 10.0.2.15/32:0 => unk255.10000@10.0.2.15 succeeded
| delete esp.a94938f4@10.0.2.15
| del:  db 49 65 49
"mytunnel" #9: received and ignored informational message
| complete state transition with STF_IGNORE
"mytunnel" #9: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 13 seconds
| next event EVENT_PENDING_DDNS in 13 seconds
| deleting event for #10
| freeing state object #10
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\234
| *received 156 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:24:01
|   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00
|   01 10 02 00  00 00 00 00  00 00 00 9c  0d 00 00 5c
|   00 00 00 01  00 00 00 01  00 00 00 50  00 01 00 02
|   03 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  00 00 00 24  01 01 00 00  80 0b 00 01
|   80 0c 0e 10  80 01 00 07  80 02 00 02  80 03 00 01
|   80 04 00 02  80 0e 00 80  0d 00 00 10  4f 53 57 7e
|   7c 74 59 69  57 59 73 57  00 00 00 14  af ca d7 13
|   68 a1 f1 c9  6b 86 96 fc  77 57 01 00
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 156
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
packet from 10.0.2.14:500: Initiator Cookie must not be zero in phase 1 message
packet from 10.0.2.14:500: [PIET] I detected a ZERO initiator cookie... (ikev1.c)
packet from 10.0.2.14:500: sending notification INVALID_COOKIE to 10.0.2.14:500
| **emit ISAKMP Message:
|    initiator cookie:
|   00 00 00 00  00 00 00 00
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Notification Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 0
|    Notify Message Type: INVALID_COOKIE
| emitting length of ISAKMP Notification Payload: 12
| emitting length of ISAKMP Message: 40
| sending 40 bytes for notification packet through enp0s3:500 to 10.0.2.14:500 (using #0)
|   00 00 00 00  00 00 00 00  00 00 00 00  00 00 00 00
|   0b 10 05 00  00 00 00 00  00 00 00 28  00 00 00 0c
|   00 00 00 01  01 00 00 04
packet from 10.0.2.14:500: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 11 seconds
| next event EVENT_PENDING_DDNS in 11 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\234
| *received 156 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:24:11
|   58 cf bc ae  e1 b7 ab b1  00 00 00 00  00 00 00 00
|   01 10 02 00  00 00 00 00  00 00 00 9c  0d 00 00 5c
|   00 00 00 01  00 00 00 01  00 00 00 50  00 01 00 02
|   03 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  00 00 00 24  01 01 00 00  80 0b 00 01
|   80 0c 0e 10  80 01 00 07  80 02 00 02  80 03 00 01
|   80 04 00 02  80 0e 00 80  0d 00 00 10  4f 53 57 7e
|   7c 74 59 69  57 59 73 57  00 00 00 14  af ca d7 13
|   68 a1 f1 c9  6b 86 96 fc  77 57 01 00
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   58 cf bc ae  e1 b7 ab b1
|    responder cookie:
|   00 00 00 00  00 00 00 00
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 156
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| got payload 0x2(ISAKMP_NEXT_SA) needed: 0x2 opt: 0x2080
| ***parse ISAKMP Security Association Payload:
|    length: 92
|    DOI: ISAKMP_DOI_IPSEC
| got payload 0x2000(ISAKMP_NEXT_VID) needed: 0x0 opt: 0x2080
| ***parse ISAKMP Vendor ID Payload:
|    length: 16
| got payload 0x2000(ISAKMP_NEXT_VID) needed: 0x0 opt: 0x2080
| ***parse ISAKMP Vendor ID Payload:
|    length: 20
packet from 10.0.2.14:500: ignoring unknown Vendor ID payload [4f53577e7c74596957597357]
packet from 10.0.2.14:500: received Vendor ID payload [Dead Peer Detection]
| find_host_connection2 called from main_inI1_outR1, me=10.0.2.15:500 him=10.0.2.14:500 policy=/!IKEv1
| find_host_pair: looking for me=10.0.2.15:500 %address him=10.0.2.14:500 any-match 
| find_host_pair: comparing to me=10.0.2.15:500 %address him=10.0.2.14:500 
| find_host_pair: concluded with mytunnel
| found_host_pair_conn (find_host_connection2): 10.0.2.15:500 %address/10.0.2.14:500 -> hp:mytunnel 
| searching for connection with policy = /!IKEv1
| found policy = PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK (mytunnel)
| find_host_connection2 returns mytunnel (ike=none/none)
| creating state object #11 at 0x5650f3386270
| processing connection mytunnel
| ICOOKIE:  58 cf bc ae  e1 b7 ab b1
| RCOOKIE:  fa 21 86 f7  33 60 84 69
| state hash entry 7
| inserting state object #11 bucket: 7
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #11 (head of queue)
"mytunnel" #11: responding to Main Mode
| **emit ISAKMP Message:
|    initiator cookie:
|   58 cf bc ae  e1 b7 ab b1
|    responder cookie:
|   fa 21 86 f7  33 60 84 69
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Security Association Payload:
|    DOI: ISAKMP_DOI_IPSEC
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 80
|    proposal number: 0
|    protocol ID: PROTO_ISAKMP
|    SPI size: 0
|    number of transforms: 2
| *****parse ISAKMP Transform Payload (ISAKMP):
|    length: 36
|    transform number: 0
|    transform ID: KEY_IKE
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_LIFE_TYPE
|    length/value: 1
|    [1 is OAKLEY_LIFE_SECONDS]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_LIFE_DURATION
|    length/value: 3600
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_ENCRYPTION_ALGORITHM
|    length/value: 7
|    [7 is OAKLEY_AES_CBC]
| ike_alg_enc_ok(ealg=7,key_len=0): blocksize=16, keyminlen=128, keydeflen=128, keymaxlen=256, ret=1
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_HASH_ALGORITHM
|    length/value: 2
|    [2 is OAKLEY_SHA1]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_AUTHENTICATION_METHOD
|    length/value: 1
|    [1 is OAKLEY_PRESHARED_KEY]
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP Oakley attribute:
|    af+type: OAKLEY_KEY_LENGTH
|    length/value: 128
| ike_alg_enc_ok(ealg=7,key_len=128): blocksize=16, keyminlen=128, keydeflen=128, keymaxlen=256, ret=1
| Oakley Transform 0 accepted
| ****emit IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****emit ISAKMP Proposal Payload:
|    proposal number: 0
|    protocol ID: PROTO_ISAKMP
|    SPI size: 0
|    number of transforms: 1
| *****emit ISAKMP Transform Payload (ISAKMP):
|    transform number: 0
|    transform ID: KEY_IKE
| emitting 28 raw bytes of attributes into ISAKMP Transform Payload (ISAKMP)
| attributes  80 0b 00 01  80 0c 0e 10  80 01 00 07  80 02 00 02
| attributes  80 03 00 01  80 04 00 05  80 0e 00 80
| emitting length of ISAKMP Transform Payload (ISAKMP): 36
| emitting length of ISAKMP Proposal Payload: 44
| emitting length of ISAKMP Security Association Payload: 56
| ***emit ISAKMP Vendor ID Payload:
| emitting 12 raw bytes of Vendor ID into ISAKMP Vendor ID Payload
| Vendor ID  4f 53 57 5e  41 76 56 4b  68 7b 55 50
| emitting length of ISAKMP Vendor ID Payload: 16
| out_vendorid(): sending [Dead Peer Detection]
| ***emit ISAKMP Vendor ID Payload:
| emitting 16 raw bytes of V_ID into ISAKMP Vendor ID Payload
| V_ID  af ca d7 13  68 a1 f1 c9  6b 86 96 fc  77 57 01 00
| emitting length of ISAKMP Vendor ID Payload: 20
| sender checking NAT-T: 0 and 0
| emitting length of ISAKMP Message: 120
| peer supports dpd
| complete state transition with STF_OK
"mytunnel" #11: transition from state STATE_MAIN_R0 to state STATE_MAIN_R1
| deleting event for #11
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 120 bytes for STATE_MAIN_R0 through enp0s3:500 to 10.0.2.14:500 (using #11)
|   58 cf bc ae  e1 b7 ab b1  fa 21 86 f7  33 60 84 69
|   01 10 02 00  00 00 00 00  00 00 00 78  0d 00 00 38
|   00 00 00 01  00 00 00 01  00 00 00 2c  00 01 00 01
|   00 00 00 24  00 01 00 00  80 0b 00 01  80 0c 0e 10
|   80 01 00 07  80 02 00 02  80 03 00 01  80 04 00 05
|   80 0e 00 80  0d 00 00 10  4f 53 57 5e  41 76 56 4b
|   68 7b 55 50  00 00 00 14  af ca d7 13  68 a1 f1 c9
|   6b 86 96 fc  77 57 01 00
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #11 
| event added after event EVENT_PENDING_DDNS
"mytunnel" #11: STATE_MAIN_R1: sent MR1, expecting MI2
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
"mytunnel" #11: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 1 seconds
| next event EVENT_PENDING_DDNS in 1 seconds
|  
| next event EVENT_PENDING_DDNS in 0 seconds
| *time to handle event
| at 2020-01-27 11:24:12 handling event EVENT_PENDING_DDNS
| event after this is EVENT_RETRANSMIT in 9 seconds
| inserting event EVENT_PENDING_DDNS, timeout in 60 seconds 
| event added after event EVENT_RETRANSMIT for #11
| next event EVENT_RETRANSMIT in 9 seconds for #11 (2020-01-27 11:24:12)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
\364
| *received 244 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:24:12
|   58 cf bc ae  e1 b7 ab b1  fa 21 86 f7  33 60 84 69
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
|   0f 3a f5 42  33 e3 da 85  3c 37 53 13  24 c8 91 37
|   78 e8 8c 62  40 56 10 dd  4d 78 5a 26  28 ab e1 41
|   6d 5c 1e 77  7e 20 a8 9e  7e 8c 9d b5  e0 8e 00 7c
|   ce 4a ee 64  5d 65 03 8b  07 18 93 f1  26 b6 86 20
|   6a a1 91 a2  b7 93 60 62  e7 34 48 4d  0f 47 cd 5f
|   f7 87 95 fc  18 37 2d 52  ba 26 57 0e  a1 cc 78 67
|   78 5a e0 00  b0 71 92 1b  eb 52 63 96  32 a7 1a 4c
|   bb b8 6c e6  91 ea 4c f4  fe 75 19 83  16 94 65 6c
|   b4 bb 2d b1  a1 21 e0 84  49 ce 6f 06  35 25 9e 6a
|   89 f4 58 66  8f 41 59 ce  2b 54 06 34  f9 62 7b 06
|   75 59 99 47  7f 8c 19 a9  c9 1d 28 2c  49 ef 1f 8e
|   7a 0a b9 ff  98 03 4b a0  dd 8b 20 80  eb 4d 0f 4b
|   00 00 00 14  75 c9 17 20  1b b8 37 bb  b6 1a fc 84
|   de 6f 16 d7
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   58 cf bc ae  e1 b7 ab b1
|    responder cookie:
|   fa 21 86 f7  33 60 84 69
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
|    length: 244
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  58 cf bc ae  e1 b7 ab b1
| RCOOKIE:  fa 21 86 f7  33 60 84 69
| state hash entry 7
| v1 peer and cookies match on #11, provided msgid 00000000 vs 00000000
| v1 state object #11 found, in STATE_MAIN_R1
| processing connection mytunnel
| got payload 0x10(ISAKMP_NEXT_KE) needed: 0x410 opt: 0x102080
| ***parse ISAKMP Key Exchange Payload:
|    length: 196
| got payload 0x400(ISAKMP_NEXT_NONCE) needed: 0x400 opt: 0x102080
| ***parse ISAKMP Nonce Payload:
|    length: 20
| DH public value received:
|   0f 3a f5 42  33 e3 da 85  3c 37 53 13  24 c8 91 37
|   78 e8 8c 62  40 56 10 dd  4d 78 5a 26  28 ab e1 41
|   6d 5c 1e 77  7e 20 a8 9e  7e 8c 9d b5  e0 8e 00 7c
|   ce 4a ee 64  5d 65 03 8b  07 18 93 f1  26 b6 86 20
|   6a a1 91 a2  b7 93 60 62  e7 34 48 4d  0f 47 cd 5f
|   f7 87 95 fc  18 37 2d 52  ba 26 57 0e  a1 cc 78 67
|   78 5a e0 00  b0 71 92 1b  eb 52 63 96  32 a7 1a 4c
|   bb b8 6c e6  91 ea 4c f4  fe 75 19 83  16 94 65 6c
|   b4 bb 2d b1  a1 21 e0 84  49 ce 6f 06  35 25 9e 6a
|   89 f4 58 66  8f 41 59 ce  2b 54 06 34  f9 62 7b 06
|   75 59 99 47  7f 8c 19 a9  c9 1d 28 2c  49 ef 1f 8e
|   7a 0a b9 ff  98 03 4b a0  dd 8b 20 80  eb 4d 0f 4b
| inI2: checking NAT-T: 0 and 0
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 21 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #11
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing build_kenonce op id: 21
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #11 
| event added after event EVENT_PENDING_PHASE2
| complete state transition with STF_SUSPEND
! Local DH secret:
"mytunnel" #11: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
!   07 05 ae c2  66 0c f2 8d  cc cd c0 f3  1e c5 fb a1
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 60 seconds
!   41 f9 f1 22  3d 2e 0c 8d  23 f6 75 15  3d c7 59 eb
| next event EVENT_PENDING_DDNS in 60 seconds
! Public DH value sent:
!   a8 e5 c9 5b  a0 bf de d9  ff 3b 9c 81  45 a0 82 09
!   7d 9a 41 fc  40 8f ce 26  45 42 46 e3  f1 e6 d7 8b
!   c1 77 88 fb  9a 11 4c e2  0b 16 c4 81  7e d8 3e 14
!   79 6e e3 ff  0f 01 62 03  3f 61 07 06  f6 96 b4 20
!   cc 35 49 26  08 57 45 68  29 e4 b9 17  e8 4f a4 0e
!   54 2c cd 08  ca de 05 88  15 30 f3 ae  ba f9 74 26
!   f4 a8 20 75  5a f2 d6 b7  1c d5 62 66  66 a0 05 2f
!   b1 89 e9 fe  f9 9a d7 34  95 b2 cb 00  24 56 e9 99
!   e7 91 96 a6  e8 ad f3 27  0e 63 be 65  7e 24 d2 49
!   f9 3f 24 0e  3a fb f6 df  95 98 29 6d  19 40 dd 25
!   a3 45 fc c1  4d fc 17 e1  1c 50 82 56  fd 6e 0f 6a
!   c5 a1 dd 39  63 6d 67 49  48 b4 b8 e6  51 35 2c 51
! Generated nonce:
!   d8 56 79 71  3e 2d ed 0c  2f 96 30 3f  56 32 3e 19
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#21
| calling callback function 0x5650f2303aa0
| main inI2_outR2: calculated ke+nonce, sending R2
| processing connection mytunnel
| **emit ISAKMP Message:
|    initiator cookie:
|   58 cf bc ae  e1 b7 ab b1
|    responder cookie:
|   fa 21 86 f7  33 60 84 69
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: none
|    message ID:  00 00 00 00
| ***emit ISAKMP Key Exchange Payload:
| emitting 192 raw bytes of keyex value into ISAKMP Key Exchange Payload
| keyex value  a8 e5 c9 5b  a0 bf de d9  ff 3b 9c 81  45 a0 82 09
| keyex value  7d 9a 41 fc  40 8f ce 26  45 42 46 e3  f1 e6 d7 8b
| keyex value  c1 77 88 fb  9a 11 4c e2  0b 16 c4 81  7e d8 3e 14
| keyex value  79 6e e3 ff  0f 01 62 03  3f 61 07 06  f6 96 b4 20
| keyex value  cc 35 49 26  08 57 45 68  29 e4 b9 17  e8 4f a4 0e
| keyex value  54 2c cd 08  ca de 05 88  15 30 f3 ae  ba f9 74 26
| keyex value  f4 a8 20 75  5a f2 d6 b7  1c d5 62 66  66 a0 05 2f
| keyex value  b1 89 e9 fe  f9 9a d7 34  95 b2 cb 00  24 56 e9 99
| keyex value  e7 91 96 a6  e8 ad f3 27  0e 63 be 65  7e 24 d2 49
| keyex value  f9 3f 24 0e  3a fb f6 df  95 98 29 6d  19 40 dd 25
| keyex value  a3 45 fc c1  4d fc 17 e1  1c 50 82 56  fd 6e 0f 6a
| keyex value  c5 a1 dd 39  63 6d 67 49  48 b4 b8 e6  51 35 2c 51
| emitting length of ISAKMP Key Exchange Payload: 196
| ***emit ISAKMP Nonce Payload:
| emitting 16 raw bytes of Nr into ISAKMP Nonce Payload
| Nr  d8 56 79 71  3e 2d ed 0c  2f 96 30 3f  56 32 3e 19
| emitting length of ISAKMP Nonce Payload: 20
| emitting length of ISAKMP Message: 244
| main inI2_outR2: starting async DH calculation (group=5)
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| parent1 type: 7 group: 5 len: 2760 
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh+iv op on seq: 22 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #11
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #11 
! helper 0 read 2752+4/2760 bytesfd: 8
| event added after event EVENT_PENDING_PHASE2
| started dh_secretiv, returned: stf=STF_SUSPEND 
! helper 0 doing compute dh+iv op id: 22
| complete state transition with STF_OK
"mytunnel" #11: transition from state STATE_MAIN_R1 to state STATE_MAIN_R2
| deleting event for #11
! peer's g:   0f 3a f5 42  33 e3 da 85  3c 37 53 13  24 c8 91 37
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 244 bytes for STATE_MAIN_R1 through enp0s3:500 to 10.0.2.14:500 (using #11)
! peer's g:   78 e8 8c 62  40 56 10 dd  4d 78 5a 26  28 ab e1 41
|   58 cf bc ae  e1 b7 ab b1  fa 21 86 f7  33 60 84 69
|   04 10 02 00  00 00 00 00  00 00 00 f4  0a 00 00 c4
! peer's g:   6d 5c 1e 77  7e 20 a8 9e  7e 8c 9d b5  e0 8e 00 7c
|   a8 e5 c9 5b  a0 bf de d9  ff 3b 9c 81  45 a0 82 09
|   7d 9a 41 fc  40 8f ce 26  45 42 46 e3  f1 e6 d7 8b
! peer's g:   ce 4a ee 64  5d 65 03 8b  07 18 93 f1  26 b6 86 20
|   c1 77 88 fb  9a 11 4c e2  0b 16 c4 81  7e d8 3e 14
|   79 6e e3 ff  0f 01 62 03  3f 61 07 06  f6 96 b4 20
|   cc 35 49 26  08 57 45 68  29 e4 b9 17  e8 4f a4 0e
! peer's g:   6a a1 91 a2  b7 93 60 62  e7 34 48 4d  0f 47 cd 5f
|   54 2c cd 08  ca de 05 88  15 30 f3 ae  ba f9 74 26
|   f4 a8 20 75  5a f2 d6 b7  1c d5 62 66  66 a0 05 2f
! peer's g:   f7 87 95 fc  18 37 2d 52  ba 26 57 0e  a1 cc 78 67
|   b1 89 e9 fe  f9 9a d7 34  95 b2 cb 00  24 56 e9 99
|   e7 91 96 a6  e8 ad f3 27  0e 63 be 65  7e 24 d2 49
! peer's g:   78 5a e0 00  b0 71 92 1b  eb 52 63 96  32 a7 1a 4c
|   f9 3f 24 0e  3a fb f6 df  95 98 29 6d  19 40 dd 25
|   a3 45 fc c1  4d fc 17 e1  1c 50 82 56  fd 6e 0f 6a
! peer's g:   bb b8 6c e6  91 ea 4c f4  fe 75 19 83  16 94 65 6c
|   c5 a1 dd 39  63 6d 67 49  48 b4 b8 e6  51 35 2c 51
|   00 00 00 14  d8 56 79 71  3e 2d ed 0c  2f 96 30 3f
! peer's g:   b4 bb 2d b1  a1 21 e0 84  49 ce 6f 06  35 25 9e 6a
|   56 32 3e 19
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #11 (head of queue)
! peer's g:   89 f4 58 66  8f 41 59 ce  2b 54 06 34  f9 62 7b 06
"mytunnel" #11: STATE_MAIN_R2: sent MR2, expecting MI3
| modecfg pull: noquirk policy:push not-client
! peer's g:   75 59 99 47  7f 8c 19 a9  c9 1d 28 2c  49 ef 1f 8e
| phase 1 is done, looking for phase 2 to unpend
| * processed 1 messages from cryptographic helpers 
! peer's g:   7a 0a b9 ff  98 03 4b a0  dd 8b 20 80  eb 4d 0f 4b
| next event EVENT_RETRANSMIT in 10 seconds for #11 (2020-01-27 11:24:12)
| next event EVENT_RETRANSMIT in 10 seconds for #11 (2020-01-27 11:24:12)
! long term secret:   07 05 ae c2  66 0c f2 8d  cc cd c0 f3  1e c5 fb a1
! long term secret:   41 f9 f1 22  3d 2e 0c 8d  23 f6 75 15  3d c7 59 eb
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP1536): 445 usec
! DH shared-secret:
!   ad d8 0d 48  46 b5 24 1b  0e 6a 81 7e  15 f0 c1 19
!   9e 6a 7b 5a  67 cb 5c 8f  25 bd 91 0e  ef 60 d3 45
!   04 68 dd 8f  d6 68 99 7f  6c 8d 8b 05  14 d1 b6 99
!   52 6c fd 06  b1 f1 92 5d  bb 14 64 b0  76 71 47 69
!   74 1e 22 44  84 cf 6c fc  2d 35 a7 1e  81 30 5d 68
!   b4 2a 60 cd  ce 49 66 44  1f de fc 98  c5 e3 24 a2
!   1d 5d d8 03  7f d8 d9 a4  97 a5 ba 54  09 f7 ac 50
!   f1 fe 4e 7a  34 dc 3c 53  e1 92 9b df  7e c0 1e 6a
!   d1 49 61 85  dc f2 e1 5d  b5 33 19 72  71 f0 de 17
!   ad 58 85 48  f1 a8 01 5e  b5 ec 3e 77  3d cf 43 bc
!   81 9a d7 72  4d 56 5b ad  28 f4 71 63  72 2f 76 6a
!   c3 c3 e2 be  10 42 69 ad  82 d0 91 c7  13 b9 3d 1c
! Skey inputs (PSK+NI+NR)
! ni:   75 c9 17 20  1b b8 37 bb  b6 1a fc 84  de 6f 16 d7
! nr:   d8 56 79 71  3e 2d ed 0c  2f 96 30 3f  56 32 3e 19
! keyid:   2a 8d 5d ae  25 22 f0 b8  8f 65 64 61  14 b8 42 59
! keyid:   2d d1 b1 42
! NSS: end of key computation 
! DH_i:  0f 3a f5 42  33 e3 da 85  3c 37 53 13  24 c8 91 37
! DH_i:  78 e8 8c 62  40 56 10 dd  4d 78 5a 26  28 ab e1 41
! DH_i:  6d 5c 1e 77  7e 20 a8 9e  7e 8c 9d b5  e0 8e 00 7c
! DH_i:  ce 4a ee 64  5d 65 03 8b  07 18 93 f1  26 b6 86 20
! DH_i:  6a a1 91 a2  b7 93 60 62  e7 34 48 4d  0f 47 cd 5f
! DH_i:  f7 87 95 fc  18 37 2d 52  ba 26 57 0e  a1 cc 78 67
! DH_i:  78 5a e0 00  b0 71 92 1b  eb 52 63 96  32 a7 1a 4c
! DH_i:  bb b8 6c e6  91 ea 4c f4  fe 75 19 83  16 94 65 6c
! DH_i:  b4 bb 2d b1  a1 21 e0 84  49 ce 6f 06  35 25 9e 6a
! DH_i:  89 f4 58 66  8f 41 59 ce  2b 54 06 34  f9 62 7b 06
! DH_i:  75 59 99 47  7f 8c 19 a9  c9 1d 28 2c  49 ef 1f 8e
! DH_i:  7a 0a b9 ff  98 03 4b a0  dd 8b 20 80  eb 4d 0f 4b
! DH_r:  a8 e5 c9 5b  a0 bf de d9  ff 3b 9c 81  45 a0 82 09
! DH_r:  7d 9a 41 fc  40 8f ce 26  45 42 46 e3  f1 e6 d7 8b
! DH_r:  c1 77 88 fb  9a 11 4c e2  0b 16 c4 81  7e d8 3e 14
! DH_r:  79 6e e3 ff  0f 01 62 03  3f 61 07 06  f6 96 b4 20
! DH_r:  cc 35 49 26  08 57 45 68  29 e4 b9 17  e8 4f a4 0e
! DH_r:  54 2c cd 08  ca de 05 88  15 30 f3 ae  ba f9 74 26
! DH_r:  f4 a8 20 75  5a f2 d6 b7  1c d5 62 66  66 a0 05 2f
! DH_r:  b1 89 e9 fe  f9 9a d7 34  95 b2 cb 00  24 56 e9 99
! DH_r:  e7 91 96 a6  e8 ad f3 27  0e 63 be 65  7e 24 d2 49
! DH_r:  f9 3f 24 0e  3a fb f6 df  95 98 29 6d  19 40 dd 25
! DH_r:  a3 45 fc c1  4d fc 17 e1  1c 50 82 56  fd 6e 0f 6a
! DH_r:  c5 a1 dd 39  63 6d 67 49  48 b4 b8 e6  51 35 2c 51
! end of IV generation 
! Skeyid:    2a 8d 5d ae  25 22 f0 b8  8f 65 64 61  14 b8 42 59
! Skeyid:    2d d1 b1 42
! Skeyid_d:  4b 7a 43 b0  14 b6 bc e8  bd ed 7b 19  d1 bc 4f a9
! Skeyid_d:  27 09 c9 61
! Skeyid_a:  4c a5 6b 91  ea 20 c5 12  77 f9 2a 51  16 a2 b8 3b
! Skeyid_a:  5d 51 7b 95
! Skeyid_e:  50 e5 2d bb  b1 f5 5c f5  70 7e b6 23  77 e1 b2 8f
! Skeyid_e:  d5 a8 99 09
! enc key:  50 e5 2d bb  b1 f5 5c f5  70 7e b6 23  77 e1 b2 8f
! IV:  7a 63 b5 f5  54 9b 81 95  21 12 af 34  42 80 6d 45
! IV:  ff 31 ec 16
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#22
| calling callback function 0x5650f2303250
| main inI2_outR2: calculated DH finished
| processing connection mytunnel
| WARNING: finish_dh_secretiv:160: encryptor 'aes' expects keylen 16/128, SA #11 INITIATOR keylen is 20
| WARNING: finish_dh_secretiv:160: encryptor 'aes' expects keylen 16/128, SA #11 RESPONDER keylen is 0
| WARNING: main_inI2_outR2_calcdone:1230: encryptor 'aes' expects keylen 16/128, SA #11 INITIATOR keylen is 20
| WARNING: main_inI2_outR2_calcdone:1230: encryptor 'aes' expects keylen 16/128, SA #11 RESPONDER keylen is 0
| * processed 1 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #11 (2020-01-27 11:24:12)
| next event EVENT_RETRANSMIT in 10 seconds for #11 (2020-01-27 11:24:12)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L
| *received 76 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:24:13
|   58 cf bc ae  e1 b7 ab b1  fa 21 86 f7  33 60 84 69
|   05 10 02 01  00 00 00 00  00 00 00 4c  65 2d 47 ca
|   b4 60 ae ee  b8 0b c9 70  c0 16 bd cf  2e 9d 25 37
|   2b 29 54 83  a8 06 95 4e  4d 61 1c e1  c9 db 7f 33
|   3c 2c 37 52  e7 77 ae 40  1d b5 0b 19
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   58 cf bc ae  e1 b7 ab b1
|    responder cookie:
|   fa 21 86 f7  33 60 84 69
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  00 00 00 00
|    length: 76
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_IDPROT (2), msgid: 00000000
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  58 cf bc ae  e1 b7 ab b1
| RCOOKIE:  fa 21 86 f7  33 60 84 69
| state hash entry 7
| v1 peer and cookies match on #11, provided msgid 00000000 vs 00000000
| v1 state object #11 found, in STATE_MAIN_R2
| processing connection mytunnel
| received encrypted packet from 10.0.2.14:500
| decrypting 48 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   08 00 00 0c  01 00 00 00  0a 00 02 0e  00 00 00 18
|   29 77 89 86  67 bc 52 59  48 48 4a c6  c5 dc 2d 5d
|   2d 47 0f bb  00 00 00 00  00 00 00 00  00 00 00 00
| next IV:  c9 db 7f 33  3c 2c 37 52  e7 77 ae 40  1d b5 0b 19
| got payload 0x20(ISAKMP_NEXT_ID) needed: 0x120 opt: 0x2080
| ***parse ISAKMP Identification Payload:
|    length: 12
|    ID type: ID_IPV4_ADDR
|    DOI specific A: 0
|    DOI specific B: 0
|      obj:   0a 00 02 0e
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x2080
| ***parse ISAKMP Hash Payload:
|    length: 24
| removing 12 bytes of padding
"mytunnel" #11: Main mode peer ID is ID_IPV4_ADDR: '10.0.2.14'
| refine_connection: starting with mytunnel
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
|    match_id a=10.0.2.14
|             b=10.0.2.14
|    results  matched
|   trusted_ca_by_name called with a=(empty) b=(empty)
| refine_connection: checking mytunnel against mytunnel, best=(none) with match=1(id=1/ca=1/reqca=1)
| refine_connection: checked mytunnel against mytunnel, now for see if best
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| offered CA: '%none'
| hashing 88 bytes of SA
| authentication succeeded
| thinking about whether to send my certificate:
|   I have RSA key: OAKLEY_PRESHARED_KEY cert.type: CERT_NONE 
|   sendcert: CERT_SENDIFASKED and I did not get a certificate request 
|   so do not send cert.
| I did not send a certificate because digital signatures are not being used. (PSK)
| **emit ISAKMP Message:
|    initiator cookie:
|   58 cf bc ae  e1 b7 ab b1
|    responder cookie:
|   fa 21 86 f7  33 60 84 69
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_IDPROT
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  00 00 00 00
| ***emit ISAKMP Identification Payload (IPsec DOI):
|    ID type: ID_IPV4_ADDR
|    Protocol ID: 0
|    port: 0
| emitting 4 raw bytes of my identity into ISAKMP Identification Payload (IPsec DOI)
| my identity  0a 00 02 0f
| emitting length of ISAKMP Identification Payload (IPsec DOI): 12
| hashing 88 bytes of SA
| ***emit ISAKMP Hash Payload:
| emitting 20 raw bytes of HASH_R into ISAKMP Hash Payload
| HASH_R  b8 64 13 ea  ad 61 c5 70  05 d9 e9 c4  67 37 0b 0a
| HASH_R  8d 28 51 bc
| emitting length of ISAKMP Hash Payload: 24
| out_vendorid(): sending [CAN-IKEv2]
| ***emit ISAKMP Vendor ID Payload:
| emitting 5 raw bytes of V_ID into ISAKMP Vendor ID Payload
| V_ID  49 4b 45 76  32
| emitting length of ISAKMP Vendor ID Payload: 9
| encrypting:
|   08 00 00 0c  01 00 00 00  0a 00 02 0f  0d 00 00 18
|   b8 64 13 ea  ad 61 c5 70  05 d9 e9 c4  67 37 0b 0a
|   8d 28 51 bc  00 00 00 09  49 4b 45 76  32
| IV:
|   c9 db 7f 33  3c 2c 37 52  e7 77 ae 40  1d b5 0b 19
| unpadded size is: 45
| emitting 3 zero bytes of encryption padding into ISAKMP Message
| encrypting 48 using OAKLEY_AES_CBC
| next IV:  92 d4 b7 c0  6e 47 fd da  b1 70 bb 6b  4e 66 06 b1
| emitting length of ISAKMP Message: 76
| last encrypted block of Phase 1:
|   92 d4 b7 c0  6e 47 fd da  b1 70 bb 6b  4e 66 06 b1
| complete state transition with STF_OK
"mytunnel" #11: transition from state STATE_MAIN_R2 to state STATE_MAIN_R3
| deleting event for #11
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 76 bytes for STATE_MAIN_R2 through enp0s3:500 to 10.0.2.14:500 (using #11)
|   58 cf bc ae  e1 b7 ab b1  fa 21 86 f7  33 60 84 69
|   05 10 02 01  00 00 00 00  00 00 00 4c  4d 2c 14 98
|   a4 a0 93 b5  d4 5b 52 95  5e 7f 56 c5  1d 6c 20 ee
|   e3 44 35 fa  d5 1e e8 e2  ab d2 61 d3  92 d4 b7 c0
|   6e 47 fd da  b1 70 bb 6b  4e 66 06 b1
| inserting event EVENT_SA_REPLACE, timeout in 3330 seconds for #11 
| event added after event EVENT_SA_REPLACE for #9
"mytunnel" #11: STATE_MAIN_R3: sent MR3, ISAKMP SA established {auth=OAKLEY_PRESHARED_KEY oursig= theirsig= cipher=aes_128 prf=oakley_sha group=modp1536}
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| unpending state #11
"mytunnel" #11: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 59 seconds
| next event EVENT_PENDING_DDNS in 59 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L\001
| *received 332 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:24:14
|   58 cf bc ae  e1 b7 ab b1  fa 21 86 f7  33 60 84 69
|   08 10 20 01  72 d4 5d 67  00 00 01 4c  87 be 13 f4
|   27 32 24 16  56 3d c9 cc  8c 6e 20 0c  8c 89 df 78
|   29 cb ac 7f  50 d5 79 b4  fe 9b 99 52  d5 7a cb 09
|   9d 74 3f ea  3a c4 7d 0c  47 c6 9e ee  d2 a9 d4 57
|   0c 29 b9 af  0a f6 74 df  cd a6 06 e8  04 d3 6e 42
|   ff 14 32 b5  9c 37 06 7f  21 92 55 1e  d1 38 3e 45
|   60 6a 0d fd  58 52 22 e7  8c 59 49 85  23 d4 fd 77
|   f5 95 b7 c1  c2 b7 0b cd  e3 98 9c 88  67 24 46 c2
|   28 c3 22 85  ce f9 f6 0a  e9 fe 59 af  09 21 3e 44
|   36 21 f7 8e  57 8b 3f 53  cb 49 f3 e7  58 18 6b ba
|   b9 ad c8 ec  01 9c a1 38  85 c1 d2 0f  b9 39 54 f8
|   78 d2 bf ba  4b 47 22 98  53 49 57 3d  18 f3 a2 5e
|   f6 26 9a 33  75 50 32 0c  8f 13 a9 d5  3a 2a db 11
|   d0 90 ec 78  f2 65 6b 6c  7d 71 bf d4  e9 7a 3a 54
|   e0 6f 21 04  d4 fd 74 99  14 fa 39 e5  cb c8 f5 5c
|   0a 09 ef 23  71 53 a4 24  0b 13 6d 8e  e5 94 ab 55
|   0c 48 c2 03  01 fe 7a ea  84 a6 28 f2  67 40 d2 9f
|   19 3e 2c 5c  cd 44 c4 ec  fa 44 f5 4d  f5 23 eb c4
|   13 0f 35 14  9c fd 82 67  2a ba 7e 5b  01 22 16 82
|   ba 43 7d f0  d3 91 1e a4  d2 9e 35 d1
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   58 cf bc ae  e1 b7 ab b1
|    responder cookie:
|   fa 21 86 f7  33 60 84 69
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  72 d4 5d 67
|    length: 332
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_QUICK (32), msgid: 1926520167
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  58 cf bc ae  e1 b7 ab b1
| RCOOKIE:  fa 21 86 f7  33 60 84 69
| state hash entry 7
| v1 peer and cookies match on #11, provided msgid 72d45d67 vs 00000000
| v1 state object not found
| ICOOKIE:  58 cf bc ae  e1 b7 ab b1
| RCOOKIE:  fa 21 86 f7  33 60 84 69
| state hash entry 7
| v1 peer and cookies match on #11, provided msgid 00000000 vs 00000000
| v1 state object #11 found, in STATE_MAIN_R3
| processing connection mytunnel
| last Phase 1 IV:  92 d4 b7 c0  6e 47 fd da  b1 70 bb 6b  4e 66 06 b1
| current Phase 1 IV:  92 d4 b7 c0  6e 47 fd da  b1 70 bb 6b  4e 66 06 b1
| computed Phase 2 IV:
|   03 49 06 80  e9 f9 52 7d  de ef 16 e8  94 a0 35 ef
|   46 2e 3e 69
| received encrypted packet from 10.0.2.14:500
| decrypting 304 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   01 00 00 18  22 26 69 83  e4 fb 28 3b  8c 32 68 a4
|   56 c5 54 a5  83 5b 52 40  0a 00 00 38  00 00 00 01
|   00 00 00 01  00 00 00 2c  00 03 04 01  42 b3 21 12
|   00 00 00 20  00 0c 00 00  80 03 00 05  80 04 00 01
|   80 01 00 01  80 02 70 80  80 05 00 02  80 06 00 80
|   04 00 00 14  d9 9c bc e5  c5 4e b9 6e  60 ad 3f 6e
|   3a d0 3a 55  00 00 00 c4  e4 b9 be 74  2a 09 b3 06
|   d8 28 33 ce  65 1c 8c 4c  49 6d 81 79  ce 04 39 d5
|   f0 36 a6 07  26 a8 a0 8c  28 e9 77 98  88 b8 f8 cb
|   38 bf ae 1c  17 9b 86 38  49 32 46 94  d1 90 17 60
|   28 29 73 d7  07 18 8d 45  71 53 b0 a5  12 a2 dd f3
|   97 17 57 ad  90 cf bc 4f  01 df 6d 27  fb 56 20 53
|   3c 83 31 10  28 51 a8 5f  2a cc ba 47  59 c2 f8 4e
|   92 61 04 83  45 30 33 0b  5f 65 4e 8f  b7 61 bf bf
|   35 5f fd 85  7b a0 56 71  f6 4a e6 bf  78 6f fd ac
|   ea 62 f6 8e  a8 2d 97 90  79 39 10 5b  25 35 2f a6
|   6a cb 2e 81  35 5f 74 2c  e6 7e 67 e1  1b c2 56 3a
|   71 f3 ba 5d  db 55 8b 1b  26 65 21 a7  57 92 a9 78
|   df f0 2c f9  f9 76 b4 47  00 00 00 00  00 00 00 00
| next IV:  01 22 16 82  ba 43 7d f0  d3 91 1e a4  d2 9e 35 d1
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x502 opt: 0x200030
| ***parse ISAKMP Hash Payload:
|    length: 24
| got payload 0x2(ISAKMP_NEXT_SA) needed: 0x402 opt: 0x200030
| ***parse ISAKMP Security Association Payload:
|    length: 56
|    DOI: ISAKMP_DOI_IPSEC
| got payload 0x400(ISAKMP_NEXT_NONCE) needed: 0x400 opt: 0x200030
| ***parse ISAKMP Nonce Payload:
|    length: 20
| got payload 0x10(ISAKMP_NEXT_KE) needed: 0x0 opt: 0x200030
| ***parse ISAKMP Key Exchange Payload:
|    length: 196
| removing 8 bytes of padding
| HASH(1) computed:
|   22 26 69 83  e4 fb 28 3b  8c 32 68 a4  56 c5 54 a5
|   83 5b 52 40
"mytunnel" #11: the peer proposed: 10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0
| find_client_connection starting with mytunnel
|   looking for 10.0.2.15/32:0/0 -> 10.0.2.14/32:0/0
|   concrete checking against sr#0 10.0.2.15/32 -> 10.0.2.14/32
| client wildcard: no  port wildcard: no  virtual: no
| duplicating state object #11
| creating state object #12 at 0x5650f33873d0
| processing connection mytunnel
| ICOOKIE:  58 cf bc ae  e1 b7 ab b1
| RCOOKIE:  fa 21 86 f7  33 60 84 69
| state hash entry 7
| inserting state object #12 bucket: 7
| inserting event EVENT_SO_DISCARD, timeout in 0 seconds for #12 (head of queue)
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 44
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| parsing 4 raw bytes of ISAKMP Proposal Payload into SPI
| SPI  42 b3 21 12
| *****parse ISAKMP Transform Payload (ESP):
|    length: 32
|    transform number: 0
|    transform ID: ESP_AES
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: ENCAPSULATION_MODE
|    length/value: 1
|    [1 is ENCAPSULATION_MODE_TUNNEL]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_TYPE
|    length/value: 1
|    [1 is SA_LIFE_TYPE_SECONDS]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_DURATION
|    length/value: 28800
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: AUTH_ALGORITHM
|    length/value: 2
|    [2 is AUTH_ALGORITHM_HMAC_SHA1]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: KEY_LENGTH
|    length/value: 128
| kernel_alg_esp_enc_ok(12,128): alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| DH public value received:
|   e4 b9 be 74  2a 09 b3 06  d8 28 33 ce  65 1c 8c 4c
|   49 6d 81 79  ce 04 39 d5  f0 36 a6 07  26 a8 a0 8c
|   28 e9 77 98  88 b8 f8 cb  38 bf ae 1c  17 9b 86 38
|   49 32 46 94  d1 90 17 60  28 29 73 d7  07 18 8d 45
|   71 53 b0 a5  12 a2 dd f3  97 17 57 ad  90 cf bc 4f
|   01 df 6d 27  fb 56 20 53  3c 83 31 10  28 51 a8 5f
|   2a cc ba 47  59 c2 f8 4e  92 61 04 83  45 30 33 0b
|   5f 65 4e 8f  b7 61 bf bf  35 5f fd 85  7b a0 56 71
|   f6 4a e6 bf  78 6f fd ac  ea 62 f6 8e  a8 2d 97 90
|   79 39 10 5b  25 35 2f a6  6a cb 2e 81  35 5f 74 2c
|   e6 7e 67 e1  1b c2 56 3a  71 f3 ba 5d  db 55 8b 1b
|   26 65 21 a7  57 92 a9 78  df f0 2c f9  f9 76 b4 47
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do build_kenonce op on seq: 23 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #12
! helper 0 read 2752+4/2760 bytesfd: 8
! helper 0 doing build_kenonce op id: 23
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #12 
| event added after event EVENT_PENDING_PHASE2
! Local DH secret:
| complete state transition with STF_SUSPEND
"mytunnel" #12: [PIET]   read_packet returned false...(demux.c)
!   56 9e 79 c5  32 17 0e 8b  7b b1 96 49  19 d3 2f da
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
!   0f 52 58 b6  22 11 66 af  b4 83 dd f2  b7 eb d2 6d
| next event EVENT_PENDING_DDNS in 58 seconds
| next event EVENT_PENDING_DDNS in 58 seconds
! Public DH value sent:
!   bd b9 3d f3  dd 99 6d f1  b1 50 4b 86  89 2c dc 40
!   8a 1f 1c ec  70 b6 54 f3  98 44 bb a4  dc c2 19 21
!   69 29 e2 24  24 cc 1b 79  e3 87 5e 68  8b 54 f8 fd
!   ff a2 fc af  5a a2 2d 15  70 b6 d6 13  8f 1a 94 b3
!   1f 91 d5 72  f7 db ac c4  57 92 d3 e0  16 ea cc 05
!   84 4f 8b 14  31 77 d5 c2  dc fb 62 47  44 fd 80 18
!   95 27 56 51  8e 78 57 b3  59 b7 2d 0e  c7 f5 e5 38
!   ec 06 3d 23  ba ba d4 33  cd d8 37 9d  6c 8a 80 c3
!   99 a5 bf 19  a0 2a 7b fe  e4 95 94 c4  26 81 7e 8d
!   56 ee b9 cb  37 0c 8c dd  9f 95 81 99  d9 76 fc 32
!   23 7e 26 c5  c8 c3 e7 61  39 12 d3 48  1c bd bc b8
!   3e 39 18 d3  2a 78 89 fa  a1 d4 64 15  89 98 d9 95
! Generated nonce:
!   96 86 e6 86  6f 48 80 a8  de af 63 96  c0 df 01 9a
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#23
| calling callback function 0x5650f230ae60
| quick inI1_outR1: calculated ke+nonce, calculating DH
| processing connection mytunnel
| started looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| actually looking for secret for 10.0.2.15->10.0.2.14 of kind PPK_PSK
| line 16: key type PPK_PSK(10.0.2.15) to type PPK_PSK 
| 1: compared key 10.0.2.15 to 10.0.2.15 / 10.0.2.14 -> 8
| 2: compared key 10.0.2.14 to 10.0.2.15 / 10.0.2.14 -> 12
| line 16: match=12 
| best_match 0>12 line=16
| line 1: key type PPK_PSK(10.0.2.15) to type PPK_RSA 
| concluding with best_match=12 lineno=16
| 0: w->pcw_dead: 0 w->pcw_work: 0 cnt: 1
| asking helper 0 to do compute dh(p2) op on seq: 24 (len=2760, pcw_work=1)
| crypto helper write of request: cnt=2760<wlen=2760.  
| deleting event for #12
| inserting event EVENT_CRYPTO_FAILED, timeout in 300 seconds for #12 
! helper 0 read 2752+4/2760 bytesfd: 8
| event added after event EVENT_PENDING_PHASE2
| * processed 1 messages from cryptographic helpers 
! helper 0 doing compute dh(p2) op id: 24
| next event EVENT_PENDING_DDNS in 58 seconds
| next event EVENT_PENDING_DDNS in 58 seconds
! peer's g:   e4 b9 be 74  2a 09 b3 06  d8 28 33 ce  65 1c 8c 4c
! peer's g:   49 6d 81 79  ce 04 39 d5  f0 36 a6 07  26 a8 a0 8c
! peer's g:   28 e9 77 98  88 b8 f8 cb  38 bf ae 1c  17 9b 86 38
! peer's g:   49 32 46 94  d1 90 17 60  28 29 73 d7  07 18 8d 45
! peer's g:   71 53 b0 a5  12 a2 dd f3  97 17 57 ad  90 cf bc 4f
! peer's g:   01 df 6d 27  fb 56 20 53  3c 83 31 10  28 51 a8 5f
! peer's g:   2a cc ba 47  59 c2 f8 4e  92 61 04 83  45 30 33 0b
! peer's g:   5f 65 4e 8f  b7 61 bf bf  35 5f fd 85  7b a0 56 71
! peer's g:   f6 4a e6 bf  78 6f fd ac  ea 62 f6 8e  a8 2d 97 90
! peer's g:   79 39 10 5b  25 35 2f a6  6a cb 2e 81  35 5f 74 2c
! peer's g:   e6 7e 67 e1  1b c2 56 3a  71 f3 ba 5d  db 55 8b 1b
! peer's g:   26 65 21 a7  57 92 a9 78  df f0 2c f9  f9 76 b4 47
! calc_dh_shared(): time elapsed (OAKLEY_GROUP_MODP1536): 573 usec
! DH shared-secret:
!   8a 4f a3 e0  cb 19 1d 55  a5 ec f0 e4  aa 97 3d dc
!   fe 96 83 3c  da 4e 32 f0  cd c1 e5 0c  b3 f3 db 44
!   e4 ee 5b 08  67 70 35 61  71 dc 42 ce  88 31 f2 ef
!   be 63 fd 82  37 c8 31 18  9c 3c c2 91  18 d5 70 69
!   40 11 fe 4d  05 37 b9 a0  ca 19 ce dd  b2 a1 1f 26
!   7d 08 67 c8  75 ec 21 ef  18 69 6d 42  ab 18 84 0f
!   a6 02 25 e9  c7 27 0a a2  58 b8 18 2a  eb 54 6d a4
!   01 4e 67 40  a6 75 84 4c  a6 1f 3b d3  2f ac 94 cb
!   38 11 07 28  8b a1 65 23  11 a0 c8 6a  25 b6 4d 38
!   cd a4 7e db  4c 35 c1 ba  7d 44 46 39  38 1b 8e 12
!   41 6d bc 04  5c 1b 75 2d  75 39 1c 6b  98 0a 8d e4
!   9a 73 fc 87  48 c7 f2 2d  04 53 a0 c5  96 0f 33 40
|  
| helper 0 has finished work (cnt now 1)
| helper 0 replies to id: q#24
| calling callback function 0x5650f230b210
| quick inI1_outR1: calculated DH, sending R1
| processing connection mytunnel
| **emit ISAKMP Message:
|    initiator cookie:
|   58 cf bc ae  e1 b7 ab b1
|    responder cookie:
|   fa 21 86 f7  33 60 84 69
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  72 d4 5d 67
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Security Association Payload:
|    DOI: ISAKMP_DOI_IPSEC
| ****parse IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****parse ISAKMP Proposal Payload:
|    length: 44
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| parsing 4 raw bytes of ISAKMP Proposal Payload into SPI
| SPI  42 b3 21 12
| *****parse ISAKMP Transform Payload (ESP):
|    length: 32
|    transform number: 0
|    transform ID: ESP_AES
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: GROUP_DESCRIPTION
|    length/value: 5
|    [5 is OAKLEY_GROUP_MODP1536]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: ENCAPSULATION_MODE
|    length/value: 1
|    [1 is ENCAPSULATION_MODE_TUNNEL]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_TYPE
|    length/value: 1
|    [1 is SA_LIFE_TYPE_SECONDS]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: SA_LIFE_DURATION
|    length/value: 28800
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: AUTH_ALGORITHM
|    length/value: 2
|    [2 is AUTH_ALGORITHM_HMAC_SHA1]
| ******parse ISAKMP IPsec DOI attribute:
|    af+type: KEY_LENGTH
|    length/value: 128
| kernel_alg_esp_enc_ok(12,128): alg_id=12, alg_ivlen=8, alg_minbits=128, alg_maxbits=256, res=0, ret=1
| ****emit IPsec DOI SIT:
|    IPsec DOI SIT: SIT_IDENTITY_ONLY
| ****emit ISAKMP Proposal Payload:
|    proposal number: 0
|    protocol ID: PROTO_IPSEC_ESP
|    SPI size: 4
|    number of transforms: 1
| netlink_get_spi: allocated 0x71868eaf for esp.0@10.0.2.15
| emitting 4 raw bytes of SPI into ISAKMP Proposal Payload
| SPI  71 86 8e af
| *****emit ISAKMP Transform Payload (ESP):
|    transform number: 0
|    transform ID: ESP_AES
| emitting 24 raw bytes of attributes into ISAKMP Transform Payload (ESP)
| attributes  80 03 00 05  80 04 00 01  80 01 00 01  80 02 70 80
| attributes  80 05 00 02  80 06 00 80
| emitting length of ISAKMP Transform Payload (ESP): 32
| emitting length of ISAKMP Proposal Payload: 44
| emitting length of ISAKMP Security Association Payload: 56
"mytunnel" #12: responding to Quick Mode proposal {msgid:675dd472}
"mytunnel" #12:     us: 10.0.2.15
"mytunnel" #12:   them: 10.0.2.14
| ***emit ISAKMP Nonce Payload:
| emitting 16 raw bytes of Nr into ISAKMP Nonce Payload
| Nr  96 86 e6 86  6f 48 80 a8  de af 63 96  c0 df 01 9a
| emitting length of ISAKMP Nonce Payload: 20
| ***emit ISAKMP Key Exchange Payload:
| emitting 192 raw bytes of keyex value into ISAKMP Key Exchange Payload
| keyex value  bd b9 3d f3  dd 99 6d f1  b1 50 4b 86  89 2c dc 40
| keyex value  8a 1f 1c ec  70 b6 54 f3  98 44 bb a4  dc c2 19 21
| keyex value  69 29 e2 24  24 cc 1b 79  e3 87 5e 68  8b 54 f8 fd
| keyex value  ff a2 fc af  5a a2 2d 15  70 b6 d6 13  8f 1a 94 b3
| keyex value  1f 91 d5 72  f7 db ac c4  57 92 d3 e0  16 ea cc 05
| keyex value  84 4f 8b 14  31 77 d5 c2  dc fb 62 47  44 fd 80 18
| keyex value  95 27 56 51  8e 78 57 b3  59 b7 2d 0e  c7 f5 e5 38
| keyex value  ec 06 3d 23  ba ba d4 33  cd d8 37 9d  6c 8a 80 c3
| keyex value  99 a5 bf 19  a0 2a 7b fe  e4 95 94 c4  26 81 7e 8d
| keyex value  56 ee b9 cb  37 0c 8c dd  9f 95 81 99  d9 76 fc 32
| keyex value  23 7e 26 c5  c8 c3 e7 61  39 12 d3 48  1c bd bc b8
| keyex value  3e 39 18 d3  2a 78 89 fa  a1 d4 64 15  89 98 d9 95
| emitting length of ISAKMP Key Exchange Payload: 196
| HASH(2) computed:
|   31 5a e5 f4  d1 81 ba c5  17 d6 8c 32  14 eb fd f6
|   99 67 a0 4f
| compute_proto_keymat:needed_len (after ESP enc)=16
| compute_proto_keymat:needed_len (after ESP auth)=36
| ESP KEYMAT 
|   KEYMAT computed:
|   de 08 1a 3d  30 54 95 aa  ab 59 c7 7c  19 72 7c 17
|   f1 32 36 e1  80 8d c3 95  f0 19 f9 8d  91 67 03 ff
|   b2 47 c4 c0
|   Peer KEYMAT computed:
|   8c db 07 a1  44 bc 15 b6  d7 8c c4 6b  ff aa 7d f1
|   50 64 ac 78  1b 31 57 da  3e 60 27 9a  c4 16 3f fc
|   a6 67 05 81
| install_inbound_ipsec_sa() checking if we can route
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| could_route called for mytunnel (kind=CK_PERMANENT)
|    routing is easy, or has resolvable near-conflict
| checking if this is a replacement state
|   st=0x5650f33873d0 ost=(nil) st->serialno=#12 ost->serialno=#0 
| installing outgoing SA now as refhim=0
| state #12(mytunnel): setup outbound esp-ipsec between 10.0.2.15<->10.0.2.14 for 10.0.2.15/32...10.0.2.14/32
| ipcomp maybe
| esp outbound maybe
| looking for outbound alg with transid: 12 keylen: 128 auth: 2 for spi=1221b342 [10.0.2.15->10.0.2.14] 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| ESP enckey:  8c db 07 a1  44 bc 15 b6  d7 8c c4 6b  ff aa 7d f1
| ESP authkey:  50 64 ac 78  1b 31 57 da  3e 60 27 9a  c4 16 3f fc
| ESP authkey:  a6 67 05 81
| creating SA spi=42b32112@0a00020e proto=50 family=2
| outgoing SA has refhim=4294901761
| state #12(mytunnel): setup inbound esp-ipsec between 10.0.2.14<->10.0.2.15 for 10.0.2.14/32...10.0.2.15/32
| ipcomp maybe
| esp inbound maybe
| looking for inbound alg with transid: 12 keylen: 128 auth: 2 for spi=af8e8671 [10.0.2.14->10.0.2.15] 
| checking transid: 11 keylen: 0 auth: 1 
| checking transid: 11 keylen: 0 auth: 2 
| checking transid: 2 keylen: 8 auth: 0 
| checking transid: 2 keylen: 8 auth: 1 
| checking transid: 2 keylen: 8 auth: 2 
| checking transid: 3 keylen: 24 auth: 0 
| checking transid: 3 keylen: 24 auth: 1 
| checking transid: 3 keylen: 24 auth: 2 
| checking transid: 12 keylen: 16 auth: 0 
| checking transid: 12 keylen: 16 auth: 1 
| checking transid: 12 keylen: 16 auth: 2 
| ESP enckey:  de 08 1a 3d  30 54 95 aa  ab 59 c7 7c  19 72 7c 17
| ESP authkey:  f1 32 36 e1  80 8d c3 95  f0 19 f9 8d  91 67 03 ff
| ESP authkey:  b2 47 c4 c0
| updating SA spi=71868eaf@0a00020f proto=50 family=2
| creating SPD to 10.0.2.14->spi=00010000@10.0.2.15 proto=4
"mytunnel" #12: add inbound eroute 10.0.2.14/32:0 --0-> 10.0.2.15/32:0 => tun.10000@10.0.2.15 succeeded
| encrypting:
|   01 00 00 18  31 5a e5 f4  d1 81 ba c5  17 d6 8c 32
|   14 eb fd f6  99 67 a0 4f  0a 00 00 38  00 00 00 01
|   00 00 00 01  00 00 00 2c  00 03 04 01  71 86 8e af
|   00 00 00 20  00 0c 00 00  80 03 00 05  80 04 00 01
|   80 01 00 01  80 02 70 80  80 05 00 02  80 06 00 80
|   04 00 00 14  96 86 e6 86  6f 48 80 a8  de af 63 96
|   c0 df 01 9a  00 00 00 c4  bd b9 3d f3  dd 99 6d f1
|   b1 50 4b 86  89 2c dc 40  8a 1f 1c ec  70 b6 54 f3
|   98 44 bb a4  dc c2 19 21  69 29 e2 24  24 cc 1b 79
|   e3 87 5e 68  8b 54 f8 fd  ff a2 fc af  5a a2 2d 15
|   70 b6 d6 13  8f 1a 94 b3  1f 91 d5 72  f7 db ac c4
|   57 92 d3 e0  16 ea cc 05  84 4f 8b 14  31 77 d5 c2
|   dc fb 62 47  44 fd 80 18  95 27 56 51  8e 78 57 b3
|   59 b7 2d 0e  c7 f5 e5 38  ec 06 3d 23  ba ba d4 33
|   cd d8 37 9d  6c 8a 80 c3  99 a5 bf 19  a0 2a 7b fe
|   e4 95 94 c4  26 81 7e 8d  56 ee b9 cb  37 0c 8c dd
|   9f 95 81 99  d9 76 fc 32  23 7e 26 c5  c8 c3 e7 61
|   39 12 d3 48  1c bd bc b8  3e 39 18 d3  2a 78 89 fa
|   a1 d4 64 15  89 98 d9 95
| IV:
|   01 22 16 82  ba 43 7d f0  d3 91 1e a4  d2 9e 35 d1
| unpadded size is: 296
| emitting 8 zero bytes of encryption padding into ISAKMP Message
| encrypting 304 using OAKLEY_AES_CBC
| next IV:  c4 84 37 3e  2a 7b cb 47  09 ed 54 70  0c b2 f6 39
| emitting length of ISAKMP Message: 332
| finished processing quick inI1
| complete state transition with STF_OK
"mytunnel" #12: transition from state STATE_QUICK_R0 to state STATE_QUICK_R1
| deleting event for #12
| sending reply packet to 10.0.2.14:500 (from port 500)
| sending 332 bytes for STATE_QUICK_R0 through enp0s3:500 to 10.0.2.14:500 (using #12)
|   58 cf bc ae  e1 b7 ab b1  fa 21 86 f7  33 60 84 69
|   08 10 20 01  72 d4 5d 67  00 00 01 4c  2d cf c2 71
|   6f e4 62 10  94 cc 4f 35  f9 bc 25 28  b7 48 1b f9
|   dc f7 a2 4b  62 82 67 1e  6d 0a 59 38  10 f9 e1 16
|   4b 83 33 c9  cf b1 7c ff  64 6b 53 2a  3b 55 bb f9
|   3e 1c a7 9a  c6 ea 2c 4b  69 f9 f6 da  71 8a 6c 99
|   41 58 da 67  a2 b3 80 c3  a5 c6 07 90  5a 4c f0 42
|   41 57 d2 31  52 86 b4 2e  e7 1d cf b8  7e e6 09 c5
|   3b 1b 91 16  67 03 06 df  4b 35 b7 61  15 8a c8 9d
|   07 51 27 d5  36 a2 81 8b  68 9a ae 37  23 cc 16 90
|   1d 37 57 7e  32 75 45 47  23 b4 b8 4c  c6 ce 19 80
|   d9 33 b3 f6  41 0d b5 05  75 11 0b a6  fc bb 36 03
|   97 ce bf 5d  a7 84 a5 ad  89 cc 89 9f  a6 92 87 e2
|   68 d6 f2 3f  a9 8b 80 07  43 4d d1 3a  69 29 b5 b5
|   ce 11 39 64  e8 1d 4c c0  66 b8 35 5e  d3 2e 6f 70
|   2b bf 86 37  d2 f7 ec e0  e3 5e 8f e1  41 94 95 5d
|   29 1f 90 ac  a2 81 a5 5a  63 67 6e 4c  3c 6d ce 7c
|   50 9b df f7  f2 3e b7 a6  fd d4 e3 c6  af 15 f8 20
|   9f 80 f9 07  d1 c1 90 96  e8 0c 00 b4  c5 8f 90 44
|   d5 45 7a 04  cf bc c1 c5  a7 ec 41 18  c4 84 37 3e
|   2a 7b cb 47  09 ed 54 70  0c b2 f6 39
| inserting event EVENT_RETRANSMIT, timeout in 10 seconds for #12 (head of queue)
"mytunnel" #12: STATE_QUICK_R1: sent QR1, inbound IPsec SA installed, expecting QI2
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
| * processed 1 messages from cryptographic helpers 
| next event EVENT_RETRANSMIT in 10 seconds for #12 (2020-01-27 11:24:14)
| next event EVENT_RETRANSMIT in 10 seconds for #12 (2020-01-27 11:24:14)
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
<
| *received 60 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:24:15
|   58 cf bc ae  e1 b7 ab b1  fa 21 86 f7  33 60 84 69
|   08 10 20 01  72 d4 5d 67  00 00 00 3c  91 44 c2 c4
|   df e4 43 9f  72 d6 61 41  5c 1d f3 b4  f5 7e da fb
|   ec 69 62 5f  9c d5 ff 13  0b c3 56 b6
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   58 cf bc ae  e1 b7 ab b1
|    responder cookie:
|   fa 21 86 f7  33 60 84 69
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_QUICK
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  72 d4 5d 67
|    length: 60
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_QUICK (32), msgid: 1926520167
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  58 cf bc ae  e1 b7 ab b1
| RCOOKIE:  fa 21 86 f7  33 60 84 69
| state hash entry 7
| v1 peer and cookies match on #12, provided msgid 72d45d67 vs 72d45d67
| v1 state object #12 found, in STATE_QUICK_R1
| processing connection mytunnel
| received encrypted packet from 10.0.2.14:500
| decrypting 32 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   00 00 00 18  6e 80 f3 08  2a fe 58 4c  ab 6a c1 11
|   9c 71 7d 7f  c5 98 6d 14  00 00 00 00  00 00 00 00
| next IV:  f5 7e da fb  ec 69 62 5f  9c d5 ff 13  0b c3 56 b6
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x0
| ***parse ISAKMP Hash Payload:
|    length: 24
| removing 8 bytes of padding
| HASH(3) computed:  6e 80 f3 08  2a fe 58 4c  ab 6a c1 11  9c 71 7d 7f
| HASH(3) computed:  c5 98 6d 14
| state #12: install_ipsec_sa() for outbound only
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| could_route called for mytunnel (kind=CK_PERMANENT)
| state #12: now setting up incoming SA
| sr for #12: prospective erouted (eroute_owner: #0)
| route owner of "mytunnel" prospective erouted: self; eroute owner: self
| route_and_eroute with c: mytunnel (next: none) ero:mytunnel esr:{(nil)} ro:mytunnel rosr:{(nil)} and state: 12
| eroute_connection: between 10.0.2.15<->10.0.2.14
| creating SPD to 10.0.2.15->spi=00000000@10.0.2.14 proto=4
"mytunnel" #12: eroute_connection replace eroute 10.0.2.15/32:0 --0-> 10.0.2.14/32:0 => tun.0@10.0.2.14 succeeded
| command executing up-host
| executing up-host: 2>&1 PLUTO_VERB='up-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| route_and_eroute: firewall_notified: true
| route_and_eroute: instance "mytunnel", setting eroute_owner to #12 (was #0) (newest_ipsec_sa=#0)
| inI2: instance mytunnel[0], setting newest_ipsec_sa to #12 (was #0) (spd.eroute=#12)
| complete state transition with STF_OK
"mytunnel" #12: transition from state STATE_QUICK_R1 to state STATE_QUICK_R2
| deleting event for #12
| inserting event EVENT_SA_REPLACE, timeout in 28530 seconds for #12 
| event added after event EVENT_SA_REPLACE for #11
"mytunnel" #12: STATE_QUICK_R2: IPsec SA established tunnel mode {ESP=>0x42b32112 <0x71868eaf xfrm=AES_128-HMAC_SHA1 NATOA=none NATD=none DPD=none}
| modecfg pull: noquirk policy:push not-client
| phase 1 is done, looking for phase 2 to unpend
"mytunnel" #12: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 57 seconds
| next event EVENT_PENDING_DDNS in 57 seconds
|  
[PIET]   before call to comm_handle...(server.c)
[PIET]   before alloc_md()...(demux.c)
[PIET] from...(demux.c)
\002
[PIET] from.sa...(demux.c)
\002
[PIET] packet_len...(demux.c)
L
| *received 76 bytes from 10.0.2.14:500 on enp0s3 (port=500) at 2020-01-27 11:24:27
|   58 cf bc ae  e1 b7 ab b1  fa 21 86 f7  33 60 84 69
|   08 10 05 01  ec 4d 30 7c  00 00 00 4c  35 52 1b a0
|   85 7d b6 9a  ba a0 e9 e2  3b 33 61 0d  6d ad ed 21
|   e9 50 1a ab  21 07 f5 7a  06 0d a0 73  13 2e 35 56
|   1c e6 8e bf  45 ea e0 26  1b dd 5f 8c
packet from 10.0.2.14:500: [PIET]:   process_packet started...(demux.c)
| **parse ISAKMP Message:
|    initiator cookie:
|   58 cf bc ae  e1 b7 ab b1
|    responder cookie:
|   fa 21 86 f7  33 60 84 69
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  ec 4d 30 7c
|    length: 76
|  processing version=1.0 packet with exchange type=ISAKMP_XCHG_INFO (5), msgid: 3964481660
packet from 10.0.2.14:500: [PIET]:   Pre TCLCALLOUT...(demux.c)
packet from 10.0.2.14:500: [PIET] process_v1_packet called...(ikev1.c)
| ICOOKIE:  58 cf bc ae  e1 b7 ab b1
| RCOOKIE:  fa 21 86 f7  33 60 84 69
| state hash entry 7
| peer and cookies match on #12, provided msgid 00000000 vs 72d45d67/00000000
| peer and cookies match on #11, provided msgid 00000000 vs 00000000/00000000
| p15 state object #11 found, in STATE_MAIN_R3
| processing connection mytunnel
| last Phase 1 IV:  92 d4 b7 c0  6e 47 fd da  b1 70 bb 6b  4e 66 06 b1
| current Phase 1 IV:  92 d4 b7 c0  6e 47 fd da  b1 70 bb 6b  4e 66 06 b1
| computed Phase 2 IV:
|   85 b8 10 b7  89 19 07 d2  b0 aa c5 ba  92 36 16 e6
|   d0 65 d7 0d
| received encrypted packet from 10.0.2.14:500
| decrypting 48 bytes using algorithm OAKLEY_AES_CBC
| decrypted:
|   0c 00 00 18  3d e4 c5 ef  a2 d2 fa bc  f2 0d 4f aa
|   d6 8f 44 1f  ed a1 dc 60  00 00 00 10  00 00 00 01
|   03 04 00 01  42 b3 21 12  00 00 00 00  00 00 00 00
| next IV:  13 2e 35 56  1c e6 8e bf  45 ea e0 26  1b dd 5f 8c
| got payload 0x100(ISAKMP_NEXT_HASH) needed: 0x100 opt: 0x0
| ***parse ISAKMP Hash Payload:
|    length: 24
| got payload 0x1000(ISAKMP_NEXT_D) needed: 0x0 opt: 0x0
| ***parse ISAKMP Delete Payload:
|    length: 16
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 3
|    SPI size: 4
|    number of SPIs: 1
| removing 8 bytes of padding
| HASH(1) computed:
|   3d e4 c5 ef  a2 d2 fa bc  f2 0d 4f aa  d6 8f 44 1f
|   ed a1 dc 60
| received 'informational' message HASH(1) data ok
| processing connection mytunnel
"mytunnel" #11: received Delete SA(0x42b32112) payload: deleting IPSEC State #12
"mytunnel" #11: deleting state #12 (STATE_QUICK_R2)
| find_phase1_state: found SA #11 for conn 'mytunnel' in state STATE_MAIN_R3
| **emit ISAKMP Message:
|    initiator cookie:
|   58 cf bc ae  e1 b7 ab b1
|    responder cookie:
|   fa 21 86 f7  33 60 84 69
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  b8 fc 64 72
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH(1) into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Delete Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 3
|    SPI size: 4
|    number of SPIs: 1
| emitting 4 raw bytes of delete payload into ISAKMP Delete Payload
| delete payload  71 86 8e af
| emitting length of ISAKMP Delete Payload: 16
| HASH(1) computed:
|   20 a1 69 7a  73 a0 63 ec  aa 0a 19 23  2b ca 30 3f
|   15 da b1 7e
| last Phase 1 IV:  92 d4 b7 c0  6e 47 fd da  b1 70 bb 6b  4e 66 06 b1
| current Phase 1 IV:  92 d4 b7 c0  6e 47 fd da  b1 70 bb 6b  4e 66 06 b1
| computed Phase 2 IV:
|   33 88 8b e8  82 f6 d1 e8  d3 60 3e 5f  5b 6a 57 2d
|   9f ef 9f ad
| encrypting:
|   0c 00 00 18  20 a1 69 7a  73 a0 63 ec  aa 0a 19 23
|   2b ca 30 3f  15 da b1 7e  00 00 00 10  00 00 00 01
|   03 04 00 01  71 86 8e af
| IV:
|   33 88 8b e8  82 f6 d1 e8  d3 60 3e 5f  5b 6a 57 2d
|   9f ef 9f ad
| unpadded size is: 40
| emitting 8 zero bytes of encryption padding into ISAKMP Message
| encrypting 48 using OAKLEY_AES_CBC
| next IV:  a6 75 5d 0e  5a fb 96 16  b2 e3 ae 0b  8c 6e a0 af
| emitting length of ISAKMP Message: 76
| sending 76 bytes for delete notify through enp0s3:500 to 10.0.2.14:500 (using #11)
|   58 cf bc ae  e1 b7 ab b1  fa 21 86 f7  33 60 84 69
|   08 10 05 01  b8 fc 64 72  00 00 00 4c  1d 27 fa 75
|   74 4e 08 2f  a8 e3 ed 3b  4e 48 c3 8f  89 d4 0f 17
|   03 3b 1e dc  06 b0 97 f1  de 39 77 ff  a6 75 5d 0e
|   5a fb 96 16  b2 e3 ae 0b  8c 6e a0 af
| deleting event for #12
| no suspended cryptographic state for 12 
| removing state object #12
| ICOOKIE:  58 cf bc ae  e1 b7 ab b1
| RCOOKIE:  fa 21 86 f7  33 60 84 69
| state hash entry 7
| command executing down-host
| executing down-host: 2>&1 PLUTO_VERB='down-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4' PLUTO_XAUTH_USERNAME=''  PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| request to replace with shunt a prospective erouted policy with netkey kernel --- experimental
| creating SPD to 10.0.2.15->spi=00000104@0.0.0.0 proto=61
| delete esp.42b32112@10.0.2.14
| creating SPD to 10.0.2.14->spi=00010000@10.0.2.15 proto=255
"mytunnel" #11: delete (half) inbound eroute 10.0.2.14/32:0 --0-> 10.0.2.15/32:0 => unk255.10000@10.0.2.15 succeeded
| delete esp.71868eaf@10.0.2.15
| del:  42 b3 21 12
"mytunnel" #11: received and ignored informational message
| complete state transition with STF_IGNORE
"mytunnel" #11: [PIET]   read_packet returned false...(demux.c)
[PIET]   after call to comm_handle...(server.c)
| * processed 0 messages from cryptographic helpers 
| next event EVENT_PENDING_DDNS in 45 seconds
| next event EVENT_PENDING_DDNS in 45 seconds
| deleting event for #12
| freeing state object #12
|  
| *received whack message
shutting down
forgetting secrets
| unreference key: 0x5650f337e230 (none) cnt 1--
| processing connection mytunnel
"mytunnel": deleting connection
| pass 0: considering CHILD SAs to delete
| pass 1: considering PARENT SAs to delete
| processing connection mytunnel
| deleting event for #11
"mytunnel" #11: deleting state #11 (STATE_MAIN_R3)
| **emit ISAKMP Message:
|    initiator cookie:
|   58 cf bc ae  e1 b7 ab b1
|    responder cookie:
|   fa 21 86 f7  33 60 84 69
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  1d aa c7 21
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH(1) into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Delete Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 16
|    number of SPIs: 1
| emitting 16 raw bytes of delete payload into ISAKMP Delete Payload
| delete payload  58 cf bc ae  e1 b7 ab b1  fa 21 86 f7  33 60 84 69
| emitting length of ISAKMP Delete Payload: 28
| HASH(1) computed:
|   56 41 47 62  8b 81 7c f0  24 a4 a9 fe  1c 95 36 cd
|   1f 43 dd 45
| last Phase 1 IV:  92 d4 b7 c0  6e 47 fd da  b1 70 bb 6b  4e 66 06 b1
| current Phase 1 IV:  92 d4 b7 c0  6e 47 fd da  b1 70 bb 6b  4e 66 06 b1
| computed Phase 2 IV:
|   23 aa b3 3e  fb d8 80 87  19 53 1a fc  fa f2 22 4d
|   6d 6c 1c e4
| encrypting:
|   0c 00 00 18  56 41 47 62  8b 81 7c f0  24 a4 a9 fe
|   1c 95 36 cd  1f 43 dd 45  00 00 00 1c  00 00 00 01
|   01 10 00 01  58 cf bc ae  e1 b7 ab b1  fa 21 86 f7
|   33 60 84 69
| IV:
|   23 aa b3 3e  fb d8 80 87  19 53 1a fc  fa f2 22 4d
|   6d 6c 1c e4
| unpadded size is: 52
| emitting 12 zero bytes of encryption padding into ISAKMP Message
| encrypting 64 using OAKLEY_AES_CBC
| next IV:  a8 8b 8c 8d  64 57 b3 c1  9f 34 3e a9  c6 44 3f 9f
| emitting length of ISAKMP Message: 92
| sending 92 bytes for delete notify through enp0s3:500 to 10.0.2.14:500 (using #11)
|   58 cf bc ae  e1 b7 ab b1  fa 21 86 f7  33 60 84 69
|   08 10 05 01  1d aa c7 21  00 00 00 5c  93 40 80 0c
|   c1 94 f7 7c  48 00 b7 b5  c5 65 46 70  fe 41 50 f7
|   09 72 13 d5  0b 23 89 7a  23 7d 09 79  b3 65 97 18
|   44 68 71 a0  ca 23 47 73  ce c8 4a 57  a8 8b 8c 8d
|   64 57 b3 c1  9f 34 3e a9  c6 44 3f 9f
| deleting event for #11
| no suspended cryptographic state for 11 
| removing state object #11
| ICOOKIE:  58 cf bc ae  e1 b7 ab b1
| RCOOKIE:  fa 21 86 f7  33 60 84 69
| state hash entry 7
| processing connection mytunnel
| deleting event for #5
"mytunnel" #5: deleting state #5 (STATE_MAIN_R3)
| **emit ISAKMP Message:
|    initiator cookie:
|   54 c7 88 f2  d1 90 5f 9e
|    responder cookie:
|   ec 02 3f 64  da 0e e2 f8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  a3 e6 ec 10
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH(1) into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Delete Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 16
|    number of SPIs: 1
| emitting 16 raw bytes of delete payload into ISAKMP Delete Payload
| delete payload  54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
| emitting length of ISAKMP Delete Payload: 28
| HASH(1) computed:
|   b6 37 88 dd  95 c1 06 5d  1e 9b 17 52  34 d7 09 57
|   9a 5c 5f 64
| last Phase 1 IV:  ca fc 45 9a  a4 18 32 87  21 42 a8 9b  58 f1 47 1b
| current Phase 1 IV:  ca fc 45 9a  a4 18 32 87  21 42 a8 9b  58 f1 47 1b
| computed Phase 2 IV:
|   e5 40 e9 1c  73 a3 ad cc  ec 07 ee 45  19 50 ee 3c
|   23 0a 18 e9
| encrypting:
|   0c 00 00 18  b6 37 88 dd  95 c1 06 5d  1e 9b 17 52
|   34 d7 09 57  9a 5c 5f 64  00 00 00 1c  00 00 00 01
|   01 10 00 01  54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64
|   da 0e e2 f8
| IV:
|   e5 40 e9 1c  73 a3 ad cc  ec 07 ee 45  19 50 ee 3c
|   23 0a 18 e9
| unpadded size is: 52
| emitting 12 zero bytes of encryption padding into ISAKMP Message
| encrypting 64 using OAKLEY_AES_CBC
| next IV:  27 c2 31 98  11 b1 a2 17  03 36 2c e6  ae 21 54 59
| emitting length of ISAKMP Message: 92
| sending 92 bytes for delete notify through enp0s3:500 to 10.0.2.14:500 (using #5)
|   54 c7 88 f2  d1 90 5f 9e  ec 02 3f 64  da 0e e2 f8
|   08 10 05 01  a3 e6 ec 10  00 00 00 5c  d2 07 cb 9c
|   73 82 cc af  6c 9d be f0  e7 f1 0a b7  4d 29 2e 84
|   50 c2 0b 51  ba c8 36 de  6b c4 d2 79  77 28 d5 d7
|   8c b1 c9 d3  8d ae 11 26  58 38 9d 1f  27 c2 31 98
|   11 b1 a2 17  03 36 2c e6  ae 21 54 59
| deleting event for #5
| no suspended cryptographic state for 5 
| removing state object #5
| ICOOKIE:  54 c7 88 f2  d1 90 5f 9e
| RCOOKIE:  ec 02 3f 64  da 0e e2 f8
| state hash entry 8
| processing connection mytunnel
| deleting event for #1
"mytunnel" #1: deleting state #1 (STATE_MAIN_R3)
| **emit ISAKMP Message:
|    initiator cookie:
|   93 b3 b6 40  5b 39 92 24
|    responder cookie:
|   23 fb be d9  c1 97 e9 7a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  02 0e f2 66
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH(1) into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Delete Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 16
|    number of SPIs: 1
| emitting 16 raw bytes of delete payload into ISAKMP Delete Payload
| delete payload  93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
| emitting length of ISAKMP Delete Payload: 28
| HASH(1) computed:
|   d3 2f bc db  7e ca ee 15  36 e3 73 03  07 8b de ef
|   2c 4c 05 4c
| last Phase 1 IV:  74 ed 59 36  9e 1b 56 af  bc ed 89 66  2a ab cc 77
| current Phase 1 IV:  74 ed 59 36  9e 1b 56 af  bc ed 89 66  2a ab cc 77
| computed Phase 2 IV:
|   a3 7f 90 06  d0 ae 26 9d  10 a8 1a dd  c4 0b ed 43
|   76 21 56 6e
| encrypting:
|   0c 00 00 18  d3 2f bc db  7e ca ee 15  36 e3 73 03
|   07 8b de ef  2c 4c 05 4c  00 00 00 1c  00 00 00 01
|   01 10 00 01  93 b3 b6 40  5b 39 92 24  23 fb be d9
|   c1 97 e9 7a
| IV:
|   a3 7f 90 06  d0 ae 26 9d  10 a8 1a dd  c4 0b ed 43
|   76 21 56 6e
| unpadded size is: 52
| emitting 12 zero bytes of encryption padding into ISAKMP Message
| encrypting 64 using OAKLEY_AES_CBC
| next IV:  77 33 cd 05  c7 a7 fa a0  e7 b8 0d 71  43 9f 7d b2
| emitting length of ISAKMP Message: 92
| sending 92 bytes for delete notify through enp0s3:500 to 10.0.2.14:500 (using #1)
|   93 b3 b6 40  5b 39 92 24  23 fb be d9  c1 97 e9 7a
|   08 10 05 01  02 0e f2 66  00 00 00 5c  2d b2 94 c3
|   cd e9 e3 b4  70 33 91 1b  c7 24 ad ae  59 9c a9 0e
|   65 35 cd 3b  54 4b d6 2b  7a 0b 4c c6  cf 9b bb 81
|   40 50 b3 7a  4f 57 2a a5  7c 96 3b 64  77 33 cd 05
|   c7 a7 fa a0  e7 b8 0d 71  43 9f 7d b2
| deleting event for #1
| no suspended cryptographic state for 1 
| removing state object #1
| ICOOKIE:  93 b3 b6 40  5b 39 92 24
| RCOOKIE:  23 fb be d9  c1 97 e9 7a
| state hash entry 12
| processing connection mytunnel
| deleting event for #9
"mytunnel" #9: deleting state #9 (STATE_MAIN_R3)
| **emit ISAKMP Message:
|    initiator cookie:
|   c4 a7 92 f2  1a a4 1b c0
|    responder cookie:
|   77 87 1e af  e7 ae a4 3a
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  21 99 49 2c
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH(1) into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Delete Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 16
|    number of SPIs: 1
| emitting 16 raw bytes of delete payload into ISAKMP Delete Payload
| delete payload  c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
| emitting length of ISAKMP Delete Payload: 28
| HASH(1) computed:
|   ab 80 ed c5  92 a3 c1 1a  8e b3 2e ae  58 59 62 d0
|   58 d5 4d c0
| last Phase 1 IV:  10 0d cb b9  c7 c0 81 25  42 6e e1 fc  d5 af 8a 24
| current Phase 1 IV:  10 0d cb b9  c7 c0 81 25  42 6e e1 fc  d5 af 8a 24
| computed Phase 2 IV:
|   54 c7 39 81  3b d9 c5 5d  35 62 bb 1b  fb cb 68 20
|   43 7f 8b 23
| encrypting:
|   0c 00 00 18  ab 80 ed c5  92 a3 c1 1a  8e b3 2e ae
|   58 59 62 d0  58 d5 4d c0  00 00 00 1c  00 00 00 01
|   01 10 00 01  c4 a7 92 f2  1a a4 1b c0  77 87 1e af
|   e7 ae a4 3a
| IV:
|   54 c7 39 81  3b d9 c5 5d  35 62 bb 1b  fb cb 68 20
|   43 7f 8b 23
| unpadded size is: 52
| emitting 12 zero bytes of encryption padding into ISAKMP Message
| encrypting 64 using OAKLEY_AES_CBC
| next IV:  4e ec c9 d3  2d f2 1a de  23 11 ac ac  c6 42 d9 31
| emitting length of ISAKMP Message: 92
| sending 92 bytes for delete notify through enp0s3:500 to 10.0.2.14:500 (using #9)
|   c4 a7 92 f2  1a a4 1b c0  77 87 1e af  e7 ae a4 3a
|   08 10 05 01  21 99 49 2c  00 00 00 5c  0d 18 05 de
|   b3 da 52 a5  63 eb be 2c  a8 9e 6f 0f  f9 eb 1f bd
|   8a a9 ef 1e  94 26 c7 67  dc f6 4f b8  24 07 bb b6
|   18 0e dd 1d  db 91 41 96  dc 33 44 7f  4e ec c9 d3
|   2d f2 1a de  23 11 ac ac  c6 42 d9 31
| deleting event for #9
| no suspended cryptographic state for 9 
| removing state object #9
| ICOOKIE:  c4 a7 92 f2  1a a4 1b c0
| RCOOKIE:  77 87 1e af  e7 ae a4 3a
| state hash entry 24
| processing connection mytunnel
| deleting event for #3
"mytunnel" #3: deleting state #3 (STATE_MAIN_R3)
| **emit ISAKMP Message:
|    initiator cookie:
|   ce 12 dc 5e  6a b3 d6 fe
|    responder cookie:
|   bf 82 a3 57  1a d9 08 b8
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  b2 cf eb 95
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH(1) into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Delete Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 16
|    number of SPIs: 1
| emitting 16 raw bytes of delete payload into ISAKMP Delete Payload
| delete payload  ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57  1a d9 08 b8
| emitting length of ISAKMP Delete Payload: 28
| HASH(1) computed:
|   99 87 66 ef  45 c0 0c 2b  6a 2e bf b4  0c 22 f7 51
|   9a 15 9f 1a
| last Phase 1 IV:  1b a8 c5 6c  a1 5b 13 e3  14 b4 bb 71  18 32 62 3f
| current Phase 1 IV:  1b a8 c5 6c  a1 5b 13 e3  14 b4 bb 71  18 32 62 3f
| computed Phase 2 IV:
|   07 48 77 ec  68 d6 58 40  f4 7c d6 5d  82 11 8b 53
|   80 a7 45 4c
| encrypting:
|   0c 00 00 18  99 87 66 ef  45 c0 0c 2b  6a 2e bf b4
|   0c 22 f7 51  9a 15 9f 1a  00 00 00 1c  00 00 00 01
|   01 10 00 01  ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57
|   1a d9 08 b8
| IV:
|   07 48 77 ec  68 d6 58 40  f4 7c d6 5d  82 11 8b 53
|   80 a7 45 4c
| unpadded size is: 52
| emitting 12 zero bytes of encryption padding into ISAKMP Message
| encrypting 64 using OAKLEY_AES_CBC
| next IV:  f0 14 77 86  af 7c 02 6b  f8 7e fe c5  8e c9 3a 74
| emitting length of ISAKMP Message: 92
| sending 92 bytes for delete notify through enp0s3:500 to 10.0.2.14:500 (using #3)
|   ce 12 dc 5e  6a b3 d6 fe  bf 82 a3 57  1a d9 08 b8
|   08 10 05 01  b2 cf eb 95  00 00 00 5c  87 6e e1 4c
|   b4 7b c0 00  d0 32 bf 40  b1 53 ca 30  5f 56 18 93
|   3e ce 10 e3  bb ad 8a 97  cc a8 52 81  3c b0 a3 f3
|   bc 3e bb fc  05 78 fb f7  79 04 45 83  f0 14 77 86
|   af 7c 02 6b  f8 7e fe c5  8e c9 3a 74
| deleting event for #3
| no suspended cryptographic state for 3 
| removing state object #3
| ICOOKIE:  ce 12 dc 5e  6a b3 d6 fe
| RCOOKIE:  bf 82 a3 57  1a d9 08 b8
| state hash entry 29
| processing connection mytunnel
| deleting event for #7
"mytunnel" #7: deleting state #7 (STATE_MAIN_R3)
| **emit ISAKMP Message:
|    initiator cookie:
|   43 46 15 a5  3d 97 37 f2
|    responder cookie:
|   f1 c9 8a ab  81 fa bc 40
|    ISAKMP version: ISAKMP Version 1.0 (rfc2407)
|    exchange type: ISAKMP_XCHG_INFO
|    flags: ISAKMP_FLAG_ENCRYPTION
|    message ID:  45 de 64 42
| ***emit ISAKMP Hash Payload:
| emitting 20 zero bytes of HASH(1) into ISAKMP Hash Payload
| emitting length of ISAKMP Hash Payload: 24
| ***emit ISAKMP Delete Payload:
|    DOI: ISAKMP_DOI_IPSEC
|    protocol ID: 1
|    SPI size: 16
|    number of SPIs: 1
| emitting 16 raw bytes of delete payload into ISAKMP Delete Payload
| delete payload  43 46 15 a5  3d 97 37 f2  f1 c9 8a ab  81 fa bc 40
| emitting length of ISAKMP Delete Payload: 28
| HASH(1) computed:
|   a6 6b 5c 79  48 6a 9f 2a  f7 e2 4d 9e  a9 72 fe 9c
|   47 e9 62 a3
| last Phase 1 IV:  f7 71 b5 d1  71 2f b9 d4  be 51 5f 07  e5 d7 1d 86
| current Phase 1 IV:  f7 71 b5 d1  71 2f b9 d4  be 51 5f 07  e5 d7 1d 86
| computed Phase 2 IV:
|   dc 0b f4 25  80 da 6d fe  6d 47 f0 89  99 46 20 9e
|   a2 9b f8 83
| encrypting:
|   0c 00 00 18  a6 6b 5c 79  48 6a 9f 2a  f7 e2 4d 9e
|   a9 72 fe 9c  47 e9 62 a3  00 00 00 1c  00 00 00 01
|   01 10 00 01  43 46 15 a5  3d 97 37 f2  f1 c9 8a ab
|   81 fa bc 40
| IV:
|   dc 0b f4 25  80 da 6d fe  6d 47 f0 89  99 46 20 9e
|   a2 9b f8 83
| unpadded size is: 52
| emitting 12 zero bytes of encryption padding into ISAKMP Message
| encrypting 64 using OAKLEY_AES_CBC
| next IV:  a5 66 c7 0e  7b 4f 6b 80  fa 4a 64 de  a6 58 2c a3
| emitting length of ISAKMP Message: 92
| sending 92 bytes for delete notify through enp0s3:500 to 10.0.2.14:500 (using #7)
|   43 46 15 a5  3d 97 37 f2  f1 c9 8a ab  81 fa bc 40
|   08 10 05 01  45 de 64 42  00 00 00 5c  7c 48 aa a8
|   65 2d 39 8c  3c 00 fe 93  13 36 50 63  dc 43 cb f7
|   20 24 bd b7  3b 2f bd 7e  4d 99 51 5e  7c 5b 4b 53
|   ee f4 d4 47  3a 74 6f 4e  3e 83 65 51  a5 66 c7 0e
|   7b 4f 6b 80  fa 4a 64 de  a6 58 2c a3
| deleting event for #7
| no suspended cryptographic state for 7 
| removing state object #7
| ICOOKIE:  43 46 15 a5  3d 97 37 f2
| RCOOKIE:  f1 c9 8a ab  81 fa bc 40
| state hash entry 30
| request to delete a unrouted policy with netkey kernel --- experimental
| creating SPD to 10.0.2.15->spi=00000000@0.0.0.0 proto=61
| creating SPD to 10.0.2.15->spi=00000000@0.0.0.0 proto=61
| route owner of "mytunnel" unrouted: NULL
| command executing unroute-host
| executing unroute-host: 2>&1 PLUTO_VERB='unroute-host' PLUTO_VERSION='2.0' PLUTO_CONNECTION='mytunnel' PLUTO_INTERFACE='enp0s3' PLUTO_NEXT_HOP='10.0.2.14' PLUTO_ME='10.0.2.15' PLUTO_MY_ID='10.0.2.15' PLUTO_MY_CLIENT='10.0.2.15/32' PLUTO_MY_CLIENT_NET='10.0.2.15' PLUTO_MY_CLIENT_MASK='255.255.255.255' PLUTO_MY_PORT='0' PLUTO_MY_PROTOCOL='0' PLUTO_PEER='10.0.2.14' PLUTO_PEER_ID='10.0.2.14' PLUTO_PEER_CLIENT='10.0.2.14/32' PLUTO_PEER_CLIENT_NET='10.0.2.14' PLUTO_PEER_CLIENT_MASK='255.255.255.255' PLUTO_PEER_PORT='0' PLUTO_PEER_PROTOCOL='0' PLUTO_PEER_CA='' PLUTO_STACK='netkey'   PLUTO_CONN_POLICY='PSK+ENCRYPT+TUNNEL+PFS+IKEv2ALLOW+SAREFTRACK' PLUTO_CONN_ADDRFAMILY='ipv4' PLUTO_CONN_CLIENTFAMILY='ipv6' PLUTO_CONN_ENDFAMILY='ipv4'   PLUTO_IS_PEER_CISCO='0' PLUTO_CISCO_DNS_INFO='' PLUTO_CISCO_DOMAIN_INFO='' PLUTO_PEER_BANNER='' PLUTO_NM_CONFIGURED='0' ipsec _updown
| alg_info_delref(0x5650f337bb90) alg_info->ref_cnt=1
| alg_info_delref(0x5650f337bb90) freeing alg_info
| alg_info_delref(0x5650f337b370) alg_info->ref_cnt=1
| alg_info_delref(0x5650f337b370) freeing alg_info
shutting down interface lo/lo ::1:500
shutting down interface lo/lo 127.0.0.1:500
shutting down interface enp0s3/enp0s3 10.0.2.15:500
pluto_crypto_helper: helper [nonnss] (0) is exiting normally 
